<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>LLMè‡ªåŠ¨è¯„ä»·æ–¹æ³•</title>
    <link href="/LLM%E8%87%AA%E5%8A%A8%E8%AF%84%E4%BB%B7%E6%96%B9%E6%B3%95.html"/>
    <url>/LLM%E8%87%AA%E5%8A%A8%E8%AF%84%E4%BB%B7%E6%96%B9%E6%B3%95.html</url>
    
    <content type="html"><![CDATA[<h1 id="å¤§è¯­è¨€æ¨¡å‹è‡ªåŠ¨è¯„ä»·æ–¹æ³•">å¤§è¯­è¨€æ¨¡å‹è‡ªåŠ¨è¯„ä»·æ–¹æ³•</h1><p>LLMçš„è‡ªåŠ¨è¯„ä¼°æ˜¯ä¸€ç§å¸¸è§çš„ï¼Œå¯èƒ½ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„è¯„ä¼°æ–¹æ³•ï¼Œé€šå¸¸ä½¿ç”¨æ ‡å‡†åº¦é‡æˆ–æŒ‡æ ‡ä»¥åŠè¯„ä¼°å·¥å…·æ¥è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½ï¼Œå¦‚å‡†ç¡®æ€§ã€BLEUï¼ˆPapineniet al.ï¼Œ2002ï¼‰ã€ROUGEï¼ˆLinï¼Œ2004ï¼‰ã€BERTScoreï¼ˆZhang etal.ï¼Œ2019ï¼‰ç­‰ã€‚ç”±äºå…¶ä¸»è§‚æ€§ã€è‡ªåŠ¨è®¡ç®—æ€§å’Œç®€å•æ€§ï¼Œå¤§å¤šæ•°ç°æœ‰çš„è¯„ä¼°å·¥ä½œéƒ½é‡‡ç”¨äº†è¿™ç§è¯„ä¼°åè®®ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°ç¡®å®šæ€§ä»»åŠ¡ï¼Œå¦‚è‡ªç„¶è¯­è¨€ç†è§£å’Œæ•°å­¦é—®é¢˜ï¼Œé€šå¸¸é‡‡ç”¨è¿™ç§è¯„ä¼°åè®®ã€‚</p><p>ä¸äººå·¥è¯„ä¼°ç›¸æ¯”ï¼Œè‡ªåŠ¨è¯„ä¼°ä¸éœ€è¦å¯†é›†çš„äººå·¥å‚ä¸ï¼ŒèŠ‚çœäº†æˆæœ¬å’Œæ—¶é—´ã€‚æœ€è¿‘ï¼Œéšç€LLMçš„å‘å±•ï¼Œä¸€äº›å…ˆè¿›çš„è‡ªåŠ¨è¯„ä¼°æŠ€æœ¯ä¹Ÿè¢«è®¾è®¡æ¥å¸®åŠ©è¯„ä¼°ã€‚æ—å’Œé™ˆï¼ˆ2023ï¼‰æå‡ºäº†LLM-EVALï¼Œè¿™æ˜¯ä¸€ç§ä½¿ç”¨LLMè¿›è¡Œå¼€æ”¾åŸŸå¯¹è¯çš„ç»Ÿä¸€å¤šç»´åº¦è‡ªåŠ¨è¯„ä¼°æ–¹æ³•ã€‚PandaLMï¼ˆWangetal.ï¼Œ2023hï¼‰å¯ä»¥é€šè¿‡è®­ç»ƒLLMæ¥è¯„ä¼°ä¸åŒçš„æ¨¡å‹ï¼Œä»è€Œå®ç°å¯å¤ç°å’Œè‡ªåŠ¨åŒ–çš„è¯­è¨€æ¨¡å‹è¯„ä¼°ã€‚Jainï¼ˆ2023ï¼‰ç­‰äººæå‡ºäº†ä¸€ä¸ªè‡ªç›‘ç£çš„è¯„ä¼°æ¡†æ¶ï¼Œé€šè¿‡æ¶ˆé™¤å¯¹æ–°æ•°æ®çš„è´¹åŠ›æ ‡æ³¨ï¼Œå®ç°äº†åœ¨ç°å®ä¸–ç•Œéƒ¨ç½²ç¯å¢ƒä¸­è¯„ä¼°æ¨¡å‹çš„æ›´æœ‰æ•ˆå½¢å¼ã€‚</p><h2 id="automatic-evaluation">Automatic Evaluation</h2><h3 id="acuracy">1. Acuracy</h3><p><span class="math display">\[å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰ = \frac{Number of correct predictions}{Total numberpf predictions} = \frac{æ­£ç¡®é¢„æµ‹æ•°}{é¢„æµ‹æ€»æ•°}\]</span></p><h3 id="bleu">2. BLEU</h3><blockquote><p>Papineni, K., Roukos, S., Ward, T., and Zhu, W.-J. (2002). Bleu: amethod for automatic evaluation of machine translation. In Proceedingsof the 40th annual meeting of the Association for ComputationalLinguistics, pages 311â€“318.</p></blockquote><p><span class="math display">\[B L E U=B P\times\exp\left(\sum_{n=1}^{N}W_{n}\times\log P_{n}\right)\]</span></p><p><span class="math display">\[B P=\left\{ {\begin{array}{l l}{1}&amp;{}&amp;{ {}{\mathrm{~l}}c&gt;1r}\\ {\exp(1-l r/l c)}&amp;{}&amp;{ {}{\mathrm{~l} }c\leq lr}\end{array} }\right.\]</span></p><p>ç¥ç»ç½‘ç»œç”Ÿæˆçš„å¥å­æ˜¯candidateï¼Œç»™å®šçš„æ ‡å‡†è¯‘æ–‡æ˜¯referenceã€‚</p><ul><li><p>lc=candidateçš„é•¿åº¦ï¼Œlr=æœ€çŸ­çš„referenceçš„é•¿åº¦</p></li><li><p>BP æ˜¯æƒ©ç½šå› å­ï¼Œå¦‚æœè¯‘æ–‡çš„é•¿åº¦å°äºæœ€çŸ­çš„å‚è€ƒè¯‘æ–‡ï¼Œåˆ™ BP å°äº1ã€‚é¿å…å½“æœºå™¨ç¿»è¯‘çš„é•¿åº¦æ¯”è¾ƒçŸ­æ—¶ï¼ŒBLEUå¾—åˆ†ä¹Ÿä¼šæ¯”è¾ƒé«˜ï¼Œä½†æ˜¯è¿™ä¸ªç¿»è¯‘æ˜¯ä¼šæŸå¤±å¾ˆå¤šä¿¡æ¯çš„ã€‚</p></li><li><p>BLEU éœ€è¦è®¡ç®—è¯‘æ–‡ 1-gramï¼Œ2-gramï¼Œ...ï¼ŒN-gram çš„ç²¾ç¡®ç‡ï¼Œä¸€èˆ¬ Nè®¾ç½®ä¸º 4 å³å¯ï¼Œå…¬å¼ä¸­çš„ Pn æŒ‡ n-gramçš„ç²¾ç¡®ç‡ã€‚n-gramæ˜¯è¿ç»­nä¸ªè¯çš„ç»„åˆã€‚</p></li><li><p>BLEU çš„ 1-gram ç²¾ç¡®ç‡è¡¨ç¤ºè¯‘æ–‡å¿ äºåŸæ–‡çš„ç¨‹åº¦ï¼Œè€Œå…¶ä»– n-gramè¡¨ç¤ºç¿»è¯‘çš„æµç•…ç¨‹åº¦ã€‚</p></li><li><p>Wn æŒ‡ n-gram çš„æƒé‡ï¼Œä¸€èˆ¬è®¾ä¸ºå‡åŒ€æƒé‡ï¼Œå³å¯¹äºä»»æ„ n éƒ½æœ‰ Wn =1/Nã€‚</p></li></ul><p><span class="math display">\[p_n= \frac{\sum_{c\in candidates}\sum_{n-gram\in c}Count_{clip}(n-gram)}{\sum_{ c^\prime \in candidates} \sum_{n-gram^\prime\inc^\prime}Count(n-gram^\prime)}\]</span></p><p>Count(n-gram')è¡¨ç¤ºnâˆ’gramâ€²åœ¨candidateä¸­çš„ä¸ªæ•°ï¼Œ <spanclass="math display">\[C o u n t_{c l i p}=\mathrm{min}(C o u n t,M a x_{-}R e f_{-}C o u n t)\]</span></p><h3 id="rouge">3. ROUGE</h3><blockquote><p>Lin, C.-Y. (2004). Rouge: A package for automatic evaluation ofsummaries. In Text summarization branches out, pages 74â€“81.</p></blockquote><ul><li>ROUGE-N: åœ¨ N-gram ä¸Šè®¡ç®—å¬å›ç‡</li><li>ROUGE-L: è€ƒè™‘äº†æœºå™¨è¯‘æ–‡å’Œå‚è€ƒè¯‘æ–‡ä¹‹é—´çš„æœ€é•¿å…¬å…±å­åºåˆ—</li><li>ROUGE-W: æ”¹è¿›äº†ROUGE-Lï¼Œç”¨åŠ æƒçš„æ–¹æ³•è®¡ç®—æœ€é•¿å…¬å…±å­åºåˆ—</li></ul><p><strong>ROUGE-N</strong> ä¸»è¦ç»Ÿè®¡ N-gram ä¸Šçš„å¬å›ç‡ï¼Œå¯¹äºN-gramï¼Œå¯ä»¥è®¡ç®—å¾—åˆ° ROUGE-N åˆ†æ•°ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š</p><figure><img src="https://image.yinan.fun/202309251305125.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>å…¬å¼çš„åˆ†æ¯æ˜¯ç»Ÿè®¡åœ¨referenceä¸­N-gramçš„ä¸ªæ•°ï¼Œè€Œåˆ†å­æ˜¯ç»Ÿè®¡referenceä¸candidateå…±æœ‰çš„ N-gram ä¸ªæ•°ã€‚</p><p>ç»™å®šå¤šä¸ªå‚è€ƒè¯‘æ–‡ <strong>Si</strong> <span class="math display">\[R O D G E-N_{multi}=\operatorname*{max}_{i}R O O G E-N(S_{i},C)\]</span> <strong>ROUGE-L</strong> ä¸­çš„ L æŒ‡æœ€é•¿å…¬å…±å­åºåˆ— (longestcommon subsequence, LCS)ï¼ŒROUGE-Lè®¡ç®—çš„æ—¶å€™ä½¿ç”¨äº†æœºå™¨è¯‘æ–‡<strong>C</strong>å’Œå‚è€ƒè¯‘æ–‡<strong>S</strong>çš„æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œè®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<span class="math display">\[R_{L C S}=\frac{L C S(C,S)}{l e n(S)}\]</span></p><p><span class="math display">\[P_{L C S}=\frac{L C S(C,S)}{l e n(C)}\]</span></p><p><span class="math display">\[F_{L C S}=\frac{(1+\beta^{2})R_{L C S}P_{L C S} }{R_{L CS}+\beta^{2}P_{L C S} }\]</span></p><p>å…¬å¼ä¸­çš„ RLCS è¡¨ç¤ºå¬å›ç‡ï¼Œè€Œ PLCS è¡¨ç¤ºç²¾ç¡®ç‡ï¼ŒFLCS å°±æ˜¯ ROUGE-Lã€‚ä¸€èˆ¬beta ä¼šè®¾ç½®ä¸ºå¾ˆå¤§çš„æ•°ï¼Œå› æ­¤ FLCS å‡ ä¹åªè€ƒè™‘äº† RLCS(å³å¬å›ç‡)ã€‚<strong>æ³¨æ„è¿™é‡Œ beta å¤§ï¼Œåˆ™ F ä¼šæ›´åŠ å…³æ³¨ Rï¼Œè€Œä¸æ˜¯Pï¼Œå¯ä»¥çœ‹ä¸‹é¢çš„å…¬å¼ã€‚</strong>å¦‚æœ beta å¾ˆå¤§ï¼Œåˆ™ PLCSé‚£ä¸€é¡¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p><p>ROUGE-W æ˜¯ ROUGE-L çš„æ”¹è¿›ç‰ˆï¼Œä½¿ç”¨ä¸€ç§åŠ æƒæœ€é•¿å…¬å…±å­åºåˆ—æ–¹æ³•(WLCS)ï¼Œç»™è¿ç»­ç¿»è¯‘æ­£ç¡®çš„æ›´é«˜çš„åˆ†æ•°ã€‚</p><p>ROUGE-S ä¹Ÿæ˜¯å¯¹ N-gram è¿›è¡Œç»Ÿè®¡ï¼Œä½†æ˜¯å…¶é‡‡ç”¨çš„ N-gram å…è®¸"è·³è¯(Skip)"ï¼Œå³å•è¯ä¸éœ€è¦è¿ç»­å‡ºç°ã€‚</p><h3 id="self-supervised-evaluation-framework">4. self-supervisedevaluation framework</h3><blockquote><p>Jain, N., Saifullah, K., Wen, Y., Kirchenbauer, J., Shu, M., Saha,A., Goldblum, M., Geiping, J., and Goldstein, T. (2023). Bring your owndata! self-supervised evaluation for large language models. arXivpreprint arXiv:2306.13651.</p></blockquote><p>ç›®å‰çš„è¯„ä¼°ä½¿ç”¨å¸¦æœ‰äººå·¥ç­–åˆ’æ ‡ç­¾çš„å°å‹é¢†åŸŸç‰¹å®šæ•°æ®é›†ï¼Œè¿™äº›è¯„ä¼°é›†é€šå¸¸ä»ç‹­çª„è€Œç®€åŒ–çš„åˆ†å¸ƒä¸­æŠ½æ ·ï¼Œæ•°æ®æºå¯èƒ½ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­æ³„éœ²åˆ°åŸ¹è®­é›†ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è¯¯å¯¼æ€§è¯„ä¼°ã€‚</p><p>We demonstrate self-supervised evaluation strategies for measuringclosed-book knowledge, toxicity, and long-range context dependence, inaddition to sensitivity to grammatical structure and tokenizationerrors.</p><figure><img src="https://image.yinan.fun/202309251306278.png"alt="image-20230922214003156" /><figcaption aria-hidden="true">image-20230922214003156</figcaption></figure><p>Based on this intervention, we measure the change in thelog-perplexity (log(ppl(x))), between the original and negated sentence.Formally, we define the sensitivity score as the following: <spanclass="math display">\[{\mathrm{SENSITIVIT} }\operatorname{SCORE}={\frac{1}{n}}\sum_{i}^{n}{\mathrm{log} }{\mathrm{(ppl}}(x_{i}^{\prime}))-{\mathrm{log} }{\mathrm{(ppl} }(x_{i})).\]</span></p><p>æ¥ä¸‹æ¥æ˜¯ç¬¬äºŒç±»æ–¹æ³•ï¼Œç§°ä¸ºâ€œé—´æ¥æˆ–åˆ†è§£çš„å¯å‘å¼æ–¹æ³•ï¼ˆindirect ordecomposedheuristicsï¼‰â€ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬<strong>åˆ©ç”¨è¾ƒå°çš„æ¨¡å‹ï¼ˆsmallermodelsï¼‰æ¥è¯„ä¼°ä¸»æ¨¡å‹ï¼ˆthe mainmodelï¼‰ç”Ÿæˆçš„ç­”æ¡ˆ</strong>ï¼Œè¿™äº›è¾ƒå°çš„æ¨¡å‹å¯ä»¥æ˜¯å¾®è°ƒè¿‡çš„æ¨¡å‹æˆ–åŸå§‹çš„åˆ†è§£æ¨¡å‹ï¼ˆrawdecompositionsï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€‰å–åœ¨è¿™äº›å¤§æ¨¡å‹æ“…é•¿çš„ä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½çš„å°æ¨¡å‹æ¥è¿›è¡Œè¯„ä¼°ã€‚è¿™äº›è¾ƒå°æ¨¡å‹çš„è¾“å‡ºè¢«çœ‹ä½œæ˜¯å¼±å¾—åˆ†ï¼ˆweakscoresï¼‰ï¼Œç„¶åå°†å®ƒä»¬ç»“åˆèµ·æ¥ä¸ºç”Ÿæˆçš„è¾“å‡ºæä¾›ä¸€ä¸ªæœ€ç»ˆçš„æ ‡ç­¾æˆ–è¯„ä»·ã€‚è¿™ç§é—´æ¥è¯„ä¼°æ–¹æ³•èƒ½å¤Ÿ<strong>æ›´åŠ ç»†è‡´åœ°è¯„ä¼°æ¨¡å‹çš„æ€§èƒ½</strong>ï¼Œå°¤å…¶åœ¨åˆ¤æ–­å¯¹æ•£æ–‡çš„å–œçˆ±ç¨‹åº¦ç­‰è¿™äº›ä»»åŠ¡ã€‚</p><h3 id="bertscore">5. BERTScore</h3><blockquote><p>Zhang, T., Kishore, V., Wu, F., Weinberger, K. Q., and Artzi, Y.(2019). Bertscore: Evaluating text generation with bert. arXiv preprintarXiv:1904.09675.</p></blockquote><p>åŸºäºN-gramé‡å çš„åº¦é‡æ ‡å‡†åªå¯¹è¯æ±‡å˜åŒ–æ•æ„Ÿï¼Œä¸èƒ½è¯†åˆ«å¥å­è¯­ä¹‰æˆ–è¯­æ³•çš„å˜åŒ–ã€‚å› æ­¤ï¼Œå®ƒä»¬è¢«åå¤è¯æ˜ä¸äººå·¥è¯„ä¼°å·®è·è¾ƒå¤§ã€‚</p><p>äºæ˜¯æœ‰äººæå‡ºä½¿ç”¨å¥å­ä¸Šä¸‹æ–‡è¡¨ç¤º(bertå…¨å®¶æ¡¶)å’Œäººå·¥è®¾è®¡çš„è®¡ç®—é€»è¾‘å¯¹å¥å­ç›¸ä¼¼åº¦è¿›è¡Œè®¡ç®—ã€‚è¿™æ ·çš„è¯„ä»·æŒ‡æ ‡é²æ£’æ€§è¾ƒå¥½ï¼Œåœ¨ç¼ºä¹è®­ç»ƒæ•°æ®çš„æƒ…å†µä¸‹ä¹Ÿå…·æœ‰è¾ƒå¥½è¡¨ç°ã€‚</p><p>æ€è·¯æ˜¯éå¸¸ç®€å•çš„ï¼šå³å¯¹ä¸¤ä¸ªç”Ÿæˆå¥å’Œå‚è€ƒå¥ï¼ˆwordpieceè¿›è¡Œtokenizeï¼‰åˆ†åˆ«ç”¨bertæå–ç‰¹å¾ï¼Œç„¶åå¯¹2ä¸ªå¥å­çš„æ¯ä¸€ä¸ªè¯åˆ†åˆ«è®¡ç®—å†…ç§¯ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªç›¸ä¼¼æ€§çŸ©é˜µã€‚</p><figure><img src="https://image.yinan.fun/202309251304050.png"alt="image-20230922111952603" /><figcaption aria-hidden="true">image-20230922111952603</figcaption></figure><p>åŸºäºè¿™ä¸ªçŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«å¯¹å‚è€ƒå¥å’Œç”Ÿæˆå¥åšä¸€ä¸ªæœ€å¤§ç›¸ä¼¼æ€§å¾—åˆ†çš„ç´¯åŠ ç„¶åå½’ä¸€åŒ–ï¼Œå¾—åˆ°bertscoreçš„precisionï¼Œrecallå’ŒF1ï¼š</p><figure><img src="https://image.yinan.fun/202309251305151.png"alt="image-20230922111853984" /><figcaption aria-hidden="true">image-20230922111853984</figcaption></figure><p>è¿˜å¯ä»¥è€ƒè™‘ç»™ä¸åŒçš„è¯ä»¥æƒé‡ã€‚ä½œè€…ä½¿ç”¨idfå‡½æ•°ï¼Œå³ç»™å®šMä¸ªå‚è€ƒå¥ï¼Œè¯wçš„idfä¸ºï¼š<span class="math display">\[\operatorname{idf}(w)=-\log \frac{1}{M} \sum_{i=1}^{M} \mathbb{I}\left[w\in x^{(i)}\right]\]</span> å…¶ä¸­<spanclass="math inline">\(\mathbb{I}()\)</span>æ˜¯ä¸€ä¸ªæŒ‡ç¤ºå‡½æ•°ã€‚ç”¨æ­¤å¼æ›´æ–°ä¸Šè¿°è¯„åˆ†ï¼Œä¾‹å¦‚recallï¼š<span class="math display">\[R_{\mathrm{BERT} }=\frac{\sum_{x_{i} \in x} \text { idf}\left(x_{i}\right) \max _{\hat{x}_{j} \in \hat{x} }\mathbf{x}_{i}^{\top} \hat{\mathbf{x} }_{j} }{\sum_{x_{i} \in x} \text {idf }\left(x_{i}\right)}\]</span></p><h3 id="llm-eval">6. LLM-EVAL</h3><blockquote><p>Lin, Y.-T. and Chen, Y.-N. (2023). Llm-eval: Unified multidimensionalautomatic evaluation for open-domain conversations with large languagemodels. arXiv preprint arXiv:2305.13711.</p></blockquote><p>The single prompt is created by concatenating the dialogue context,reference (if available), and generated response, and then fed to alarge language model, which outputs scores for each dimension based onthe defined schema.xs</p><p><img src="https://image.yinan.fun/202309251304291.png" alt="image-20230922202719792" style="zoom: 50%;" /></p><ul><li><p>Unified Evaluation Schema</p><p>The evaluation schema is a natural language instruction that definesthe task and the desired evaluation criteria. The schema is provided asa format instruction, which <strong>specifies the structure and therange of the scores for each dimension</strong>. For example, theevaluation schema can be:</p><figure><img src="https://image.yinan.fun/202309251304462.png"alt="image-20230922202303631" /><figcaption aria-hidden="true">image-20230922202303631</figcaption></figure></li><li><p>Single Prompt for Evaluation</p><p>The prompt is concatenated with the dialogue context, the reference(if available), and the generated response, and then fed to the largelanguage model to output a score for each evaluation dimension, based onthe defined schema.</p><figure><img src="https://image.yinan.fun/202309251304679.png"alt="image-20230922202344802" /><figcaption aria-hidden="true">image-20230922202344802</figcaption></figure></li><li><p>Efficient Evaluation</p><p>By using a single prompt with a unified evaluation schema, LLM-EVALcan efficiently obtain multi-dimensional scores for the responseswithout the need for multiple prompts.</p><figure><img src="https://image.yinan.fun/202309251304926.png"alt="image-20230922202430502" /><figcaption aria-hidden="true">image-20230922202430502</figcaption></figure></li><li><p>Different LLMs</p><p>In conclusion, our analysis demonstrates that<strong>dialogue-optimized LLMs</strong>, such as Claude and ChatGPT,yield <strong>better performance</strong> in the LLMEVAL method foropen-domain conversation evaluation. Although smaller models likeAnthropic Claude-instant may not achieve the best performance, they canstill be considered for resourcelimited scenarios.</p><figure><img src="https://image.yinan.fun/202309251304520.png"alt="image-20230922204729102" /><figcaption aria-hidden="true">image-20230922204729102</figcaption></figure></li><li><p>Baseline Evaluation Metrics</p><figure><img src="https://image.yinan.fun/202309251304232.png"alt="image-20230924100711864" /><figcaption aria-hidden="true">image-20230924100711864</figcaption></figure></li></ul><h3 id="pandalm">7. PandaLM</h3><blockquote><p>Wang, Y., Yu, Z., Zeng, Z., Yang, L., Wang, C., Chen, H., Jiang, C.,Xie, R., Wang, J., Xie, X., et al. (2023h). Pandalm: An automaticevaluation benchmark for llm instruction tuning optimization. arXivpreprint arXiv:2306.05087.</p></blockquote><ul><li><p>å¼€æºä»£ç /æ¨¡å‹</p><p><ahref="https://github.com/WeOpenML/PandaLM">https://github.com/WeOpenML/PandaLM</a></p><p><ahref="https://huggingface.co/WeOpenML/PandaLM-7B-v1">https://huggingface.co/WeOpenML/PandaLM-7B-v1</a></p></li></ul><p>å½“å‰ï¼Œå¤§å®¶è¯„ä¼°å¤§æ¨¡å‹çš„æ–¹æ³•ä¸»è¦æœ‰ä¸¤ä¸ªï¼š</p><ul><li>è°ƒç”¨OpenAIçš„APIæ¥å£ï¼Œå‘é€æ•°æ®ç»™OpenAIå¯èƒ½ä¼šåƒä¸‰æ˜Ÿå‘˜å·¥æ³„éœ²ä»£ç ä¸€æ ·é€ æˆæ•°æ®æ³„éœ²é—®é¢˜ã€‚</li><li>é›‡ä½£ä¸“å®¶è¿›è¡Œäººå·¥æ ‡æ³¨ï¼Œé›‡ä½£ä¸“å®¶æ ‡æ³¨å¤§é‡æ•°æ®åˆååˆ†è´¹æ—¶è´¹åŠ›ä¸”æ˜‚è´µã€‚</li></ul><p>PandaLMåªéœ€è¦åœ¨ã€Œæœ¬åœ°éƒ¨ç½²ã€ï¼Œä¸”ã€Œä¸éœ€è¦äººç±»å‚ä¸ã€ï¼Œå› æ­¤PandaLMçš„è¯„ä¼°æ˜¯å¯ä»¥ä¿æŠ¤éšç§ä¸”ç›¸å½“å»‰ä»·çš„ã€‚</p><p>å½“ä¸¤ä¸ªä¸åŒçš„å¤§æ¨¡å‹å¯¹åŒä¸€ä¸ªæŒ‡ä»¤å’Œä¸Šä¸‹æ–‡äº§ç”Ÿä¸åŒå“åº”æ—¶ï¼ŒPandaLMæ—¨åœ¨æ¯”è¾ƒè¿™ä¸¤ä¸ªå¤§æ¨¡å‹çš„å“åº”è´¨é‡ï¼Œå¹¶è¾“å‡ºæ¯”è¾ƒç»“æœï¼Œæ¯”è¾ƒç†ç”±ä»¥åŠå¯ä¾›å‚è€ƒçš„å“åº”ã€‚æ¯”è¾ƒç»“æœæœ‰ä¸‰ç§ï¼šå“åº”1æ›´å¥½ï¼Œå“åº”2æ›´å¥½ï¼Œå“åº”1ä¸å“åº”2è´¨é‡ç›¸ä¼¼ã€‚</p><figure><img src="https://image.yinan.fun/202309251305749.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>ç»“æœè¡¨æ˜ï¼ŒPandaLM-7Bè¾¾åˆ°äº†93.75%çš„GPT-3.5è¯„ä»·èƒ½åŠ›å’Œ88.28%çš„GPT-4è¯„ä»·èƒ½åŠ›ã€‚</p><figure><img src="https://image.yinan.fun/202309251305475.png"alt="image-20230924101010218" /><figcaption aria-hidden="true">image-20230924101010218</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¥ç»ç½‘ç»œè®­ç»ƒ</title>
    <link href="/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AE%AD%E7%BB%83.html"/>
    <url>/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E8%AE%AD%E7%BB%83.html</url>
    
    <content type="html"><![CDATA[<h1 id="ç¥ç»ç½‘ç»œè®­ç»ƒ">ç¥ç»ç½‘ç»œè®­ç»ƒ</h1><h2 id="general-guidance">General Guidance</h2><p><img src="https://image.yinan.fun/202309182239371.png" /></p><h3 id="model-bias">Model Bias</h3><ul><li><p>The model is too simple.</p><p>find a needle in a haystack, but there is no needle</p></li><li><p>Solution: redesign your model to make it more flexible</p><ol type="1"><li>More features</li><li>Deep Learning (more neurons, layers)</li></ol></li></ul><p><img src="https://image.yinan.fun/202309191041005.png" /></p><h3 id="optimization-issue">Optimization Issue</h3><p>A needle is in a haystack, just cannot find it.</p><h3 id="model-bias-v.s.-optimization-issue">Model Bias v.s. OptimizationIssue</h3><p>æ€ä¹ˆåŒºåˆ†ï¼Ÿ</p><ul><li><p>Start from shallower networks (or other models), which are easierto optimize.</p></li><li><p>If deeper networks do not obtain smaller loss on training data,then there is optimization issue.</p></li><li><p>Solution: More powerful optimization technology</p></li></ul><h3 id="overfitting">Overfitting</h3><ul><li><p>Small loss on training data, large loss on testing data.</p></li><li><p>Solution</p><ol type="1"><li><p>More training data</p></li><li><p>Data augmentation</p><p>å›¾ç‰‡ç¿»è½¬ã€æ”¾å¤§ï¼ˆä¸èƒ½é¢ å€’ï¼‰</p></li><li><p>constrained model</p><p>Less parameters, sharing parameters(CNN), Less features, Earlystopping, Regularization, Dropout</p></li></ol></li></ul><h3 id="bias-complexity-trade-off">Bias-Complexity Trade-off</h3><p><img src="https://image.yinan.fun/202309191041689.png" /></p><h3 id="mismatch">Mismatch</h3><ul><li>Your training and testing data have different distributions. Beaware of how data is generated.</li></ul><h2 id="gradient-is-small">Gradient is small</h2><h3 id="optimization-fails">Optimization Fails</h3><ul><li>gradient is close to zero (critical point)<ol type="1"><li>local minima</li><li>saddle point</li></ol></li></ul><p><img src="https://image.yinan.fun/202309191041294.png" /></p><h3 id="åŒºåˆ†local-minimaå’Œsaddle-point">åŒºåˆ†local minimaå’Œsaddlepoint</h3><ul><li>Tayler Series Approximation</li></ul><p><img src="https://image.yinan.fun/202309191041581.png" /></p><p>åœ¨critical pointï¼Œgradientä¸º0ï¼Œä¸è€ƒè™‘ç¬¬äºŒé¡¹</p><p><img src="https://image.yinan.fun/202309191041837.png" /></p><p><img src="https://image.yinan.fun/202309191041923.png" /></p><ul><li>Example</li></ul><p><img src="https://image.yinan.fun/202309191041773.png" /></p><h3 id="saddle-pointæ›´æ–°å‚æ•°">Saddle pointæ›´æ–°å‚æ•°</h3><p>ğ» may tell us parameter update direction</p><p><img src="https://image.yinan.fun/202309191041177.png" /></p><p>æ‰¾åˆ°Hè´Ÿçš„eigen value <spanclass="math inline">\(\lambda\)</span>å¯¹åº”çš„eigen vector <spanclass="math inline">\(\mu\)</span>ï¼Œç”¨è¿™ä¸ªeigen vectoræ›´æ–° <spanclass="math inline">\(\theta =\theta&#39;+\mu\)</span>ï¼ŒLosså°±ä¼šä¸‹é™</p><p>Update the parameter along the direction of <spanclass="math inline">\(\mu\)</span> You can escape the saddle point anddecrease the loss.(this method is seldom used in practiceï¼Œè®¡ç®—é‡å¤§)</p><p>å¤§éƒ¨åˆ†æƒ…å†µï¼Œlossæ— æ³•ä¸‹é™æ˜¯å¡åœ¨saddle pointï¼ˆä¸€éƒ¨åˆ†eigenvalueä¸ºæ­£ï¼Œä¸€éƒ¨åˆ†ä¸ºè´Ÿï¼‰</p><p><img src="https://image.yinan.fun/202309191042158.png" /></p><h2 id="batch">Batch</h2><h3 id="optimization-with-batch">Optimization with Batch</h3><p>æ¯ä¸ªbatchæ›´æ–°ä¸€æ¬¡å‚æ•°</p><p><img src="https://image.yinan.fun/202309191042170.png" /></p><h3 id="small-batch-v.s.-large-batch">Small Batch v.s. Large Batch</h3><ul><li>Smaller batch requires longer time for one epoch (longer time forseeing all data once) (Parallel computing)</li></ul><p><img src="https://image.yinan.fun/202309191042028.png" /></p><ul><li>Batch size è¶Šå¤§ï¼Œå‡†ç¡®ç‡è¶Šä½</li></ul><p><img src="https://image.yinan.fun/202309191042660.png" /></p><p>Smaller batch size has better performance. â€œNoisyâ€ update is betterfor training</p><p>æ¯ä¸€æ¬¡batchæ›´æ–°å‚æ•°ï¼Œlosså‡½æ•°éƒ½æ˜¯ç•¥æœ‰å·®å¼‚çš„</p><p><img src="https://image.yinan.fun/202309191042742.png" /></p><ul><li><p>Small batch is better on testing data? (bettergeneralization)</p><p>On Large-Batch Training for Deep Learning: Generalization Gap andSharp Minima https://arxiv.org/abs/1609.04836</p></li></ul><p><img src="https://image.yinan.fun/202309191042772.png" /></p><p>Batch size is a hyperparameter you have to decide.</p><ul><li><p>å…¨éƒ½è¦ï¼Ÿ</p><ul><li><p>Large Batch Optimization for Deep Learning: Training BERT in 76minutes (https://arxiv.org/abs/1904.00962)</p></li><li><p>Extremely Large Minibatch SGD: Training ResNet-50 on ImageNet in15 Minutes (https://arxiv.org/abs/1711.04325)</p></li><li><p>Stochastic Weight Averaging in Parallel: Large-Batch TrainingThat Generalizes Well (https://arxiv.org/abs/2001.02312)</p></li><li><p>Large Batch Training of Convolutional Networks(https://arxiv.org/abs/1708.03888)</p></li><li><p>Accurate, large minibatch sgd: Training imagenet in 1 hour(https://arxiv.org/abs/1706.02677)</p></li></ul></li></ul><h2 id="momentum">Momentum</h2><ul><li>çƒä»é«˜å¤„æ»šä¸‹æ¥</li></ul><p><img src="https://image.yinan.fun/202309191042460.png" /></p><h3 id="gradient-descent-momentum">Gradient Descent + Momentum</h3><p>æ¯ä¸€æ­¥çš„ç§»åŠ¨ = ä¸Šä¸€æ¬¡çš„ç§»åŠ¨ - gradient</p><p><img src="https://image.yinan.fun/202309191042888.png" /></p><p><span class="math inline">\(m^{i}\)</span> is the weighted sum of allthe previous gradient: <spanclass="math inline">\(g^{0},\,g^{1},\,\ldots,\,g^{i-1}\)</span> <spanclass="math display">\[{ {m^{0}=0} }\\ { {m^{1}=-\eta g^{0} }}\\ m^{2}=-\lambda\eta g^{0}-\etag^{1}\]</span> Movement not just based on gradient, but previousmovement.</p><h2 id="adaptive-learning-rate">Adaptive Learning Rate</h2><ul><li><p>Training stuck â‰  Small Gradient</p><p>å¯èƒ½åœ¨error surfaceçš„å±±è°·æ¥å›éœ‡è¡</p></li></ul><p><img src="https://image.yinan.fun/202309191042207.png" /></p><h3 id="different-parameters-needs-different-learning-rate">Differentparameters needs different learning rate</h3><p><img src="https://image.yinan.fun/202309191042982.png" /></p><ul><li><p>Root Mean Square</p><p><span class="math inline">\(\sigma\)</span>æ˜¯æ‰€ä»¥gradientçš„å¹³æ–¹çš„å¹³å‡å¼€æ ¹å·</p></li></ul><p><span class="math display">\[\theta_{i}^{t+1} \rightarrow\theta_{i}^{t}-\frac{\eta}{\sigma_{i}^{t}}g_{i}^{t}\\{{\sigma_{i}^{t}=\sqrt{\frac{1}{t+1}\displaystyle\sum_{i=0}^{t}(g_{i}^{t})^{2}}} }\]</span></p><p>error surfaceè¶Šå¹³æ»‘ï¼Œ<span class="math inline">\(\sigma\)</span>è¶Šå°ï¼Œ<span class="math inline">\(\theta\)</span> æ›´æ–°è¶Šå¤§ã€‚rrorsurfaceè¶Šé™¡ï¼Œ<span class="math inline">\(\sigma\)</span> è¶Šå¤§ï¼Œ<spanclass="math inline">\(\theta\)</span> æ›´æ–°è¶Šå°ã€‚</p><p><img src="https://image.yinan.fun/202309191042331.png" /></p><h3 id="learning-rate-adapts-dynamically">Learning rate adaptsdynamically</h3><p>Root Mean Square ä¸èƒ½æ ¹æ®å½“å‰ error surface çš„æƒ…å†µå¿«é€Ÿåœ°åŠæ—¶å˜åŒ–</p><ul><li><p>RMSProp</p><p><span class="math inline">\(\sigma\)</span> æ˜¯ä¹‹å‰çš„ <spanclass="math inline">\(\sigma\)</span> å’Œè¿™æ¬¡çš„gradientåŠ æƒ</p><p>The recent gradient has larger influence, and the past gradients haveless influence.</p></li></ul><p><span class="math display">\[\theta_{i}^{t+1} \rightarrow\theta_{i}^{t}-\frac{\eta}{\sigma_{i}^{t}}g_{i}^{t}\\\sigma_{i}^{t}={\sqrt{\alpha{\left(\sigma_{i}^{t-1}\right)}^{2}+{(1-\alpha)\left({g_{i}^{t}}\right)}^{2} }}\]</span></p><ul><li>Adam: RMSProp + Momentum</li></ul><p><img src="https://image.yinan.fun/202309191042884.png" /></p><p><img src="https://image.yinan.fun/202309191042493.png" /></p><p>çº¢åœˆé‡Œå› ä¸º<spanclass="math inline">\(\sigma\)</span>å¾ˆå°ï¼Œä¼šçªç„¶è·³å¾ˆè¿œ</p><h3 id="learning-rate-scheduling">Learning Rate Scheduling</h3><p><img src="https://image.yinan.fun/202309191042270.png" /></p><ol type="1"><li><p>Learning Rate Decay</p><p>As the training goes, we are closer to the destination, so we reducethe learning rate.</p></li></ol><p><img src="https://image.yinan.fun/202309191042887.png" /></p><ol start="2" type="1"><li><p>Warm Up ï¼ˆé»‘ç§‘æŠ€ï¼‰</p><p>Increase and then decrease?</p><p>äº†è§£æ›´å¤šï¼šRAdam: <ahref="https://arxiv.org/abs/1908.03265">https://arxiv.org/abs/1908.03265</a></p></li></ol><p><img src="https://image.yinan.fun/202309191043259.png" /></p><ul><li>Residual Network: <ahref="https://arxiv.org/abs/1512.03385">https://arxiv.org/abs/1512.03385</a></li><li>Transformer: <ahref="https://arxiv.org/abs/1706.03762">https://arxiv.org/abs/1706.03762</a></li></ul><p><img src="https://image.yinan.fun/202309191043594.png" /></p><h3 id="summary-of-optimization">Summary of Optimization</h3><ul><li>(Vanilla) Gradient Descent</li></ul><p><span class="math display">\[\theta_{i}^{t+1} \leftarrow\theta_{i}^{t}-\eta g_{i}^{t}\]</span></p><ul><li>Various Improvements</li></ul><p><img src="https://image.yinan.fun/202309191043638.png" /></p><h2 id="batch-normalization">Batch Normalization</h2><p>æŠŠerror surfaceçš„å±±é“²å¹³</p><p>å‡è®¾ä¸€ä¸ªç®€å•çš„ç½‘ç»œ <span class="math display">\[y = w_1x_1+w_2x_2+b\]</span> å½“<span class="math inline">\(x_1\)</span>å¾ˆå°ï¼Œ<spanclass="math inline">\(x_2\)</span>å¾ˆå¤§æ—¶ï¼Œ<spanclass="math inline">\(w_1\)</span>çš„å˜åŒ–å¯¹Lossçš„å½±å“å¾ˆå°ï¼Œ<spanclass="math inline">\(w_2\)</span>çš„å˜åŒ–å¯¹Lossçš„å½±å“å¾ˆå¤§ï¼Œå°±ä¼šå‡ºç°å›¾ä¸­å·¦è¾¹çš„æƒ…å†µã€‚</p><p><img src="https://image.yinan.fun/202309191043406.png" /></p><p>è®©è¾“å…¥featureä¸åŒçš„dimensionæœ‰ç›¸åŒçš„æ•°å€¼èŒƒå›´ï¼Œå¾—åˆ°æ›´å¥½çš„errorsurface</p><h3 id="feature-normalization">Feature Normalization</h3><p><img src="https://image.yinan.fun/202309191043068.png" /></p><p>In general, feature normalization makes gradient descent convergefaster.</p><ul><li>Considering Deep Learning</li></ul><p>This is a large network! æ¯ä¸€ä¸ªbatchæ˜¯ä¸€ä¸ªæ›´å¤§çš„ç½‘ç»œ</p><p><img src="https://image.yinan.fun/202309191043237.png" /></p><p>Normalizationååœ¨ä¹˜ä»¥<spanclass="math inline">\(\gamma\)</span>å†åŠ <spanclass="math inline">\(\beta\)</span>ï¼Œ<spanclass="math inline">\(\gamma\)</span>å’Œ<spanclass="math inline">\(\beta\)</span>æ˜¯ç½‘ç»œå†…å¯å­¦ä¹ çš„å‚æ•°ã€‚</p><p>å› ä¸ºNormalizationå<spanclass="math inline">\(\widetilde{z}^{i}\)</span>çš„å‡å€¼ä¸º0ï¼Œè¿™ä¸ªé™åˆ¶å¯èƒ½ä¼šå¯¹ç½‘ç»œäº§ç”Ÿä¸å¥½çš„å½±å“ï¼Œ<spanclass="math inline">\(\gamma\)</span>å†åŠ <spanclass="math inline">\(\beta\)</span>è®©ç½‘ç»œè¾“å‡ºçš„å‡å€¼ä¸ä¸€å®šæ˜¯0</p><p><span class="math inline">\(\gamma\)</span>åˆå§‹åŒ–ä¸º1 vectorï¼Œ<spanclass="math inline">\(\beta\)</span>åˆå§‹åŒ–ä¸º0 vector <spanclass="math display">\[\widetilde{z}^{i}=\frac{z^i-\mu}{\sigma} \\{\hat{z} }^{i}=\gamma\Theta{\widetilde{z} }^{i}+\beta\]</span> <img src="https://image.yinan.fun/202309191102296.png" /></p><h3 id="testing">Testing</h3><p>We do not always have batch at testing stage.</p><p>Computing the moving average of <spanclass="math inline">\(\mu\)</span> and <spanclass="math inline">\(\sigma\)</span> of the batches duringtraining.</p><p><img src="https://image.yinan.fun/202309191102297.png" /></p><h3 id="bn-on-cnn">BN on CNN</h3><p>åœ¨å·ç§¯å±‚åé¢çš„BNä¸1dæƒ…å†µçš„BNå±‚æ˜¯å¾ˆç±»ä¼¼çš„ï¼ŒåŒæ ·æ˜¯æ²¿ç€batchçš„ç»´åº¦æ±‚å‡å€¼å’Œæ–¹å·®ã€‚å¹¶ä¸”ï¼Œå®ƒçš„å‚æ•°å¤§å°ä¹Ÿä»…ä»…ä¸featuredimï¼ˆchannelsï¼‰æœ‰å…³ï¼Œä¹Ÿä¸º2*dã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æ±‚å‡å€¼å’Œæ–¹å·®çš„æ—¶å€™ï¼Œå®é™…ä¸Šå…¶ä¸ä»…æ˜¯æ²¿ç€batchçš„ç»´åº¦æ±‚å–ï¼Œåœ¨æ¯ä¸ªchannelä¸Šçš„å®½åº¦å’Œé«˜åº¦æ–¹å‘ä¹Ÿæ±‚å–å‡å€¼ã€‚</p><p><img src="https://image.yinan.fun/202309191110637.png" /></p><p>å‡å€¼å’Œæ–¹å·®çš„shapeæ˜¯[1, 2, 1,1]ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ±‚å–å‡å€¼å’Œæ–¹å·®æ—¶ï¼Œæ˜¯æ²¿ç€batch, h,wä¸‰ä¸ªç»´åº¦è¿›è¡Œçš„ï¼Œåªä¿è¯æ¯ä¸ªchannelçš„ç»Ÿè®¡å€¼æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥æ±‚å¾—å‡å€¼å’Œæ–¹å·®ï¼š</p><p><img src="https://image.yinan.fun/202309191111003.png" /></p><h3 id="to-learn-more">To learn more</h3><ul><li><p>Batch Renormalization: https://arxiv.org/abs/1702.03275</p></li><li><p>Layer Normalization: https://arxiv.org/abs/1607.06450</p></li><li><p>Instance Normalization: https://arxiv.org/abs/1607.08022</p></li><li><p>Group Normalization: https://arxiv.org/abs/1803.08494</p></li><li><p>Weight Normalization: https://arxiv.org/abs/1602.07868</p></li><li><p>Spectrum Normalization: https://arxiv.org/abs/1705.10941</p></li></ul><h2 id="å‚è€ƒ">å‚è€ƒ</h2><ol type="1"><li><ahref="https://speech.ee.ntu.edu.tw/~hylee/ml/2021-spring.php">https://speech.ee.ntu.edu.tw/~hylee/ml/2021-spring.php</a></li><li><ahref="https://www.bilibili.com/video/BV1Wv411h7kN">https://www.bilibili.com/video/BV1Wv411h7kN</a></li><li><ahref="https://zhuanlan.zhihu.com/p/403073810">https://zhuanlan.zhihu.com/p/403073810</a></li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
      <tag>æå®æ¯…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Diffusion Model</title>
    <link href="/Diffusion-Model.html"/>
    <url>/Diffusion-Model.html</url>
    
    <content type="html"><![CDATA[<h1 id="diffusion-model">Diffusion Model</h1><h2 id="diffusion-model-æ˜¯å¦‚ä½•è¿ä½œçš„">Diffusion Modelæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Ÿ</h2><p>å°†å™ªå£°è¾“å…¥Denoise Model Tæ¬¡ç”Ÿæˆå¹²å‡€çš„å›¾åƒï¼Œæ­¥éª¤æ•°tï¼ˆå™ªå£°çš„ç¨‹åº¦ï¼‰ä¸€åŒè¾“å…¥Denoise Model</p><p><img src="https://image.yinan.fun/202309161633319.png" /></p><h3 id="denoise-æ¨¡ç»„å†…éƒ¨å®é™…åšçš„äº‹æƒ…">Denoise æ¨¡ç»„å†…éƒ¨å®é™…åšçš„äº‹æƒ…</h3><p>äº§ç”Ÿè¾“å…¥å›¾ç‰‡çš„æ‚åºï¼Œå†å°†å›¾ç‰‡å‡å»æ‚åº</p><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥è®­ç»ƒä¸€ä¸ªç”Ÿæˆå›¾åƒçš„æ¨¡å‹ï¼Ÿéš¾åº¦æ›´å¤§</p><p><img src="https://image.yinan.fun/202309161633712.png" /></p><h2 id="å¦‚ä½•è®­ç»ƒ-noise-predictor">å¦‚ä½•è®­ç»ƒ Noise Predictor</h2><p><strong>Forward Process (Diffusion Process)</strong></p><p><img src="https://image.yinan.fun/202309161633108.png" /></p><p><img src="https://image.yinan.fun/202309161633844.png" /></p><h3 id="text-to-image">Text-to-Image</h3><p><img src="https://image.yinan.fun/202309161634005.png" /></p><p>æŠŠæ–‡å­—ä¸€åŒä½œä¸ºDenoiseæ¨¡ç»„çš„è¾“å…¥</p><p><imgsrc="https://image.yinan.fun/202309161634588.png" />Denoiseæ¨¡ç»„å†…éƒ¨</p><p><img src="https://image.yinan.fun/202309161634450.png" /></p><p>è®­ç»ƒ</p><p><img src="https://image.yinan.fun/202309161634572.png" /></p><h3 id="denoising-diffusion-probabilistic-models">Denoising DiffusionProbabilistic Models</h3><p><img src="https://image.yinan.fun/202309161634961.png" /></p><h1 id="diffusion-model-èƒŒåçš„æ•°å­¦åŸç†">Diffusion ModelèƒŒåçš„æ•°å­¦åŸç†</h1><h3 id="training">Training</h3><p><img src="https://image.yinan.fun/202309141116049.png" /></p><p>é‡‡æ ·å¹²å‡€çš„å›¾åƒ<span class="math inline">\(x_0\)</span>ï¼Œå™ªå£°<spanclass="math inline">\(\epsilon\)</span>å’Œ<spanclass="math inline">\(t\)</span></p><p>å°†<span class="math inline">\(x_0\)</span>å’Œ<spanclass="math inline">\(\epsilon\)</span>æŒ‰ç…§ä¸tæœ‰å…³çš„æƒé‡ç›¸åŠ ï¼Œå¹¶å’Œ<spanclass="math inline">\(t\)</span>ä½œä¸ºNoisy Predictorçš„è¾“å…¥</p><p><img src="https://image.yinan.fun/202309141116051.png" /></p><h3 id="inference">Inference</h3><p><img src="https://image.yinan.fun/202309141116052.png" /></p><p><img src="https://image.yinan.fun/202309141116053.png" /></p><h2 id="å½±åƒç”Ÿæˆæ¨¡å‹æœ¬è´¨ä¸Šçš„å…±åŒç›®æ¨™">å½±åƒç”Ÿæˆæ¨¡å‹æœ¬è´¨ä¸Šçš„å…±åŒç›®æ¨™</h2><p>å›¾åƒç”Ÿæˆæ¨¡å‹å°†ç®€å•çš„åˆ†å¸ƒæ˜ å°„åˆ°å¤æ‚çš„åˆ†å¸ƒï¼Œå¹¶ä¸”è®©ç”Ÿæˆå›¾åƒçš„åˆ†å¸ƒå°½å¯èƒ½æ¥è¿‘çœŸå®å›¾åƒçš„åˆ†å¸ƒã€‚</p><p><img src="https://image.yinan.fun/202309141116054.png" /></p><h3 id="maximum-likelihood-estimation">Maximum LikelihoodEstimation</h3><p><img src="https://image.yinan.fun/202309152149527.png" /></p><p>Sample <spanclass="math inline">\(\{x^{1},x^{2},\ldots,x^{m}\}\)</span> from <spanclass="math inline">\(P_{d a t a}(x)\)</span> ï¼Œè®©æ¨¡å‹ç”Ÿæˆé‡‡æ ·çš„æ ·æœ¬<span class="math inline">\(\{x^{1},x^{2},\ldots,x^{m}\}\)</span>çš„æ¦‚ç‡æœ€å¤§ <span class="math display">\[\begin{align*}\theta^{*}&amp;=a rg\operatorname*{max}_{\theta}\prod_{i=1}^{m}P_{\theta}\left(x^{i}\right)\=a r g\operatorname*{max}_{\theta}l og\prod_{i=1}^{m}P_{\theta}\left(x^{i}\right)\\&amp;=a r g\,\operatorname*{max}_{\theta}\sum_{i=1}^{m}l o gP_{\theta}(x^{i})\,\approx a r g\,\operatorname*{max}_{\theta}E_{x-P_{da t a} }[l o g P_{\theta}(x)]\end{align*}\]</span> å‡å»ä¸ <span class="math inline">\(\theta\)</span>æ— å…³çš„ç¬¬äºŒé¡¹ <span class="math inline">\(\int_{x}P_{d a t a}(x)l o gP_{d a t a}(x)d x\)</span> <span class="math display">\[\begin{align*}&amp;=a r g\operatorname*{max}_{\theta}\int_{x}P_{d a t a}(x)l o gP_{\theta}(x)d x -\int_{x}P_{d a t a}(x)l o g P_{d a t a}(x)d x \\&amp;=a r g\operatorname*{max}_{\theta}\int_{x}P_{d a t a}(x)l og{\frac{P_{\theta}(x)}{P_{d a t a}(x)} }d x\ =a rg\operatorname*{min}_{\theta}K L(P_{d a t a}||P_{\theta})\end{align*}\]</span> Maximum Likelihood = Minimize KL Divergence</p><p>Maximum Likelihood Estimationå¯ä»¥çœ‹æˆè®©ç”Ÿæˆå›¾åƒçš„åˆ†å¸ƒä¸çœŸå®å›¾åƒçš„åˆ†å¸ƒå°½å¯èƒ½å°</p><h3 id="vae-compute-p_thetax">VAE: Compute <spanclass="math inline">\(P_{\theta}(x)\)</span></h3><p><img src="https://image.yinan.fun/202309152149516.png" /></p><p>å…ˆsample <span class="math inline">\(z\)</span> å†å¾—åˆ° <spanclass="math inline">\(x\)</span>ï¼Œ<spanclass="math inline">\(P(z)\)</span>å¾ˆå®¹æ˜“è®¡ç®— <spanclass="math display">\[P_{\theta}(x)=\int_{z}P(z)P_{\theta}\left(x|z\right)d z\]</span></p><ul><li>å¯ä»¥å®šä¹‰<span class="math inline">\(P_{\theta}(x|z)\)</span></li></ul><p><span class="math display">\[P_{\theta}(x|z)=\begin{cases}1,\qquad G(z)=x \\0,\qquad G(z)\neq x\end{cases}\]</span></p><p>é—®é¢˜æ˜¯<spanclass="math inline">\(P_{\theta}(x|z)\)</span>å¯èƒ½ä¼šå‡ ä¹éƒ½æ˜¯ 0</p><p><img src="https://image.yinan.fun/202309152150349.png" /></p><p>å‡è®¾ç½‘ç»œçš„è¾“å‡º<spanclass="math inline">\(G(z)\)</span>æ˜¯Gaussianåˆ†å¸ƒçš„meanï¼Œå¯å¾—ï¼Ÿ</p><p>G(z)å’Œxçš„è·ç¦»è¶Šå°ï¼Œ<spanclass="math inline">\(P_{\theta}(x|z)\)</span>å°±è¶Šå¤§</p><p><span class="math display">\[{ {P_{\theta}(x|z)} } \propto\ e x p(-||G(z)-x||_{2})\]</span></p><h3 id="vae-lower-bound-of-logp_thetax">VAE: Lower bound of <spanclass="math inline">\(logP_{\theta}(x)\)</span></h3><p><img src="https://image.yinan.fun/202309161534378.png" /></p><p>ä¸‹é¢çš„å…¬å¼ä¸­çš„<span class="math inline">\(q(z|x)\)</span>å¯ä»¥æ˜¯ä»»æ„çš„åˆ†å¸ƒï¼Œåœ¨VAEä¸­æ˜¯Encoder $$ <spanclass="math display">\[\begin{align}l o g P_{\theta}(x)&amp;=\int_{z}\,q(z|x)l o g P(x)d z \\&amp;=\int_{z}q(z|x)l o g\left({\frac{P(z,x)}{P(z|x)} }\right)d z\=\int_{z}\,q(z|x)l o g\left({\frac{P(z,x)}{q(z|x)}}{\frac{q(z|x)}{P(z|x)} }\right)d z  \\&amp;=\int_{z}q(z|x)l o g\left({\frac{P(z,x)}{q(z|x)} }\right)dz+\int_{z}q(z|x)l o g\left({\frac{q(z|x)}{P(z|x)} }\right)d z\end{align}\]</span> <span class="math display">\[ç¬¬äºŒé¡¹æ˜¯$KL\left(q(z|x)||P(z|x)\right)$ï¼Œå§‹ç»ˆå¤§äº0ï¼Œå› æ­¤\]</span> _{z},q(z|x)l o g,(),d zÂ =[l o g,()] $$ å¯ä»¥é€šè¿‡æœ€å¤§åŒ–Lowerboundæ¥ä½¿<span class="math inline">\(logP(x)_{\theta}\)</span>æœ€å¤§</p><h3 id="ddpm-compute-p_thetax">DDPM: Compute <spanclass="math inline">\(P_{\theta}(x)\)</span></h3><p><img src="https://image.yinan.fun/202309152150350.png" /> <spanclass="math display">\[P_{\theta}(x_{0})=\int_{x_{1}:x_{T}}P\left(x_{T}\right)P_{\theta}(x_{T-1}|x_{T})\ldotsP_{\theta}(x_{t-1}|x_{t})\ldots P_{\theta}(x_{0}|x_{1})d x_{1}:x_{T}\]</span> è¡¨ç¤ºå¯¹æ‰€æœ‰å¯èƒ½çš„<spanclass="math inline">\(x_{1}:x_{T}\)</span>æ±‚ç§¯åˆ†</p><p>é€šè¿‡ä¸VAEç›¸åŒçš„æ¨å¯¼ï¼Œå¯ä»¥è®¡ç®—å¾—åˆ°DDPM <spanclass="math inline">\(logP_{\theta}(x)\)</span> çš„lower bound</p><p><img src="https://image.yinan.fun/202309152150351.png" /> <spanclass="math display">\[q(x_{1};x_{T}|x_{0})=q(x_{1}|x_{0})q(x_{2}|x_{1})\ldots q(x_{T}|x_{T-1})\]</span></p><h3 id="è®¡ç®—-qx_tx_0">è®¡ç®— <spanclass="math inline">\(q(x_t|x_0)\)</span></h3><p><img src="https://image.yinan.fun/202309152150352.png" /></p><p>å…¶ä¸­</p><p><img src="https://image.yinan.fun/202309152150353.png" /></p><p>æ¨ç†å¯å¾— <span class="math display">\[x_t = {\sqrt{1-\beta_{1} }}\ldots{\sqrt{1-\beta_{t} }} \times x_0+\sqrt{1-(1-\beta_{1})\dots(1-\beta_{t})} \times \epsilon\]</span> ä»¤<span class="math inline">\(\sqrt{\overline{\alpha}_{t} } =(1-\beta_{1})\dots(1-\beta_{t})\)</span>ï¼Œ <span class="math display">\[x_t = \sqrt{\overline{\alpha}_{t} } \times x_0+ \sqrt{1 -\overline{\alpha}_{t} } \times \epsilon\]</span></p><h3 id="ddpm-lower-bound-of-logp_thetax">DDPM: Lower bound of <spanclass="math inline">\(logP_{\theta}(x)\)</span></h3><p>ç»è¿‡æ•°å­¦æ¨ç†ã€‚ã€‚ã€‚</p><p><ahref="https://arxiv.org/pdf/2208.11970.pdf">https://arxiv.org/pdf/2208.11970.pdf</a></p><p><img src="https://image.yinan.fun/202309152150354.png" /></p><p>å¾—åˆ°<span class="math inline">\(logP_{\theta}(x)\)</span>çš„lowerboundï¼š <span class="math display">\[\operatorname{E}_{q}(x_{1}|x_{0})\left[l o g P(x_{0}|x_{1})\right]\,-KL{\bigl(}q(x_{T}|x_{0}){\bigr)}||P(x_{T}){\bigr)}-\sum_{t=2}^{T}\operatorname{E}_{q}(x_{t}|x_{0})\left[KL{\bigl(}q(x_{t-1}|x_{t},x_{0})||P(x_{t-1}|x_{t})\bigr)\right]\]</span> ç¬¬äºŒé¡¹<span class="math inline">\(KL{\bigl(}q(x_{T}|x_{0}){\bigr)}||P(x_{T}){\bigr)}\)</span>ä¸ç½‘ç»œæ²¡æœ‰å…³ç³»ï¼Œä¸éœ€è¦è€ƒè™‘</p><p>å…ˆè€ƒè™‘ç¬¬ä¸‰é¡¹<spanclass="math inline">\(\sum_{t=2}^{T}\operatorname{E}_{q}(x_{t}|x_{0})\left[KL{\bigl(}q(x_{t-1}|x_{t},x_{0})||P(x_{t-1}|x_{t})\bigr)\right]\)</span></p><p><img src="https://image.yinan.fun/202309152150355.png" /> <spanclass="math display">\[\begin{align}q(x_{t-1}|x_{t},x_{0})&amp;={\frac{q(x_{t-1},x_{t},x_{0})}{q(x_{t},x_{0})}}\\&amp;={\frac{q(x_{t}|x_{t-1})q(x_{t-1}|x_{0})q(x_{0})}{q(x_{t}|x_{0})q(x_{0})}} \\&amp;={\frac{q(x_{t}|x_{t-1})q(x_{t-1}|x_{0})}{q(x_{t}|x_{0})} }\end{align}\]</span> å†ç»è¿‡æ•°å­¦æ¨ç†ã€‚ã€‚ã€‚</p><p><img src="https://image.yinan.fun/202309152150356.png" /></p><p>å¾—åˆ°<spanclass="math inline">\(q(x_{t-1}|x_{t},x_{0})\)</span>ä¾æ—§æ˜¯Gaussianåˆ†å¸ƒï¼Œå‡å€¼å’Œæ–¹å·®åˆ†åˆ«æ˜¯</p><p><img src="https://image.yinan.fun/202309152150357.png" /></p><p>æ‰€ä»¥ï¼Œç¬¬ä¸‰é¡¹å°±æ˜¯æœ€å°åŒ–ä¸¤ä¸ªGaussianåˆ†å¸ƒçš„KLæ•£åº¦</p><p>è®¡ç®—ä¸¤ä¸ªGaussianåˆ†å¸ƒçš„KLæ•£åº¦çš„å…¬å¼ <span class="math display">\[D_{\mathrm{KL} }({\cal N}(x;\mu_{x},\Sigma_{x})\parallel{\calN}(y;\mu_{y},\Sigma_{y}))=\frac{1}{2}\left[\log\frac{\left|\Sigma_{y}\right|}{\left|\Sigma_{x}\right|}-d+\mathrm{tr}(\Sigma_{y}^{-1}\Sigma_{x})+(\mu_{y}-\mu_{x})^{T}\Sigma_{y}^{-1}(\mu_{y}-\mu_{x})\right]\]</span></p><ul><li>æ›´ç®€å•çš„æ–¹æ³•</li></ul><p><spanclass="math inline">\(q(x_{t-1}|x_{t},x_{0})\)</span>çš„å‡å€¼å’Œæ–¹å·®æ˜¯å›ºå®šçš„ï¼Œä¸ç½‘ç»œæ— å…³</p><p>å¯¹äº<spanclass="math inline">\(P(x_{t-1}|x_{t})\bigr)\)</span>ï¼Œåªè€ƒè™‘å‡å€¼</p><p><img src="https://image.yinan.fun/202309152150358.png" /></p><p>è¦æœ€å°åŒ–ä¸¤ä¸ªGaussiançš„åˆ†å¸ƒçš„KLæ•£åº¦ï¼Œå°±è¦è®©ä»–ä»¬çš„å‡å€¼æ›´æ¥è¿‘</p><p><img src="https://image.yinan.fun/202309152150359.png" /> <spanclass="math display">\[x_{t}=\sqrt{\bar{\alpha}_{t} }x_{0}+\sqrt{1-\bar{\alpha}_{t}}\varepsilon\]</span></p><p><span class="math display">\[x_{t}-\sqrt{1-\bar{\alpha}_{t} }\varepsilon=\sqrt{\bar{\alpha}_{t}}x_{0}\]</span></p><p><span class="math display">\[{\frac{x_{t}-{\sqrt{1-{\bar{\alpha} }_{t} }\varepsilon} }{ {\sqrt{{\bar{\alpha} }_{t} }} }}=x_{0}\]</span></p><p>å°†<spanclass="math inline">\(x_0\)</span>ä»£å…¥å‡å€¼çš„å…¬å¼ä¸­ï¼Œå†ç»è¿‡æ•°å­¦æ¨ç†ã€‚ã€‚ã€‚<span class="math display">\[\frac{\sqrt{\alpha_{t-1}}\beta_{t}\left(\frac{\alpha_{t}-\sqrt{1-\overline{\alpha_{t}}}\varepsilon}{\sqrt{\overline{\alpha_{t} }} }\right)+\sqrt{\alpha_{t}}(1-\overline{\alpha}_{t-1})x_{t} }{1-\overline{\alpha}_{t} } \\=\frac{1}{\sqrt{\alpha_{t} }}\left(x_{t}-\frac{1-\alpha_{t}}{\sqrt{1-\overline{\alpha}_{t} }}\,\varepsilon\right)\]</span></p><p>ä¸Šå¼ä¸­åªæœ‰<spanclass="math inline">\(\epsilon\)</span>æ˜¯æœªçŸ¥çš„ï¼Œéœ€è¦ç½‘ç»œé¢„æµ‹ï¼ˆ<spanclass="math inline">\(\epsilon\)</span>æ˜¯åŠ ä¸Š<spanclass="math inline">\(x_0\)</span>ç”Ÿæˆ<spanclass="math inline">\(x_t\)</span>çš„å™ªå£°ï¼‰</p><p><img src="https://image.yinan.fun/202309152150360.png" /></p><p><img src="https://image.yinan.fun/202309152150361.png" /></p><h2 id="samplingä¸ºä»€ä¹ˆè¦åŠ noise">Samplingä¸ºä»€ä¹ˆè¦åŠ Noise</h2><p><img src="https://image.yinan.fun/202309152150362.png" /></p><p>ä¸ºä»€ä¹ˆä¸ç›´æ¥å– Meanï¼Ÿ</p><p><img src="https://image.yinan.fun/202309152150363.png" /></p><p>ä»¥ä¸‹æ˜¯æå®æ¯…è€å¸ˆçš„çŒœæµ‹ï¼š</p><p>åŒæ ·çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆç”Ÿæˆæ–‡å¥æ™‚éœ€è¦ Sampleï¼Ÿ</p><p><img src="https://image.yinan.fun/202309152150364.png" /></p><ul><li><p>The Curious Case of Neural Text Degeneration</p><p><ahref="https://arxiv.org/abs/1904.09751">https://arxiv.org/abs/1904.09751</a></p><p>ç”Ÿæˆæ–‡å¥ä½¿ç”¨Sampleæ•ˆæœæ›´å¥½ï¼Œè¾“å‡ºæœ€å¤§æ¦‚ç‡ä¼šä¸€ç›´è¾“å‡ºé‡å¤çš„å¥å­ã€‚</p><p><img src="https://image.yinan.fun/202309152150365.png" /></p></li><li><p>èªéŸ³åˆæˆä¹Ÿéœ€è¦ Sampling !</p><p>åœ¨æ¨ç†çš„æ—¶å€™åŠ å…¥dropoutå¯ä»¥è·å¾—æ›´é«˜çš„ç»“æœ</p><p><ahref="https://arxiv.org/abs/1712.05884">https://arxiv.org/abs/1712.05884</a></p><p><img src="https://image.yinan.fun/202309152150366.png" /></p></li><li><p>Diffusion Model æ˜¯ä¸€ç¨® <strong>Autoregressive</strong></p></li></ul><p><img src="https://image.yinan.fun/202309152150367.png" /></p><blockquote><p>Auto-regression is a time series model that <strong>uses observationsfrom previous time steps as input</strong> to a regression equation topredict the value at the next time step</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æå®æ¯…</tag>
      
      <tag>ç”Ÿæˆæ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Linuxå‘½ä»¤å¤§å…¨</title>
    <link href="/Linux%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.html"/>
    <url>/Linux%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.html</url>
    
    <content type="html"><![CDATA[<h1 id="linux-å¸¸ç”¨æ“ä½œå‘½ä»¤å¤§å…¨">Linux å¸¸ç”¨æ“ä½œå‘½ä»¤å¤§å…¨</h1><p>https://blog.csdn.net/m0_46422300/article/details/104645072</p><h1 id="ä¸€åŸºç¡€çŸ¥è¯†">ä¸€ã€åŸºç¡€çŸ¥è¯†</h1><h2 id="linuxç³»ç»Ÿçš„æ–‡ä»¶ç»“æ„">1.1 Linuxç³»ç»Ÿçš„æ–‡ä»¶ç»“æ„</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">/bin        äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç³»ç»Ÿå¸¸è§„å‘½ä»¤<br>/boot       ç³»ç»Ÿå¯åŠ¨åˆ†åŒºï¼Œç³»ç»Ÿå¯åŠ¨æ—¶è¯»å–çš„æ–‡ä»¶<br>/dev        è®¾å¤‡æ–‡ä»¶<br>/etc        å¤§å¤šæ•°é…ç½®æ–‡ä»¶<br>/home       æ™®é€šç”¨æˆ·çš„å®¶ç›®å½•<br>/lib        32ä½å‡½æ•°åº“<br>/lib64      64ä½åº“<br>/media      æ‰‹åŠ¨ä¸´æ—¶æŒ‚è½½ç‚¹<br>/mnt        æ‰‹åŠ¨ä¸´æ—¶æŒ‚è½½ç‚¹<br>/opt        ç¬¬ä¸‰æ–¹è½¯ä»¶å®‰è£…ä½ç½®<br>/proc       è¿›ç¨‹ä¿¡æ¯åŠç¡¬ä»¶ä¿¡æ¯<br>/root       ä¸´æ—¶è®¾å¤‡çš„é»˜è®¤æŒ‚è½½ç‚¹<br>/sbin       ç³»ç»Ÿç®¡ç†å‘½ä»¤<br>/srv        æ•°æ®<br>/var        æ•°æ®<br>/sys        å†…æ ¸ç›¸å…³ä¿¡æ¯<br>/tmp        ä¸´æ—¶æ–‡ä»¶<br>/usr        ç”¨æˆ·ç›¸å…³è®¾å®š<br></code></pre></td></tr></table></figure><h2 id="linuxç³»ç»Ÿå‘½ä»¤è¡Œçš„å«ä¹‰">1.2 Linuxç³»ç»Ÿå‘½ä»¤è¡Œçš„å«ä¹‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">ç¤ºä¾‹ï¼šroot@app00:~<span class="hljs-comment"># </span><br>root    <span class="hljs-regexp">//</span>ç”¨æˆ·åï¼Œrootä¸ºè¶…çº§ç”¨æˆ·<br>@       <span class="hljs-regexp">//</span>åˆ†éš”ç¬¦<br>app00   <span class="hljs-regexp">//</span>ä¸»æœºåç§°<br>~       <span class="hljs-regexp">//</span>å½“å‰æ‰€åœ¨ç›®å½•ï¼Œé»˜è®¤ç”¨æˆ·ç›®å½•ä¸º~ï¼Œä¼šéšç€ç›®å½•åˆ‡æ¢è€Œå˜åŒ–ï¼Œä¾‹å¦‚ï¼šï¼ˆroot@app00:/bin<span class="hljs-comment"># ï¼Œå½“å‰ä½ç½®åœ¨binç›®å½•ä¸‹ï¼‰</span><br><span class="hljs-comment">#       //è¡¨ç¤ºå½“å‰ç”¨æˆ·æ˜¯è¶…çº§ç”¨æˆ·ï¼Œæ™®é€šç”¨æˆ·ä¸º$ï¼Œä¾‹å¦‚ï¼šï¼ˆ&quot;yao@app00:/root$&quot; ï¼Œè¡¨ç¤ºä½¿ç”¨ç”¨æˆ·&quot;yao&quot;è®¿é—®/rootæ–‡ä»¶å¤¹ï¼‰</span><br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤çš„ç»„æˆ">1.3 å‘½ä»¤çš„ç»„æˆ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs undefined">ç¤ºä¾‹ï¼šå‘½ä»¤ å‚æ•°å å‚æ•°å€¼<br></code></pre></td></tr></table></figure><h1 id="äºŒåŸºç¡€æ“ä½œ">äºŒã€åŸºç¡€æ“ä½œ</h1><h2 id="é‡å¯ç³»ç»Ÿ">2.1 é‡å¯ç³»ç»Ÿ</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arduino">(<span class="hljs-number">1</span>)ç«‹åˆ»å…³æœº<br>  shutdown -h now æˆ–è€… <span class="hljs-built_in">poweroff</span><br>(<span class="hljs-number">2</span>)ä¸¤åˆ†é’Ÿåå…³æœº<br>  shutdown -h <span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><h2 id="å…³é—­ç³»ç»Ÿ">2.2 å…³é—­ç³»ç»Ÿ</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arduino">(<span class="hljs-number">1</span>)ç«‹åˆ»é‡å¯<br>  shutdown -r now æˆ–è€… <span class="hljs-built_in">reboot</span><br>(<span class="hljs-number">2</span>)ä¸¤åˆ†é’Ÿåé‡å¯<br>  shutdown -r <span class="hljs-number">2</span> <br></code></pre></td></tr></table></figure><h2 id="å¸®åŠ©å‘½ä»¤help">2.3 å¸®åŠ©å‘½ä»¤ï¼ˆhelpï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ifconfig  --help     <span class="hljs-regexp">//</span>æŸ¥çœ‹ ifconfig å‘½ä»¤çš„ç”¨æ³•<br></code></pre></td></tr></table></figure><h2 id="å‘½ä»¤è¯´æ˜ä¹¦man">2.4 å‘½ä»¤è¯´æ˜ä¹¦ï¼ˆmanï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">man shutdown         <span class="hljs-regexp">//</span>æ‰“å¼€å‘½ä»¤è¯´æ˜åï¼Œå¯æŒ‰<span class="hljs-string">&quot;q&quot;</span>é”®é€€å‡º<br></code></pre></td></tr></table></figure><h2 id="åˆ‡æ¢ç”¨æˆ·su">2.5 åˆ‡æ¢ç”¨æˆ·ï¼ˆsuï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">su yao               <span class="hljs-regexp">//</span>åˆ‡æ¢ä¸ºç”¨æˆ·<span class="hljs-string">&quot;yao&quot;</span>,è¾“å…¥åå›è½¦éœ€è¦è¾“å…¥è¯¥ç”¨æˆ·çš„å¯†ç <br><span class="hljs-keyword">exit</span>                 <span class="hljs-regexp">//</span>é€€å‡ºå½“å‰ç”¨æˆ·<br></code></pre></td></tr></table></figure><h1 id="ä¸‰ç›®å½•æ“ä½œ">ä¸‰ã€ç›®å½•æ“ä½œ</h1><h2 id="åˆ‡æ¢ç›®å½•cd">3.1 åˆ‡æ¢ç›®å½•ï¼ˆcdï¼‰</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">cd</span> /                 <span class="hljs-string">//</span>åˆ‡æ¢åˆ°æ ¹ç›®å½•<br><span class="hljs-keyword">cd</span> <span class="hljs-string">/bin</span>              <span class="hljs-string">//</span>åˆ‡æ¢åˆ°æ ¹ç›®å½•ä¸‹çš„binç›®å½•<br><span class="hljs-keyword">cd</span> <span class="hljs-string">../</span>               <span class="hljs-string">//</span>åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½• æˆ–è€…ä½¿ç”¨å‘½ä»¤ï¼š<span class="hljs-keyword">cd</span> <span class="hljs-string">..</span><br><span class="hljs-keyword">cd</span> ~                 <span class="hljs-string">//</span>åˆ‡æ¢åˆ°homeç›®å½•<br><span class="hljs-keyword">cd</span> -                 <span class="hljs-string">//</span>åˆ‡æ¢åˆ°ä¸Šæ¬¡è®¿é—®çš„ç›®å½•<br><span class="hljs-keyword">cd</span> xx<span class="hljs-params">(æ–‡ä»¶å¤¹å)</span>       <span class="hljs-string">//</span>åˆ‡æ¢åˆ°æœ¬ç›®å½•ä¸‹çš„åä¸ºxxçš„æ–‡ä»¶ç›®å½•ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨æŠ¥é”™<br><span class="hljs-keyword">cd</span> <span class="hljs-string">/xxx/xx/x</span>         <span class="hljs-string">//</span>å¯ä»¥è¾“å…¥å®Œæ•´çš„è·¯å¾„ï¼Œç›´æ¥åˆ‡æ¢åˆ°ç›®æ ‡ç›®å½•ï¼Œè¾“å…¥è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨tabé”®å¿«é€Ÿè¡¥å…¨<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹ç›®å½•ls">3.2 æŸ¥çœ‹ç›®å½•ï¼ˆlsï¼‰</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">ls</span>                   <span class="hljs-string">//</span>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶<br><span class="hljs-keyword">ls</span> -a                <span class="hljs-string">//</span>æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—çš„æ–‡ä»¶ï¼‰<br><span class="hljs-keyword">ls</span> -l                <span class="hljs-string">//</span>åˆ—è¡¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåˆ—è¡¨æŸ¥çœ‹ï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯ï¼‰ï¼Œä¸å‘½ä»¤<span class="hljs-string">&quot;ll&quot;</span>æ•ˆæœä¸€æ ·<br><span class="hljs-keyword">ls</span> <span class="hljs-string">/bin</span>              <span class="hljs-string">//</span>æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ <br></code></pre></td></tr></table></figure><h2 id="åˆ›å»ºç›®å½•mkdir">3.3 åˆ›å»ºç›®å½•ï¼ˆmkdirï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">mkdir tools          <span class="hljs-regexp">//</span>åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºtoolsçš„ç›®å½•<br>mkdir <span class="hljs-regexp">/bin/</span>tools     <span class="hljs-regexp">//</span>åœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºtoolsçš„ç›®å½•<br></code></pre></td></tr></table></figure><h2 id="åˆ é™¤ç›®å½•ä¸æ–‡ä»¶rm">3.3 åˆ é™¤ç›®å½•ä¸æ–‡ä»¶ï¼ˆrmï¼‰</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">rm</span> æ–‡ä»¶å              <span class="hljs-comment">//åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="hljs-keyword">rm</span> -f æ–‡ä»¶å           <span class="hljs-comment">//åˆ é™¤å½“å‰ç›®å½•çš„çš„æ–‡ä»¶ï¼ˆä¸è¯¢é—®ï¼‰</span><br><span class="hljs-keyword">rm</span> -r æ–‡ä»¶å¤¹å         <span class="hljs-comment">//é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹æ­¤åçš„ç›®å½•</span><br><span class="hljs-keyword">rm</span> -rf æ–‡ä»¶å¤¹å        <span class="hljs-comment">//é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹æ­¤åçš„ç›®å½•ï¼ˆä¸è¯¢é—®ï¼‰</span><br><span class="hljs-keyword">rm</span> -rf *              <span class="hljs-comment">//å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶å…¨éƒ¨åˆ é™¤</span><br><span class="hljs-keyword">rm</span> -rf <span class="hljs-comment">/*             //å°†æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨åˆ é™¤ã€æ…ç”¨ï¼ç›¸å½“äºæ ¼å¼åŒ–ç³»ç»Ÿã€‘</span><br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹ç›®å½•mv">3.4 ä¿®æ”¹ç›®å½•ï¼ˆmvï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">mv å½“å‰ç›®å½•å æ–°ç›®å½•å        <span class="hljs-regexp">//</span>ä¿®æ”¹ç›®å½•åï¼ŒåŒæ ·é€‚ç”¨ä¸æ–‡ä»¶æ“ä½œ<br> <span class="hljs-regexp">/usr/</span>tmp<span class="hljs-regexp">/tool /</span>opt       <span class="hljs-regexp">//</span>å°†<span class="hljs-regexp">/usr/</span>tmpç›®å½•ä¸‹çš„toolç›®å½•å‰ªåˆ‡åˆ° /optç›®å½•ä¸‹é¢<br>mv -r <span class="hljs-regexp">/usr/</span>tmp<span class="hljs-regexp">/tool /</span>opt    <span class="hljs-regexp">//</span>é€’å½’å‰ªåˆ‡ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹<br></code></pre></td></tr></table></figure><h2 id="æ‹·è´ç›®å½•cp">3.5 æ‹·è´ç›®å½•ï¼ˆcpï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">cp <span class="hljs-regexp">/usr/</span>tmp<span class="hljs-regexp">/tool /</span>opt       <span class="hljs-regexp">//</span>å°†<span class="hljs-regexp">/usr/</span>tmpç›®å½•ä¸‹çš„toolç›®å½•å¤åˆ¶åˆ° /optç›®å½•ä¸‹é¢<br>cp -r <span class="hljs-regexp">/usr/</span>tmp<span class="hljs-regexp">/tool /</span>opt    <span class="hljs-regexp">//</span>é€’å½’å‰ªå¤åˆ¶ç›®å½•ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹<br></code></pre></td></tr></table></figure><h2 id="æœç´¢ç›®å½•find">3.6 æœç´¢ç›®å½•ï¼ˆfindï¼‰</h2><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">find</span> <span class="hljs-regexp">/bin -name &#x27;a*&#x27;        /</span><span class="hljs-regexp">/æŸ¥æ‰¾/</span>binç›®å½•ä¸‹çš„æ‰€æœ‰ä»¥aå¼€å¤´çš„æ–‡ä»¶æˆ–è€…ç›®å½•<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹å½“å‰ç›®å½•pwd">3.7 æŸ¥çœ‹å½“å‰ç›®å½•ï¼ˆpwdï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">pwd                         <span class="hljs-regexp">//</span>æ˜¾ç¤ºå½“å‰ä½ç½®è·¯å¾„<br></code></pre></td></tr></table></figure><h1 id="å››æ–‡ä»¶æ“ä½œ">å››ã€æ–‡ä»¶æ“ä½œ</h1><h2 id="æ–°å¢æ–‡ä»¶touch">4.1 æ–°å¢æ–‡ä»¶ï¼ˆtouchï¼‰</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">touch  <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>         <span class="hljs-comment">//åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºåä¸ºaçš„txtæ–‡ä»¶ï¼ˆæ–‡ä»¶ä¸å­˜åœ¨ï¼‰ï¼Œå¦‚æœæ–‡ä»¶å­˜åœ¨ï¼Œå°†æ–‡ä»¶æ—¶é—´å±æ€§ä¿®æ”¹ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´</span><br></code></pre></td></tr></table></figure><h2 id="åˆ é™¤æ–‡ä»¶rm">4.2 åˆ é™¤æ–‡ä»¶ï¼ˆrmï¼‰</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">rm æ–‡ä»¶å              <span class="hljs-regexp">//</span>åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶<br>rm -f æ–‡ä»¶å           <span class="hljs-regexp">//</span>åˆ é™¤å½“å‰ç›®å½•çš„çš„æ–‡ä»¶ï¼ˆä¸è¯¢é—®ï¼‰<br></code></pre></td></tr></table></figure><h2 id="ç¼–è¾‘æ–‡ä»¶vivim">4.3 ç¼–è¾‘æ–‡ä»¶ï¼ˆviã€vimï¼‰</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">vi</span> æ–‡ä»¶å              //æ‰“å¼€éœ€è¦ç¼–è¾‘çš„æ–‡ä»¶<br>--è¿›å…¥åï¼Œæ“ä½œç•Œé¢æœ‰ä¸‰ç§æ¨¡å¼ï¼šå‘½ä»¤æ¨¡å¼ï¼ˆ<span class="hljs-keyword">command</span> <span class="hljs-keyword">mode</span>ï¼‰ã€æ’å…¥æ¨¡å¼ï¼ˆInsert <span class="hljs-keyword">mode</span>ï¼‰å’Œåº•è¡Œæ¨¡å¼ï¼ˆ<span class="hljs-keyword">last</span> <span class="hljs-built_in">line</span> <span class="hljs-keyword">mode</span>ï¼‰<br>å‘½ä»¤æ¨¡å¼<br>-åˆšè¿›å…¥æ–‡ä»¶å°±æ˜¯å‘½ä»¤æ¨¡å¼ï¼Œé€šè¿‡æ–¹å‘é”®æ§åˆ¶å…‰æ ‡ä½ç½®ï¼Œ<br>-ä½¿ç”¨å‘½ä»¤<span class="hljs-string">&quot;dd&quot;</span>åˆ é™¤å½“å‰æ•´è¡Œ<br>-ä½¿ç”¨å‘½ä»¤<span class="hljs-string">&quot;/å­—æ®µ&quot;</span>è¿›è¡ŒæŸ¥æ‰¾<br>-æŒ‰<span class="hljs-string">&quot;i&quot;</span>åœ¨å…‰æ ‡æ‰€åœ¨å­—ç¬¦å‰å¼€å§‹æ’å…¥<br>-æŒ‰<span class="hljs-string">&quot;a&quot;</span>åœ¨å…‰æ ‡æ‰€åœ¨å­—ç¬¦åå¼€å§‹æ’å…¥<br>-æŒ‰<span class="hljs-string">&quot;o&quot;</span>åœ¨å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹é¢å¦èµ·ä¸€æ–°è¡Œæ’å…¥<br>-æŒ‰<span class="hljs-string">&quot;ï¼š&quot;</span>è¿›å…¥åº•è¡Œæ¨¡å¼<br>æ’å…¥æ¨¡å¼<br>-æ­¤æ—¶å¯ä»¥å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œç¼–è¾‘ï¼Œå·¦ä¸‹è§’ä¼šæ˜¾ç¤º <span class="hljs-string">&quot;-- æ’å…¥ --&quot;</span><span class="hljs-comment">&quot;</span><br>-æŒ‰<span class="hljs-string">&quot;ESC&quot;</span>è¿›å…¥åº•è¡Œæ¨¡å¼<br>åº•è¡Œæ¨¡å¼<br>-é€€å‡ºç¼–è¾‘ï¼š      :q<br>-å¼ºåˆ¶é€€å‡ºï¼š      :q!<br>-ä¿å­˜å¹¶é€€å‡ºï¼š    :<span class="hljs-keyword">wq</span><br>## æ“ä½œæ­¥éª¤ç¤ºä¾‹ ##<br><span class="hljs-number">1</span>.ä¿å­˜æ–‡ä»¶ï¼šæŒ‰<span class="hljs-string">&quot;ESC&quot;</span> -&gt; è¾“å…¥<span class="hljs-string">&quot;:&quot;</span> -&gt; è¾“å…¥<span class="hljs-string">&quot;wq&quot;</span>,å›è½¦     //ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘<br><span class="hljs-number">2</span>.å–æ¶ˆæ“ä½œï¼šæŒ‰<span class="hljs-string">&quot;ESC&quot;</span> -&gt; è¾“å…¥<span class="hljs-string">&quot;:&quot;</span> -&gt; è¾“å…¥<span class="hljs-string">&quot;q!&quot;</span>,å›è½¦     //æ’¤é”€æœ¬æ¬¡ä¿®æ”¹å¹¶é€€å‡ºç¼–è¾‘<br>## è¡¥å…… ##<br><span class="hljs-keyword">vim</span> +<span class="hljs-number">10</span> filename.txt                   //æ‰“å¼€æ–‡ä»¶å¹¶è·³åˆ°ç¬¬<span class="hljs-number">10</span>è¡Œ<br><span class="hljs-keyword">vim</span> -R /etc/passwd                     //ä»¥åªè¯»æ¨¡å¼æ‰“å¼€æ–‡ä»¶<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ–‡ä»¶">4.4 æŸ¥çœ‹æ–‡ä»¶</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">cat <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>          <span class="hljs-comment">//æŸ¥çœ‹æ–‡ä»¶æœ€åä¸€å±å†…å®¹</span><br>less <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>         <span class="hljs-comment">//PgUpå‘ä¸Šç¿»é¡µï¼ŒPgDnå‘ä¸‹ç¿»é¡µï¼Œ&quot;q&quot;é€€å‡ºæŸ¥çœ‹</span><br>more <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>         <span class="hljs-comment">//æ˜¾ç¤ºç™¾åˆ†æ¯”ï¼Œå›è½¦æŸ¥çœ‹ä¸‹ä¸€è¡Œï¼Œç©ºæ ¼æŸ¥çœ‹ä¸‹ä¸€é¡µï¼Œ&quot;q&quot;é€€å‡ºæŸ¥çœ‹</span><br>tail -<span class="hljs-number">100</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>    <span class="hljs-comment">//æŸ¥çœ‹æ–‡ä»¶çš„å100è¡Œï¼Œ&quot;Ctrl+C&quot;é€€å‡ºæŸ¥çœ‹</span><br></code></pre></td></tr></table></figure><h1 id="äº”æ–‡ä»¶æƒé™">äº”ã€æ–‡ä»¶æƒé™</h1><h2 id="æƒé™è¯´æ˜">5.1 æƒé™è¯´æ˜</h2><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs clean">æ–‡ä»¶æƒé™ç®€ä»‹ï¼š<span class="hljs-string">&#x27;r&#x27;</span> ä»£è¡¨å¯è¯»ï¼ˆ<span class="hljs-number">4</span>ï¼‰ï¼Œ<span class="hljs-string">&#x27;w&#x27;</span> ä»£è¡¨å¯å†™ï¼ˆ<span class="hljs-number">2</span>ï¼‰ï¼Œ<span class="hljs-string">&#x27;x&#x27;</span> ä»£è¡¨æ‰§è¡Œæƒé™ï¼ˆ<span class="hljs-number">1</span>ï¼‰ï¼Œæ‹¬å·å†…ä»£è¡¨<span class="hljs-string">&quot;8421æ³•&quot;</span><br>##æ–‡ä»¶æƒé™ä¿¡æ¯ç¤ºä¾‹ï¼š-rwxrw-r--<br>-ç¬¬ä¸€ä½ï¼š<span class="hljs-string">&#x27;-&#x27;</span>å°±ä»£è¡¨æ˜¯æ–‡ä»¶ï¼Œ<span class="hljs-string">&#x27;d&#x27;</span>ä»£è¡¨æ˜¯æ–‡ä»¶å¤¹<br>-ç¬¬ä¸€ç»„ä¸‰ä½ï¼šæ‹¥æœ‰è€…çš„æƒé™<br>-ç¬¬äºŒç»„ä¸‰ä½ï¼šæ‹¥æœ‰è€…æ‰€åœ¨çš„ç»„ï¼Œç»„å‘˜çš„æƒé™<br>-ç¬¬ä¸‰ç»„ä¸‰ä½ï¼šä»£è¡¨çš„æ˜¯å…¶ä»–ç”¨æˆ·çš„æƒé™<br></code></pre></td></tr></table></figure><h2 id="æ–‡ä»¶æƒé™">5.2 æ–‡ä»¶æƒé™</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">æ™®é€šæˆæƒ    chmod +x <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>    <br><span class="hljs-number">8421</span>æ³•     chmod <span class="hljs-number">777</span> <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span>     <span class="hljs-comment">//1+2+4=7ï¼Œ&quot;7&quot;è¯´æ˜æˆäºˆæ‰€æœ‰æƒé™</span><br></code></pre></td></tr></table></figure><h1 id="å…­æ‰“åŒ…ä¸è§£å‹">å…­ã€æ‰“åŒ…ä¸è§£å‹</h1><h2 id="è¯´æ˜">6.1 è¯´æ˜</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.zip</span>ã€<span class="hljs-string">.rar</span>        <span class="hljs-string">//windows</span>ç³»ç»Ÿä¸­å‹ç¼©æ–‡ä»¶çš„æ‰©å±•å<br><span class="hljs-string">.tar</span>              <span class="hljs-string">//Linux</span>ä¸­æ‰“åŒ…æ–‡ä»¶çš„æ‰©å±•å<br><span class="hljs-string">.gz</span>               <span class="hljs-string">//Linux</span>ä¸­å‹ç¼©æ–‡ä»¶çš„æ‰©å±•å<br><span class="hljs-string">.tar.gz</span>           <span class="hljs-string">//Linux</span>ä¸­æ‰“åŒ…å¹¶å‹ç¼©æ–‡ä»¶çš„æ‰©å±•å<br></code></pre></td></tr></table></figure><h2 id="æ‰“åŒ…æ–‡ä»¶">6.2 æ‰“åŒ…æ–‡ä»¶</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">tar -zcvf æ‰“åŒ…å‹ç¼©åçš„æ–‡ä»¶å è¦æ‰“åŒ…çš„æ–‡ä»¶<br>å‚æ•°è¯´æ˜ï¼šzï¼šè°ƒç”¨gzipå‹ç¼©å‘½ä»¤è¿›è¡Œå‹ç¼©; cï¼šæ‰“åŒ…æ–‡ä»¶; vï¼šæ˜¾ç¤ºè¿è¡Œè¿‡ç¨‹; fï¼šæŒ‡å®šæ–‡ä»¶å;<br>ç¤ºä¾‹ï¼š<br>tar -zcvf a.tar file1 file2,...      <span class="hljs-regexp">//</span>å¤šä¸ªæ–‡ä»¶å‹ç¼©æ‰“åŒ…<br></code></pre></td></tr></table></figure><h2 id="è§£å‹æ–‡ä»¶">6.3 è§£å‹æ–‡ä»¶</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">tar -zxvf <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.tar</span>                      <span class="hljs-comment">//è§£åŒ…è‡³å½“å‰ç›®å½•</span><br>tar -zxvf <span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.tar</span> -C /usr------        <span class="hljs-comment">//æŒ‡å®šè§£å‹çš„ä½ç½®</span><br>unzip test<span class="hljs-selector-class">.zip</span>             <span class="hljs-comment">//è§£å‹*.zipæ–‡ä»¶ </span><br>unzip -l test<span class="hljs-selector-class">.zip</span>          <span class="hljs-comment">//æŸ¥çœ‹*.zipæ–‡ä»¶çš„å†…å®¹ </span><br></code></pre></td></tr></table></figure><h1 id="ä¸ƒå…¶ä»–å¸¸ç”¨å‘½ä»¤">ä¸ƒã€å…¶ä»–å¸¸ç”¨å‘½ä»¤</h1><h2 id="find">7.1 find</h2><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> . -<span class="hljs-built_in">name</span> <span class="hljs-string">&quot;*.c&quot;</span>     <span class="hljs-comment">//å°†ç›®å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰å»¶ä¼¸æ¡£åæ˜¯ c çš„æ–‡ä»¶åˆ—å‡ºæ¥</span><br><span class="hljs-built_in">find</span> . -<span class="hljs-built_in">type</span> f         <span class="hljs-comment">//å°†ç›®å‰ç›®å½•å…¶å…¶ä¸‹å­ç›®å½•ä¸­æ‰€æœ‰ä¸€èˆ¬æ–‡ä»¶åˆ—å‡º</span><br><span class="hljs-built_in">find</span> . -ctime -<span class="hljs-number">20</span>      <span class="hljs-comment">//å°†ç›®å‰ç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æœ€è¿‘ 20 å¤©å†…æ›´æ–°è¿‡çš„æ–‡ä»¶åˆ—å‡º</span><br><span class="hljs-built_in">find</span> /var/<span class="hljs-built_in">log</span> -<span class="hljs-built_in">type</span> f -mtime +<span class="hljs-number">7</span> -ok rm &#123;&#125; \;     <span class="hljs-comment">//æŸ¥æ‰¾/var/logç›®å½•ä¸­æ›´æ”¹æ—¶é—´åœ¨7æ—¥ä»¥å‰çš„æ™®é€šæ–‡ä»¶ï¼Œå¹¶åœ¨åˆ é™¤ä¹‹å‰è¯¢é—®å®ƒä»¬</span><br><span class="hljs-built_in">find</span> . -<span class="hljs-built_in">type</span> f -perm <span class="hljs-number">644</span> -<span class="hljs-built_in">exec</span> ls -l &#123;&#125; \;       <span class="hljs-comment">//æŸ¥æ‰¾å‰ç›®å½•ä¸­æ–‡ä»¶å±ä¸»å…·æœ‰è¯»ã€å†™æƒé™ï¼Œå¹¶ä¸”æ–‡ä»¶æ‰€å±ç»„çš„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·å…·æœ‰è¯»æƒé™çš„æ–‡ä»¶</span><br><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">type</span> f -<span class="hljs-built_in">size</span> <span class="hljs-number">0</span> -<span class="hljs-built_in">exec</span> ls -l &#123;&#125; \;         <span class="hljs-comment">//ä¸ºäº†æŸ¥æ‰¾ç³»ç»Ÿä¸­æ‰€æœ‰æ–‡ä»¶é•¿åº¦ä¸º0çš„æ™®é€šæ–‡ä»¶ï¼Œå¹¶åˆ—å‡ºå®ƒä»¬çš„å®Œæ•´è·¯å¾„</span><br></code></pre></td></tr></table></figure><h2 id="whereis">7.2 whereis</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">whereis <span class="hljs-keyword">ls</span>             <span class="hljs-string">//</span>å°†å’Œ<span class="hljs-keyword">ls</span>æ–‡ä»¶ç›¸å…³çš„æ–‡ä»¶éƒ½æŸ¥æ‰¾å‡ºæ¥<br></code></pre></td></tr></table></figure><h2 id="which">7.3 which</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šwhichæŒ‡ä»¤ä¼šåœ¨ç¯å¢ƒå˜é‡<span class="hljs-variable">$PATH</span>è®¾ç½®çš„ç›®å½•é‡ŒæŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ã€‚<br>which bash             <span class="hljs-regexp">//</span>æŸ¥çœ‹æŒ‡ä»¤<span class="hljs-string">&quot;bash&quot;</span>çš„ç»å¯¹è·¯å¾„<br></code></pre></td></tr></table></figure><h2 id="sudo">7.4 sudo</h2><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs axapta">è¯´æ˜ï¼šsudoå‘½ä»¤ä»¥ç³»ç»Ÿç®¡ç†è€…çš„èº«ä»½æ‰§è¡ŒæŒ‡ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç»ç”± sudo æ‰€æ‰§è¡Œçš„æŒ‡ä»¤å°±å¥½åƒæ˜¯ root äº²è‡ªæ‰§è¡Œã€‚éœ€è¦è¾“å…¥è‡ªå·±è´¦æˆ·å¯†ç ã€‚<br>ä½¿ç”¨æƒé™ï¼šåœ¨ /etc/sudoers ä¸­æœ‰å‡ºç°çš„ä½¿ç”¨è€…<br>sudo -l                              <span class="hljs-comment">//åˆ—å‡ºç›®å‰çš„æƒé™</span><br>$ sudo -u yao vi ~www/<span class="hljs-keyword">index</span>.html    <span class="hljs-comment">//ä»¥ yao ç”¨æˆ·èº«ä»½ç¼–è¾‘  home ç›®å½•ä¸‹wwwç›®å½•ä¸­çš„ index.html æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><h2 id="grep">7.5 grep</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">grep -i <span class="hljs-string">&quot;the&quot;</span> demo_file              <span class="hljs-regexp">//</span>åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²(ä¸åŒºåˆ†å¤§å°å†™)<br>grep -A <span class="hljs-number">3</span> -i <span class="hljs-string">&quot;example&quot;</span> demo_text     <span class="hljs-regexp">//</span>è¾“å‡ºæˆåŠŸåŒ¹é…çš„è¡Œï¼Œä»¥åŠè¯¥è¡Œä¹‹åçš„ä¸‰è¡Œ<br>grep -r <span class="hljs-string">&quot;ramesh&quot;</span> *                   <span class="hljs-regexp">//</span>åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­é€’å½’æŸ¥è¯¢åŒ…å«æŒ‡å®šå­—ç¬¦ä¸²çš„æ–‡ä»¶<br></code></pre></td></tr></table></figure><h2 id="service">7.6 service</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šserviceå‘½ä»¤ç”¨äºè¿è¡ŒSystem V initè„šæœ¬ï¼Œè¿™äº›è„šæœ¬ä¸€èˆ¬ä½äº<span class="hljs-regexp">/etc/i</span>nit.dæ–‡ä»¶ä¸‹ï¼Œè¿™ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥è¿è¡Œè¿™ä¸ªæ–‡ä»¶å¤¹é‡Œé¢çš„è„šæœ¬ï¼Œè€Œä¸ç”¨åŠ ä¸Šè·¯å¾„<br>service ssh status      <span class="hljs-regexp">//</span>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ <br>service --status-all    <span class="hljs-regexp">//</span>æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€ <br>service ssh restart     <span class="hljs-regexp">//</span>é‡å¯æœåŠ¡ <br></code></pre></td></tr></table></figure><h2 id="free">7.7 free</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šè¿™ä¸ªå‘½ä»¤ç”¨äºæ˜¾ç¤ºç³»ç»Ÿå½“å‰å†…å­˜çš„ä½¿ç”¨æƒ…å†µï¼ŒåŒ…æ‹¬å·²ç”¨å†…å­˜ã€å¯ç”¨å†…å­˜å’Œäº¤æ¢å†…å­˜çš„æƒ…å†µ <br>free -g            <span class="hljs-regexp">//</span>ä»¥Gä¸ºå•ä½è¾“å‡ºå†…å­˜çš„ä½¿ç”¨é‡ï¼Œ-gä¸ºGBï¼Œ-mä¸ºMBï¼Œ-kä¸ºKBï¼Œ-bä¸ºå­—èŠ‚ <br>free -t            <span class="hljs-regexp">//</span>æŸ¥çœ‹æ‰€æœ‰å†…å­˜çš„æ±‡æ€»<br></code></pre></td></tr></table></figure><h2 id="top">7.8 top</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">top               <span class="hljs-regexp">//</span>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­å ç”¨èµ„æºæœ€å¤šçš„ä¸€äº›è¿›ç¨‹, shift+m æŒ‰ç…§å†…å­˜å¤§å°æŸ¥çœ‹<br></code></pre></td></tr></table></figure><h2 id="df">7.9 df</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šæ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿçš„ç£ç›˜ä½¿ç”¨æƒ…å†µ<br>df -h            <span class="hljs-regexp">//</span>ä¸€ç§æ˜“çœ‹çš„æ˜¾ç¤º<br></code></pre></td></tr></table></figure><h2 id="mount">7.10 mount</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">mount <span class="hljs-string">/dev/sdb1</span> <span class="hljs-string">/u01</span>              <span class="hljs-string">//</span>æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œç„¶åå°†è¿™ä¸ªæ–‡ä»¶ç³»ç»ŸæŒ‚è½½åˆ°è¿™ä¸ªç›®å½•ä¸Š<br>dev/sdb1 <span class="hljs-string">/u01</span> ext2 defaults 0 2   <span class="hljs-string">//</span>æ·»åŠ åˆ°fstabä¸­è¿›è¡Œè‡ªåŠ¨æŒ‚è½½ï¼Œè¿™æ ·ä»»ä½•æ—¶å€™ç³»ç»Ÿé‡å¯çš„æ—¶å€™ï¼Œæ–‡ä»¶ç³»ç»Ÿéƒ½ä¼šè¢«åŠ è½½ <br></code></pre></td></tr></table></figure><h2 id="uname">7.11 uname</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">è¯´æ˜ï¼š<span class="hljs-built_in">uname</span>å¯ä»¥æ˜¾ç¤ºä¸€äº›é‡è¦çš„ç³»ç»Ÿä¿¡æ¯ï¼Œä¾‹å¦‚å†…æ ¸åç§°ã€ä¸»æœºåã€å†…æ ¸ç‰ˆæœ¬å·ã€å¤„ç†å™¨ç±»å‹ä¹‹ç±»çš„ä¿¡æ¯ <br><span class="hljs-built_in">uname</span> -a<br></code></pre></td></tr></table></figure><h2 id="yum">7.12 yum</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šå®‰è£…æ’ä»¶å‘½ä»¤<br>yum install httpd      <span class="hljs-regexp">//</span>ä½¿ç”¨yumå®‰è£…apache <br>yum update httpd       <span class="hljs-regexp">//</span>æ›´æ–°apache <br>yum remove httpd       <span class="hljs-regexp">//</span>å¸è½½/åˆ é™¤apache <br></code></pre></td></tr></table></figure><h2 id="rpm">7.13 rpm</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">è¯´æ˜ï¼šæ’ä»¶å®‰è£…å‘½ä»¤<br>rpm -ivh httpd-<span class="hljs-number">2.2</span>.<span class="hljs-number">3</span>-<span class="hljs-number">22.0</span>.<span class="hljs-number">1</span><span class="hljs-selector-class">.el5</span><span class="hljs-selector-class">.i386</span><span class="hljs-selector-class">.rpm</span>      <span class="hljs-comment">//ä½¿ç”¨rpmæ–‡ä»¶å®‰è£…apache </span><br>rpm -uvh httpd-<span class="hljs-number">2.2</span>.<span class="hljs-number">3</span>-<span class="hljs-number">22.0</span>.<span class="hljs-number">1</span><span class="hljs-selector-class">.el5</span><span class="hljs-selector-class">.i386</span><span class="hljs-selector-class">.rpm</span>      <span class="hljs-comment">//ä½¿ç”¨rpmæ›´æ–°apache </span><br>rpm -ev httpd                                 <span class="hljs-comment">//å¸è½½/åˆ é™¤apache </span><br></code></pre></td></tr></table></figure><h2 id="date">7.14 date</h2><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade"><span class="hljs-built_in">date</span> -s <span class="hljs-string">&quot;01/31/2010 23:59:53&quot;</span>   <span class="hljs-comment">///è®¾ç½®ç³»ç»Ÿæ—¶é—´</span><br></code></pre></td></tr></table></figure><h2 id="wget">7.15 wget</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">è¯´æ˜ï¼šä½¿ç”¨wgetä»ç½‘ä¸Šä¸‹è½½è½¯ä»¶ã€éŸ³ä¹ã€è§†é¢‘ <br>ç¤ºä¾‹ï¼šwget http:<span class="hljs-regexp">//</span>prdownloads.sourceforge.net<span class="hljs-regexp">/sourceforge/</span>nagios/nagios-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>.tar.gz<br><span class="hljs-regexp">//</span>ä¸‹è½½æ–‡ä»¶å¹¶ä»¥æŒ‡å®šçš„æ–‡ä»¶åä¿å­˜æ–‡ä»¶<br>wget -O nagios.tar.gz http:<span class="hljs-regexp">//</span>prdownloads.sourceforge.net<span class="hljs-regexp">/sourceforge/</span>nagios/nagios-<span class="hljs-number">3.2</span>.<span class="hljs-number">1</span>.tar.gz<br></code></pre></td></tr></table></figure><h2 id="ftp">7.16 ftp</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">ftp</span> <span class="hljs-built_in">IP</span>/hostname    <span class="hljs-comment">//è®¿é—®ftpæœåŠ¡å™¨</span><br><span class="hljs-keyword">mls</span> *.html -       <span class="hljs-comment">//æ˜¾ç¤ºè¿œç¨‹ä¸»æœºä¸Šæ–‡ä»¶åˆ—è¡¨</span><br></code></pre></td></tr></table></figure><h2 id="scp">7.17 scp</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">scp <span class="hljs-regexp">/opt/</span>data.txt  <span class="hljs-number">192.168</span>.<span class="hljs-number">1.101</span>:<span class="hljs-regexp">/opt/</span>    <span class="hljs-regexp">//</span>å°†æœ¬åœ°optç›®å½•ä¸‹çš„dataæ–‡ä»¶å‘é€åˆ°<span class="hljs-number">192.168</span>.<span class="hljs-number">1.101</span>æœåŠ¡å™¨çš„optç›®å½•ä¸‹<br></code></pre></td></tr></table></figure><h1 id="å…«ç³»ç»Ÿç®¡ç†">å…«ã€ç³»ç»Ÿç®¡ç†</h1><h2 id="é˜²ç«å¢™æ“ä½œ">8.1 é˜²ç«å¢™æ“ä½œ</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">service iptables status      <span class="hljs-regexp">//</span>æŸ¥çœ‹iptablesæœåŠ¡çš„çŠ¶æ€<br>service iptables start       <span class="hljs-regexp">//</span>å¼€å¯iptablesæœåŠ¡<br>service iptables stop        <span class="hljs-regexp">//</span>åœæ­¢iptablesæœåŠ¡<br>service iptables restart     <span class="hljs-regexp">//</span>é‡å¯iptablesæœåŠ¡<br>chkconfig iptables off       <span class="hljs-regexp">//</span>å…³é—­iptablesæœåŠ¡çš„å¼€æœºè‡ªå¯åŠ¨<br>chkconfig iptables on        <span class="hljs-regexp">//</span>å¼€å¯iptablesæœåŠ¡çš„å¼€æœºè‡ªå¯åŠ¨<br><span class="hljs-comment">##centos7 é˜²ç«å¢™æ“ä½œ</span><br>systemctl status firewalld.service     <span class="hljs-regexp">//</span>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€<br>systemctl stop firewalld.service       <span class="hljs-regexp">//</span>å…³é—­è¿è¡Œçš„é˜²ç«å¢™<br>systemctl disable firewalld.service    <span class="hljs-regexp">//</span>æ°¸ä¹…ç¦æ­¢é˜²ç«å¢™æœåŠ¡<br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹ä¸»æœºåcentos-7">8.2 ä¿®æ”¹ä¸»æœºåï¼ˆCentOS 7ï¼‰</h2><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">hostnamectl</span> <span class="hljs-built_in">set-hostname</span> ä¸»æœºå<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹ç½‘ç»œ">8.3 æŸ¥çœ‹ç½‘ç»œ</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">ifconfig</span><br></code></pre></td></tr></table></figure><h2 id="ä¿®æ”¹ip">8.4 ä¿®æ”¹IP</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs awk">ä¿®æ”¹ç½‘ç»œé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶åœ°å€ï¼š<span class="hljs-regexp">/etc/</span>sysconfig<span class="hljs-regexp">/network-scripts/i</span>fcfg-eth0<br>------------------------------------------------<br>ä¸»è¦ä¿®æ”¹ä»¥ä¸‹é…ç½®ï¼š  <br>TYPE=Ethernet               <span class="hljs-regexp">//</span>ç½‘ç»œç±»å‹<br>BOOTPROTO=static            <span class="hljs-regexp">//</span>é™æ€IP<br>DEVICE=ens00                <span class="hljs-regexp">//</span>ç½‘å¡å<br>IPADDR=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.100</span>        <span class="hljs-regexp">//</span>è®¾ç½®çš„IP<br>NETMASK=<span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span>       <span class="hljs-regexp">//</span>å­ç½‘æ©ç <br>GATEWAY=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>         <span class="hljs-regexp">//</span>ç½‘å…³<br>DNS1=<span class="hljs-number">192.168</span>.<span class="hljs-number">1.1</span>            <span class="hljs-regexp">//</span>DNS<br>DNS2=<span class="hljs-number">8.8</span>.<span class="hljs-number">8.8</span>                <span class="hljs-regexp">//</span>å¤‡ç”¨DNS<br>ONBOOT=yes                  <span class="hljs-regexp">//</span>ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨æ­¤è®¾ç½®<br>-------------------------------------------------<br>ä¿®æ”¹ä¿å­˜ä»¥åä½¿ç”¨å‘½ä»¤é‡å¯ç½‘å¡ï¼šservice network restart<br></code></pre></td></tr></table></figure><h2 id="é…ç½®æ˜ å°„">8.5 é…ç½®æ˜ å°„</h2><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dns">ä¿®æ”¹æ–‡ä»¶ï¼š vi /etc/hosts<br>åœ¨æ–‡ä»¶æœ€åæ·»åŠ æ˜ å°„åœ°å€ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š<br> <span class="hljs-number">192.168.1.101</span>  node1<br> <span class="hljs-number">192.168.1.102</span>  node2<br> <span class="hljs-number">192.168.1.103</span>  node3<br>é…ç½®å¥½ä»¥åä¿å­˜é€€å‡ºï¼Œè¾“å…¥å‘½ä»¤ï¼šping node1 ï¼Œå¯è§å®é™… ping çš„æ˜¯ <span class="hljs-number">192.168.1.101</span>ã€‚<br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹è¿›ç¨‹">8.6 æŸ¥çœ‹è¿›ç¨‹</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ps -ef         <span class="hljs-regexp">//</span>æŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹<br></code></pre></td></tr></table></figure><h2 id="ç»“æŸè¿›ç¨‹">8.7 ç»“æŸè¿›ç¨‹</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">kill pid       <span class="hljs-regexp">//</span>æ€æ­»è¯¥pidçš„è¿›ç¨‹<br>kill -<span class="hljs-number">9</span> pid    <span class="hljs-regexp">//</span>å¼ºåˆ¶æ€æ­»è¯¥è¿›ç¨‹   <br></code></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹é“¾æ¥">8.8 æŸ¥çœ‹é“¾æ¥</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">ping IP        <span class="hljs-regexp">//</span>æŸ¥çœ‹ä¸æ­¤IPåœ°å€çš„è¿æ¥æƒ…å†µ<br>netstat -an    <span class="hljs-regexp">//</span>æŸ¥çœ‹å½“å‰ç³»ç»Ÿç«¯å£<br>netstat -an | grep <span class="hljs-number">8080</span>     <span class="hljs-regexp">//</span>æŸ¥çœ‹æŒ‡å®šç«¯å£<br></code></pre></td></tr></table></figure><h2 id="å¿«é€Ÿæ¸…å±">8.9 å¿«é€Ÿæ¸…å±</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ctrl+l        <span class="hljs-regexp">//</span>æ¸…å±ï¼Œå¾€ä¸Šç¿»å¯ä»¥æŸ¥çœ‹å†å²æ“ä½œ<br></code></pre></td></tr></table></figure><h2 id="è¿œç¨‹ä¸»æœº">8.10 è¿œç¨‹ä¸»æœº</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">ssh</span> <span class="hljs-built_in">IP</span>       <span class="hljs-comment">//è¿œç¨‹ä¸»æœºï¼Œéœ€è¦è¾“å…¥ç”¨æˆ·åå’Œå¯†ç </span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å¤‡å¿˜å¤§å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Linux</tag>
      
      <tag>å‘½ä»¤</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®­ç»ƒå¥–åŠ±æ¨¡å‹</title>
    <link href="/%E8%AE%AD%E7%BB%83%E5%A5%96%E5%8A%B1%E6%A8%A1%E5%9E%8B.html"/>
    <url>/%E8%AE%AD%E7%BB%83%E5%A5%96%E5%8A%B1%E6%A8%A1%E5%9E%8B.html</url>
    
    <content type="html"><![CDATA[<h1 id="è®­ç»ƒå¥–åŠ±æ¨¡å‹">è®­ç»ƒå¥–åŠ±æ¨¡å‹</h1><p>å› ä¸ºä¹‹å‰æ‰¾çš„è®­ç»ƒå¥½çš„å¥–åŠ±æ¨¡å‹ä¸èƒ½åœ¨<ahref="https://github.com/hpcaitech/ColossalAI">ColossalAI</a>ä¸­çš„å¼ºåŒ–å­¦ä¹ é˜¶æ®µä½¿ç”¨ï¼Œå¹¶ä¸”æ˜¯ç”¨çº¯è‹±æ–‡æ•°æ®é›†è®­ç»ƒçš„ï¼Œå› æ­¤æˆ‘ä»¬ç”¨<ahref="https://github.com/hpcaitech/ColossalAI">ColossalAI</a>çš„ä»£ç å’Œä¸­æ–‡æ•°æ®é›†è®­ç»ƒäº†å¥–åŠ±æ¨¡å‹ã€‚</p><h2 id="æ•°æ®é›†">æ•°æ®é›†</h2><p>åŸºäºanthropicçš„Training a Helpful and Harmless Assistant withReinforcement Learning from Human Feedbackè®ºæ–‡å¼€æºçš„å…³äºæœ‰åŠ©å’Œæ— å®³çš„äººç±»åå¥½æ•°æ®hh-rlhfçš„ç¿»è¯‘æˆä¸­æ–‡çš„<ahref="https://huggingface.co/datasets/dikw/hh_rlhf_cn">hh_rlhf_cn</a>ã€‚</p><p>ä¸­æ–‡+è‹±æ–‡æ•°æ®é›†ï¼Œä½¿å¾—åŒæ—¶èƒ½å¤Ÿè¯†åˆ«ä¸­è‹±æ–‡åå¥½ã€‚</p><figure><img src="https://image.yinan.fun/202309140020191.png"alt="hh_rlhf_cnæ•°æ®é›†" /><figcaption aria-hidden="true">hh_rlhf_cnæ•°æ®é›†</figcaption></figure><p>å°†æ•°æ®é›†çš„contextä¸chosenã€regectedåˆå¹¶ï¼Œä½œä¸ºå¥–åŠ±æ¨¡å‹çš„è¾“å…¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset, load_from_disk<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">merge_prefix</span>(<span class="hljs-params">example</span>):<br>    context_all = <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> context <span class="hljs-keyword">in</span> example[<span class="hljs-string">&quot;context&quot;</span>]:<br>        context_all += <span class="hljs-string">&quot;\n\n&quot;</span> + context[<span class="hljs-string">&quot;role&quot;</span>] + <span class="hljs-string">&quot;: &quot;</span> + context[<span class="hljs-string">&quot;text&quot;</span>];<br>    example[<span class="hljs-string">&quot;chosen&quot;</span>] = context_all + <span class="hljs-string">&quot;\n\n&quot;</span> + example[<span class="hljs-string">&quot;chosen&quot;</span>][<span class="hljs-string">&quot;role&quot;</span>] + <span class="hljs-string">&quot;: &quot;</span> + example[<span class="hljs-string">&quot;chosen&quot;</span>][<span class="hljs-string">&quot;text&quot;</span>];<br>    example[<span class="hljs-string">&quot;rejected&quot;</span>] = context_all + <span class="hljs-string">&quot;\n\n&quot;</span> + example[<span class="hljs-string">&quot;rejected&quot;</span>][<span class="hljs-string">&quot;role&quot;</span>] + <span class="hljs-string">&quot;: &quot;</span> + example[<span class="hljs-string">&quot;rejected&quot;</span>][<span class="hljs-string">&quot;text&quot;</span>];<br>    <span class="hljs-keyword">return</span> example<br><br>data = load_dataset(<span class="hljs-string">&quot;/Volumes/T7/æ•°æ®é›†/hh_rlhf_cn&quot;</span>)<br>new_data = data.<span class="hljs-built_in">map</span>(merge_prefix, remove_columns=[<span class="hljs-string">&quot;context&quot;</span>])<br>new_data.save_to_disk(<span class="hljs-string">&quot;/Volumes/T7/æ•°æ®é›†/hh_rlhf_cn_processed&quot;</span>)<br><br><span class="hljs-comment"># data = load_from_disk(&quot;/Volumes/T7/æ•°æ®é›†/hh_rlhf_cn_processed&quot;)</span><br></code></pre></td></tr></table></figure><h2 id="ä»£ç ">ä»£ç </h2><p>ä½¿ç”¨<ahref="https://github.com/hpcaitech/ColossalAI">ColossalAI</a>ä¸­çš„ä»£ç </p><h3 id="å¥–åŠ±æ¨¡å‹ä»£ç ">å¥–åŠ±æ¨¡å‹ä»£ç </h3><p><ahref="https://huggingface.co/bigscience/bloom-560m">bloom-560m</a>è¯­è¨€æ¨¡å‹+è¾“å‡ºå¤§å°ä¸º1çš„çº¿æ€§å±‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BLOOMRM</span>(<span class="hljs-title class_ inherited__">RewardModel</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    BLOOM Reward model.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        pretrained (str): Pretrained model name or path.</span><br><span class="hljs-string">        config (BloomConfig): Model config.</span><br><span class="hljs-string">        lora_rank (int): LoRA rank.</span><br><span class="hljs-string">        lora_train_bias (str): LoRA bias training mode.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,</span><br><span class="hljs-params">                 pretrained: <span class="hljs-built_in">str</span> = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">                 config: <span class="hljs-type">Optional</span>[BloomConfig] = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">                 lora_rank: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>,</span><br><span class="hljs-params">                 lora_train_bias: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;none&#x27;</span></span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">if</span> pretrained <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            model = BloomModel.from_pretrained(pretrained)<br>        <span class="hljs-keyword">elif</span> config <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            model = BloomModel(config)<br>        <span class="hljs-keyword">else</span>:<br>            model = BloomModel(BloomConfig())<br><br>        value_head = nn.Linear(model.config.hidden_size, <span class="hljs-number">1</span>)<br>        value_head.weight.data.normal_(mean=<span class="hljs-number">0.0</span>, std=<span class="hljs-number">1</span> / (model.config.hidden_size + <span class="hljs-number">1</span>))<br>        <span class="hljs-built_in">super</span>().__init__(model, value_head, lora_rank, lora_train_bias)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">RewardModel</span>(<span class="hljs-title class_ inherited__">LoRAModule</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Reward model base class.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        model (nn.Module): Reward model.</span><br><span class="hljs-string">        value_head (nn.Module): Value head to get reward score.</span><br><span class="hljs-string">        lora_rank (int): LoRA rank.</span><br><span class="hljs-string">        lora_train_bias (str): LoRA bias training mode.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,</span><br><span class="hljs-params">                 model: nn.Module,</span><br><span class="hljs-params">                 value_head: <span class="hljs-type">Optional</span>[nn.Module] = <span class="hljs-literal">None</span>,</span><br><span class="hljs-params">                 lora_rank: <span class="hljs-built_in">int</span> = <span class="hljs-number">0</span>,</span><br><span class="hljs-params">                 lora_train_bias: <span class="hljs-built_in">str</span> = <span class="hljs-string">&#x27;none&#x27;</span></span>) -&gt; <span class="hljs-literal">None</span>:<br>        <span class="hljs-built_in">super</span>().__init__(lora_rank=lora_rank, lora_train_bias=lora_train_bias)<br>        self.model = model<br>        self.convert_to_lora()<br><br>        <span class="hljs-keyword">if</span> value_head <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">if</span> value_head.out_features != <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">raise</span> ValueError(<span class="hljs-string">&quot;The value head of reward model&#x27;s output dim should be 1!&quot;</span>)<br>            self.value_head = value_head<br>        <span class="hljs-keyword">else</span>:<br>            self.value_head = nn.Linear(model.config.n_embd, <span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, sequences: torch.LongTensor, attention_mask: <span class="hljs-type">Optional</span>[torch.Tensor] = <span class="hljs-literal">None</span></span>) -&gt; torch.Tensor:<br>        outputs = self.model(sequences, attention_mask=attention_mask)<br>        last_hidden_states = outputs[<span class="hljs-string">&#x27;last_hidden_state&#x27;</span>]<br>        values = self.value_head(last_hidden_states)[:, :-<span class="hljs-number">1</span>]<br>        value = values.mean(dim=<span class="hljs-number">1</span>).squeeze(<span class="hljs-number">1</span>)    <span class="hljs-comment"># ensure shape is (B)</span><br>        <span class="hljs-keyword">return</span> value<br></code></pre></td></tr></table></figure><h3 id="æŸå¤±å‡½æ•°ä»£ç ">æŸå¤±å‡½æ•°ä»£ç </h3><p><span class="math display">\[loss(\theta)=-\frac{1}{K \choose 2}E_{(x,y_w,y_l)\simD}[log(\sigma(r_\theta(x,y_w)-r_\theta(x,y_l)))]\]</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LogSigLoss</span>(nn.Module):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Pairwise Loss for Reward Model</span><br><span class="hljs-string">    Details: https://arxiv.org/abs/2203.02155</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, chosen_reward: torch.Tensor, reject_reward: torch.Tensor</span>) -&gt; torch.Tensor:<br>        probs = torch.sigmoid(chosen_reward - reject_reward)<br>        log_probs = torch.log(probs)<br>        loss = -log_probs.mean()<br>        <span class="hljs-keyword">return</span> loss<br></code></pre></td></tr></table></figure><h3 id="ä»£ç è¿è¡Œå‚æ•°">ä»£ç è¿è¡Œå‚æ•°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">torchrun --standalone --nproc_per_node=1 train_reward_model.py \<br>    --model &#x27;bloom&#x27; \<br>    --strategy colossalai_zero2 \<br>    --loss_fn &#x27;log_sig&#x27; \<br>    --dataset &#x27;Anthropic/hh-rlhf&#x27; \<br>    --pretrain ~/model/bloom-560m \<br>    --tokenizer ~/model/bloom-560m<br></code></pre></td></tr></table></figure><h3 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœ</h3><table><thead><tr class="header"><th>Step</th><th>Loss</th><th>Dist</th><th>Acc</th></tr></thead><tbody><tr class="odd"><td>344317</td><td>0.09899902</td><td>0.38238678</td><td>0.61886833</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Proximal Policy Optimization (PPO)</title>
    <link href="/ppo.html"/>
    <url>/ppo.html</url>
    
    <content type="html"><![CDATA[<h1 id="proximal-policy-optimization-ppo">Proximal Policy Optimization(PPO)</h1><h2 id="policy-gradient">Policy Gradient</h2><p><span class="math display">\[\tau=\left\{s_1, a_1, s_2, a_2, \cdots, s_T, a_T\right\}\]</span></p><p>å½“å‚æ•°æ˜¯<span class="math inline">\(\theta\)</span>çš„æ—¶å€™æŸä¸€ä¸ªtrajectory å›åˆé‡Œé¢å‘ç”Ÿ<spanclass="math inline">\(\tau\)</span>çš„å‡ ç‡ï¼š</p><p><span class="math display">\[\begin{aligned}p_\theta(\tau)&amp; =p\left(s_1\right) p_\theta\left(a_1 \mid s_1\right)p\left(s_2 \mid s_1, a_1\right) p_\theta\left(a_2 \mid s_2\right)p\left(s_3 \mid s_2, a_2\right) \cdots \\&amp; =p\left(s_1\right) \prod_{t=1}^T p_\theta\left(a_t \mid s_t\right)p\left(s_{t+1} \mid s_t, a_t\right) \\&amp;\end{aligned}\]</span> ExpectRewardï¼Œç©·ä¸¾æ‰€æœ‰çš„Trajectoryä¸åŒå›åˆçš„Rewardä¹˜ä»¥ä¸åŒå›åˆçš„å‡ ç‡å†æ±‚å’Œå°±æ˜¯æœŸæœ›Reward</p><p><span class="math display">\[\bar{R}_\theta=\sum_\tau R(\tau) p_\theta(\tau)=E_{\tau \simp_\theta(\tau)}[R(\tau)]\]</span> è¦æ±‚æœŸæœ›Rewardæœ€å¤§å€¼é‡‡ç”¨æ¢¯åº¦ä¸Šå‡ <span class="math display">\[\begin{aligned}\nabla \bar{R}_\theta&amp;=\sum_\tau R(\tau) \nablap_\theta(\tau)=\sum_\tau R(\tau) p_\theta(\tau) \frac{\nablap_\theta(\tau)}{p_\theta(\tau)}\\&amp;=\sum_\tau R(\tau) p_\theta(\tau) \nabla \log p_\theta(\tau)\\&amp;=E_{\tau \sim p_\theta(\tau)}\left[R(\tau) \nabla \logp_\theta(\tau)\right]\approx \frac{1}{N} \sum_{n=1}^N R\left(\tau_n\right) \nabla \logp_\theta\left(\tau_n\right)\end{aligned}\]</span> ç”±äºenvçš„é‚£éƒ¨åˆ†<span class="math inline">\(p\left(s_{t+1} \mids_t, a_t\right)\)</span>å’Œæ— å…³<spanclass="math inline">\(\theta\)</span>ï¼Œæ‰€ä»¥æ— éœ€å¯¹å…¶åšgradientï¼Œåªéœ€è¦å¯¹actorçš„é‚£éƒ¨åˆ†<spanclass="math inline">\(p_\theta\left(a_t \mids_t\right)\)</span>åšgradientï¼Œæ‰€ä»¥ï¼š</p><p><span class="math display">\[\nabla \bar{R}_\theta=\frac{1}{N} \sum_{n=1}^{N} \sum_{t=1}^{T_n}R\left(\tau_n\right) \nabla \log p_\theta\left(a_t^n \mid s_t^n\right)\]</span>è¿™é‡Œä¸ºä»€ä¹ˆè¦ç”¨ä¸€ä¸ªlogå‘¢ï¼Ÿï¼ˆä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¦å¤šä¸€ä¸ªå†é™¤ä»¥pçš„æ“ä½œï¼‰ç›´æ¥å¯¹på–æ¢¯åº¦ä¸å¥½å—ï¼Ÿå› ä¸ºå¦‚æœåŠ¨ä½œaå¾ˆå¥½ä½†æ˜¯å¾ˆç½•è§ï¼Œè€ŒåŠ¨ä½œbå¾ˆå¤šä½†æ˜¯ä¸å¤ªå¥½ï¼Œä½†æ˜¯åœ¨æ±‚å’Œæ“ä½œçš„æ—¶å€™ï¼Œå°±ä¼šæŠŠbçš„Rewardæ±‚å’Œå˜å¾—å¾ˆå¤§ï¼Œä¸ºäº†ä½¿å¾—ç›®æ ‡å‡½æ•°æœ€å¤§ï¼Œæ¨¡å‹å°±ä¼šåå¥½å‡ºç°å‡ ç‡è¾ƒé«˜actionbï¼Œè€Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚é™¤ä»¥pçš„æ“ä½œå°±æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–çš„æ“ä½œï¼Œå‡ºç°æ¬¡æ•°è¶Šå¤šä¹Ÿå°±æ˜¯æ¦‚ç‡è¶Šå¤§ï¼Œé™¤ä»¥è‡ªå·±å°±æ ‡å‡†åŒ–äº†</p><figure><img src="https://image.yinan.fun/202309072110938" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="on-policy---off-policy">On-policy -&gt; Off-policy</h2><ul><li><p>On-policy: The agent learned and the agent interacting with theenvironment is the same.</p></li><li><p>Off-policy: The agent learned and the agent interacting with theenvironment is different.</p></li></ul><p>å‰é¢çš„policygradientçš„åšæ³•å°±æ˜¯on-policyï¼Œå³è¦learnçš„policyå’Œä¸ç¯å¢ƒäº’åŠ¨çš„policyæ˜¯åŒä¸€ä¸ªã€‚å½“updateå‚æ•°ä»¥å,ä»<spanclass="math inline">\(\theta\)</span>å˜æˆ<spanclass="math inline">\(\theta&#39;\)</span>,é‚£ä¹ˆä¹‹å‰sampleå‡ºæ¥çš„dataå°±ä¸èƒ½ç”¨äº†ã€‚Updateä¸€æ¬¡å‚æ•°ï¼Œåªèƒ½åšä¸€æ¬¡gradientacentï¼Œè€Œåå†å» collect dataï¼Œéå¸¸è€—æ—¶ï¼Œæ‰€ä»¥éœ€è¦ offpolicyã€‚off-policyå¯ä»¥æ‹¿ä¸€æ‰¹dataç”¨å¥½å‡ æ¬¡ã€‚</p><h3 id="importance-sampling">Importance Sampling</h3><p>ä»åˆ†å¸ƒpä¸­é‡‡æ ·xï¼Œå½“pæ— æ³•ç§¯åˆ†ï¼Œé‚£å°±çº¦ç­‰äºå³è¾¹çš„å‡å€¼</p><p><span class="math display">\[E_{x \sim p}[f(x)] \approx N \sum_{i=1}^N f\left(x^i\right)\]</span>å‡è®¾ï¼šæ— æ³•ä»pä¸­é‡‡æ ·dataï¼Œåªèƒ½ä»qä¸­é‡‡æ ·dataï¼Œé‚£ä¹ˆè¿™ä¸ªç­‰å¼æ— æ³•è¿‘ä¼¼ <spanclass="math display">\[E_{x \sim p}[f(x)]=\int f(x) p(x) d x=\int f(x) \frac{p(x)}{q(x)} q(x) dx=E_{x \sim q}\left[f(x)\left[\frac{p(x)}{q(x)}\right]\right.\]</span> å˜æˆä»q åˆ†å¸ƒä¸­é‡‡æ ·dataï¼Œ<spanclass="math inline">\(\displaystyle{\frac{p(x)}{q(x)}}\)</span>ç›¸å½“äºä¿®æ­£æƒé‡</p><h3 id="issue-of-importance-sampling">Issue of Importance Sampling</h3><p>æœŸæœ›ç›¸åŒï¼Œä½†æ˜¯æ–¹å·®ä¸åŒ</p><p><span class="math display">\[V A R[X] { =E[X^{2}]-(E[X])^{2}}\]</span> <span class="math inline">\(f(x)\)</span>çš„æ–¹å·® <spanclass="math display">\[\operatorname{Var}_{x\sim p}[f(x)]=E_{x\sim p}[f(x)^{2}]-\left(E_{x\simp}[f(x)]\right)^{2}\]</span> <spanclass="math inline">\(f(x)\displaystyle{\frac{p(x)}{q(x)}}\)</span>çš„æ–¹å·®<span class="math display">\[\begin{aligned}Var_{x\sim q}[f(x)\displaystyle{\frac{p(x)}{q(x)}}]&amp;=E_{x\simq}\left[\left(f(x)\displaystyle{\frac{p(x)}{q(x)}}\right)^{2}\right]-\left(E_{x\simq}\left[f(x)\displaystyle{\frac{p(x)}{q(x)}}\right]\right)^{2}\\&amp;={E_{x\simp}\left[f(x)^{2}\displaystyle{\left[\displaystyle{\frac{p(x)}{q(x)}}\right]}-(E_{x\sim p}[f(x)]\right)^{2}}\end{aligned}\]</span> æ–¹å·®ä¸»è¦å·®åˆ«åœ¨ç¬¬ä¸€é¡¹ï¼Œä¹Ÿå°±æ˜¯<spanclass="math inline">\(\displaystyle{\frac{p(x)}{q(x)}}\)</span>çš„å€¼ã€‚æ‰€ä»¥å¦‚æœpå’Œqå·®å¾ˆå¤šï¼Œè€Œä¸”é‡‡æ ·ä¸å¤Ÿå¤šï¼ŒåŒºåˆ«å°±å·®å¾ˆå¤§ã€‚å½“ç„¶ï¼Œå¦‚æœsampleæ¬¡æ•°è¶³å¤Ÿå¤šï¼Œé‚£ä¹ˆæœŸæœ›ç›¸åŒï¼Œä¹Ÿæ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚</p><h3 id="off-policy">Off-policy</h3><p><span class="math display">\[\nabla \bar{R}_\theta=E_{\tau \simp_{\theta^{\prime}}(\tau)}\left[\frac{p_\theta(\tau)}{p_{\theta^{\prime}}(\tau)}R(\tau) \nabla \log p_\theta(\tau)\right]\]</span></p><p><span class="math inline">\(\theta&#39;\)</span>sampleä¸€æ¬¡data,å¯ä»¥ç»™ <span class="math inline">\(\theta\)</span>uptakeå¾ˆå¤šæ¬¡,å®Œäº†ä»¥åå†å» Sample data</p><h2 id="add-constraint">Add Constraint</h2><h2 id="actor-critic">Actor-Critic</h2><h3id="å‡å°actorçš„æ–¹å·®causalityæ–¹æ³•">å‡å°Actorçš„æ–¹å·®ï¼šCausalityæ–¹æ³•</h3><p>ç­–ç•¥æ¢¯åº¦çš„å…¬å¼å˜ä¸º <span class="math display">\[\nabla J(\theta)=\frac{1}{N}\sum_{i=1}^{N}\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})(\sum_{t&#39;=t}^{T}r(s_{i,t&#39;},a_{i,t&#39;}))\]</span> å³åä¸€é¡¹å…³äºçš„å¥–åŠ±çš„ç´¯åŠ åªç´¯åŠ å½“å‰æ—¶é—´æ­¥<spanclass="math inline">\(t\)</span>ä¹‹åçš„å¥–åŠ±ï¼Œç›´è§‚çš„ç†è§£æ˜¯<spanclass="math inline">\(t&#39;\)</span>æ—¶åˆ»ç­–ç•¥çš„æ”¹å˜ä¸ä¼šå½±å“åˆ°<spanclass="math inline">\(t&#39;\)</span>ä¹‹å‰æ—¶é—´æ­¥çš„å¥–åŠ±</p><p>åœ¨ä¸Šå¼ä¸­ï¼Œå¯¹<span class="math inline">\(\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})\)</span>ä½¿ç”¨çš„æ˜¯MonteCarloä¼°è®¡æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•æ–¹å·®å¤§ã€‚å°†è¯¥é¡¹å¯ä»¥å†™æˆ<spanclass="math inline">\(\hat{Q}_{i}(s_t,a_t)\)</span>ï¼ŒQå€¼ä»£è¡¨æœªæ¥çš„ç´¯è®¡å¥–åŠ±çš„æœŸæœ›ï¼Œå¯ä»¥ä½¿ç”¨å€¼å‡½æ•°è¿‘ä¼¼çš„æ–¹æ³•æ¥ä¼°è®¡<spanclass="math inline">\(\hat{Q}_{i}(s_t,a_t)\)</span>ï¼Œä»è€Œè¿›ä¸€æ­¥å‡å°‘æ–¹å·®ã€‚ <span class="math display">\[\nabla J(\theta)=\frac{1}{N}\sum_{i=1}^{N}\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})\hat{Q}_{i}(s_t,a_t)\]</span></p><h3 id="baselineæ–¹æ³•">Baselineæ–¹æ³•</h3><p>å¦‚æœå¸Œæœ›åœ¨ä¸Šå¼çš„åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥å‡å°‘æ–¹å·®ï¼Œé‚£ä¹ˆå¯ä»¥ä¸º<spanclass="math inline">\(\hat{Q}_{i}(s_t,a_t)\)</span> æ·»åŠ baselineï¼Œå°†baselineè®°ä¸º<spanclass="math inline">\(b\)</span>ï¼Œåˆ™ç­–ç•¥æ¢¯åº¦çš„å…¬å¼ä¸º <spanclass="math display">\[\nabla J(\theta)=\frac{1}{N}\sum_{i=1}^{N}\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})(\hat{Q}(s_t,a_t)-b)\]</span> å¯ä»¥è¯æ˜ï¼Œåªæœ‰åœ¨<spanclass="math inline">\(b\)</span>ä¸åŠ¨ä½œ<spanclass="math inline">\(a_t\)</span>æ— å…³çš„æƒ…å†µä¸‹ï¼Œä¸Šè¿°æ”¹è¿›æ‰ä¸ä¹‹å‰çš„ç­–ç•¥æ¢¯åº¦å…¬å¼ç­‰ä»·ã€‚<spanclass="math inline">\(b\)</span>ä¸€èˆ¬é€‰æ‹©ä¸ºçŠ¶æ€<spanclass="math inline">\(s_t\)</span>çš„å€¼å‡½æ•°ï¼ˆè¿˜ä¸<spanclass="math inline">\(\theta\)</span>æœ‰å…³ï¼Ÿï¼‰ï¼Œå³<spanclass="math inline">\(b=\hat{v}_i(s)\)</span> ã€‚</p><p>å½“baselineæ˜¯çŠ¶æ€å€¼å‡½æ•°æ—¶ï¼Œç­–ç•¥æ¢¯åº¦å¯ä»¥å†™æˆ <spanclass="math display">\[\nabla J(\theta)=\frac{1}{N}\sum_{i=1}^{N}\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})(\hat{Q}(s_t,a_t)-\hat{V}(s_t))\]</span> å…¶ä¸­ï¼Œ <spanclass="math inline">\(\hat{Q}(s_t,a_t)-\hat{V}(s_t)=\hat{A}(s_t,a_t)\)</span>ç§°ä¸ºAdvantageFunctionï¼Œå…¶ä¸­ <span class="math display">\[Q(s_t,a_t)=r(s_t,a_t)+\sum_{s_{t+1}}P(s_{t+1}|s_t,a_t)[V(s_{t+1})]\]</span>å¦‚æœä¸è€ƒè™‘çŠ¶æ€è½¬ç§»æ¦‚ç‡ï¼Œç”¨é‡‡æ ·çš„æ–¹å¼æ¥ä¼°è®¡çŠ¶æ€è½¬ç§»ï¼Œåˆ™åœ¨å½“å‰ç­–ç•¥å‚æ•°ä¸‹ï¼Œ<span class="math display">\[Q(s_t,a_t)\approx r(s_t,a_t)+V(s_{t+1})\]</span> å› æ­¤ç­–ç•¥æ¢¯åº¦å…¬å¼å¯ä»¥è¿›ä¸€æ­¥å†™æˆ <span class="math display">\[\nabla J(\theta)=\frac{1}{N}\sum_{i=1}^{N}\sum_{t=1}^{T}\nabla_\thetalog\pi_\theta(a_{i,t}|s_{i,t})(r(s_t,a_t)+\hat{V}(s_{t+1})-\hat{V}(s_t))\]</span> åœ¨ä¸Šå¼ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¼°è®¡çŠ¶æ€å€¼å‡½æ•°<spanclass="math inline">\(\hat{V}(s_t)\)</span>çš„å€¼ã€‚ç”¨äºä¼°è®¡<spanclass="math inline">\(\hat{V}(s_t)\)</span>çš„éƒ¨åˆ†è¢«ç§°ä¸º<strong>Critic</strong>ã€‚</p><p><strong>Actor-Criticçš„åŸºæœ¬æµç¨‹ä¸ºï¼š</strong> <spanclass="math display">\[é‡‡æ ·\rightarrow æ›´æ–°Criticå‚æ•°\rightarrow æ ¹æ®Criticè®¡ç®—AdvantageFunction \rightarrow æ›´æ–°Actorå‚æ•°\]</span></p><h2 id="å‚è€ƒ">å‚è€ƒ</h2><p><ahref="https://blog.51cto.com/u_15721703/5575736">https://blog.51cto.com/u_15721703/5575736</a></p><p><ahref="https://www.zhihu.com/question/56692640/answer/289913574">https://www.zhihu.com/question/56692640/answer/289913574</a></p><p>[https://danieltakeshi.github.io/2017/03/28/going-deeper-into-reinforcement-learning-fundamentals-of-policy-gradients/](</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fastbootå®‰è£…é©±åŠ¨</title>
    <link href="/fastboot%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8.html"/>
    <url>/fastboot%E5%AE%89%E8%A3%85%E9%A9%B1%E5%8A%A8.html</url>
    
    <content type="html"><![CDATA[<h1id="ä½¿ç”¨fastbootå‘½ä»¤å‡ºç°waiting-for-any-device">ä½¿ç”¨Fastbootå‘½ä»¤å‡ºç°&lt;waitingfor any device&gt;</h1><h2 id="å¯èƒ½æ˜¯fastbooté©±åŠ¨æœªå®‰è£…">å¯èƒ½æ˜¯fastbooté©±åŠ¨æœªå®‰è£…</h2><ol type="1"><li>æ‰“å¼€è®¾å¤‡ç®¡ç†å™¨</li><li>æ‰¾åˆ°<code>Android</code>ï¼ˆå¸¦é»„è‰²æ„Ÿå¹å·ï¼‰</li><li>å³é”®--&gt;<code>æ›´æ–°é©±åŠ¨ç¨‹åº</code></li><li>é€‰æ‹©<code>æµè§ˆæˆ‘çš„ç”µè„‘ä»¥æŸ¥æ‰¾é©±åŠ¨ç¨‹åº</code></li><li>é€‰æ‹©<code>è®©æˆ‘ä»ç”µè„‘ä¸Šçš„å¯ç”¨é©±åŠ¨åˆ—è¡¨ä¸Šé€‰æ‹©</code></li><li>é€‰æ‹©<code>é€šç”¨ä¸²è¡Œæ€»çº¿è®¾å¤‡</code></li><li>é€‰æ‹©<code>WinUSBè®¾å¤‡</code>--&gt;<code>ADBè®¾å¤‡</code>--&gt;<code>ä¸‹ä¸€æ­¥</code>--&gt;<code>æ˜¯</code></li><li>ç‚¹å‡»<code>å…³é—­</code></li></ol><p>è®¾å¤‡ç®¡ç†å™¨ä¸­çš„Androidè®¾å¤‡çš„é»„è‰²æ„Ÿå¹å·æ¶ˆå¤±ï¼Œé©±åŠ¨å®‰è£…æˆåŠŸã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å®‰å“åˆ·æœº</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å®‰è£…åˆ·æœº</tag>
      
      <tag>fastboot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†ç±»é—®é¢˜ä¸­æ¦‚ç‡ä¸åˆ†æ•°</title>
    <link href="/%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E4%B8%AD%E6%A6%82%E7%8E%87%E4%B8%8E%E5%88%86%E6%95%B0.html"/>
    <url>/%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98%E4%B8%AD%E6%A6%82%E7%8E%87%E4%B8%8E%E5%88%86%E6%95%B0.html</url>
    
    <content type="html"><![CDATA[<h1 id="åˆ†ç±»é—®é¢˜ä¸­æ¦‚ç‡ä¸åˆ†æ•°">åˆ†ç±»é—®é¢˜ä¸­æ¦‚ç‡ä¸åˆ†æ•°</h1><h2 id="ä»€ä¹ˆæ˜¯åˆ†æ•°">ä»€ä¹ˆæ˜¯åˆ†æ•°</h2><p>å¯¹äºäºŒåˆ†ç±»å™¨æ¥è¯´ï¼Œå°†å…¶ä¸­ä¸€ä¸ªç±»åˆ«ç§°ä¸ºæ­£ç±»ï¼Œ<strong>æ›´é«˜çš„åˆ†æ•°æ„å‘³ç€æ¨¡å‹æ›´æœ‰ä¿¡å¿ƒè¾“å…¥ï¼ˆobservationï¼‰å±äºæ­£ç±»ã€‚</strong></p><h2 id="ä»€ä¹ˆæ˜¯æ¦‚ç‡">ä»€ä¹ˆæ˜¯æ¦‚ç‡</h2><p>æ¦‚ç‡å¯èƒ½å¾ˆéš¾å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åšä¸€ä¸ªé™é›¨é¢„æµ‹å™¨ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ä»Šå¤©ä¸‹é›¨çš„å‡ ç‡ä¸º20%ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ¤æ–­å®ƒæ˜¯å¦æ­£ç¡®ï¼Ÿåœ¨æ£€æŸ¥é¢„æµ‹æ—¶ï¼Œè¦ä¹ˆä¼šä¸‹é›¨ï¼ˆè¦ä¹ˆä¸ä¼šä¸‹é›¨ï¼‰ã€‚æ ‡å‡†çš„æ–¹æ³•æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬é‡‡å–çœ‹èµ·æ¥ä¸ä»Šå¤©ç›¸ä¼¼çš„æ—¥å­ï¼Œé‚£ä¹ˆå…¶ä¸­20%çš„æ—¥å­åº”è¯¥ä¼šä¸‹é›¨ï¼Œä½†éšåæˆ‘ä»¬å°±ä¼šäº‰è®ºä¸åŒçš„æ—¥å­å¿…é¡»æœ‰å¤šç›¸ä¼¼æ‰èƒ½è¢«ç»„åˆåœ¨ä¸€èµ·ã€‚åœ¨æ›´æç«¯çš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚é¢„æµ‹é€‰ä¸¾ç»“æœï¼Œå¾ˆéš¾çœ‹å‡ºæˆ‘ä»¬å¦‚ä½•â€œé‡å¤â€å®éªŒæ¥èµ‹äºˆç»“æœä»¥æ„ä¹‰ã€‚</p><p>åœ¨ã€Šä¿¡å·ä¸å™ªéŸ³ã€‹ä¸­ï¼Œå†…ç‰¹Â·è¥¿å°”å¼—åœ¨ç¬¬4ç« çš„å¤©æ°”é¢„æŠ¥ä¸­è°ˆåˆ°äº†è¿™ä¸ªé—®é¢˜ã€‚ä¸å…¶æ‹…å¿ƒæ˜¯ä»€ä¹ˆè®©æ—¥å­å½¼æ­¤ç›¸ä¼¼ï¼Œä¸å¦‚é‡‡å–ä¸åŒçš„æ–¹æ³•ã€‚ä»å†å²ä¸Šçœ‹ï¼Œåœ¨é‚£äº›æ¨¡å‹é¢„æµ‹20%çš„æ—¶é—´ä¼šä¸‹é›¨æ—¥å­é‡Œï¼Œå®é™…ä¸‹é›¨çš„æ—¶é—´ç™¾åˆ†æ¯”æ˜¯å¤šå°‘ï¼Ÿå¦‚æœç­”æ¡ˆä¸20%å¤§ç›¸å¾„åº­ï¼Œé‚£ä¹ˆæ¨¡å‹çš„æ¦‚ç‡åœ¨å®é™…ä¼°è®¡æ¦‚ç‡æ–¹é¢åšå¾—ä¸æ˜¯å¾ˆå¥½ã€‚</p><p>åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬å‡è®¾æ¦‚ç‡ï¼Œå› ä¸ºå¯èƒ½åªæœ‰ä¸€å¤©æ­£å¥½æœ‰0.2000çš„é™é›¨æ¦‚ç‡ã€‚å¦‚æœæˆ‘ä»¬æŠŠæ‰€æœ‰é¢„æµ‹åœ¨17.5%åˆ°22.5%ä¹‹é—´ï¼Œå¹¶æŠŠå®ƒä»¬ç»„åˆåœ¨ä¸€ä¸ªæ¡¶é‡Œï¼Œæˆ‘ä»¬é¢„è®¡å®é™…é™é›¨é‡åœ¨17.5%åˆ°22.5%ä¹‹é—´ã€‚</p><p>è¿™ç§å°†é¢„æµ‹æ¦‚ç‡ä¸å®é™…å‘ç”Ÿæ¬¡æ•°è¿›è¡Œæ¯”è¾ƒçš„è¿‡ç¨‹ç§°ä¸ºæ ¡å‡†ï¼ˆcalibrationï¼‰ã€‚æ ¡å‡†æ›²çº¿æ ¹æ®å®é™…å‘ç”Ÿç‡ç»˜åˆ¶é¢„æµ‹æ¦‚ç‡ã€‚</p><h2 id="æ¦‚ç‡æ ¡å‡†æ›²çº¿">æ¦‚ç‡æ ¡å‡†æ›²çº¿</h2><p>ä¸‹é›¨é¢„æµ‹çš„ä¾‹å­ï¼Œä½¿ç”¨<ahref="https://www.kaggle.com/datasets/rtatman/did-it-rain-in-seattle-19482017">Kaggleæ•°æ®é›†</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">rain = pd.read_csv(<span class="hljs-string">&#x27;seattleWeather_1948-2017.csv&#x27;</span>).dropna()<br>rain.head()<br></code></pre></td></tr></table></figure><table><thead><tr class="header"><th style="text-align: left;"></th><th style="text-align: right;">DATE</th><th style="text-align: right;">PRCP</th><th style="text-align: right;">TMAX</th><th style="text-align: right;">TMIN</th><th>RAIN</th></tr></thead><tbody><tr class="odd"><td style="text-align: left;">0</td><td style="text-align: right;">1948-01-01</td><td style="text-align: right;">0.47</td><td style="text-align: right;">51</td><td style="text-align: right;">42</td><td>True</td></tr><tr class="even"><td style="text-align: left;">1</td><td style="text-align: right;">1948-01-02</td><td style="text-align: right;">0.59</td><td style="text-align: right;">45</td><td style="text-align: right;">36</td><td>True</td></tr><tr class="odd"><td style="text-align: left;">2</td><td style="text-align: right;">1948-01-03</td><td style="text-align: right;">0.42</td><td style="text-align: right;">45</td><td style="text-align: right;">35</td><td>True</td></tr><tr class="even"><td style="text-align: left;">3</td><td style="text-align: right;">1948-01-04</td><td style="text-align: right;">0.31</td><td style="text-align: right;">45</td><td style="text-align: right;">34</td><td>True</td></tr><tr class="odd"><td style="text-align: left;">4</td><td style="text-align: right;">1948-01-05</td><td style="text-align: right;">0.17</td><td style="text-align: right;">45</td><td style="text-align: right;">32</td><td>True</td></tr></tbody></table><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">from</span> sklearn.calibration <span class="hljs-keyword">import</span> calibration_curve, CalibratedClassifierCV<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br><span class="hljs-keyword">from</span> sklearn.naive_bayes <span class="hljs-keyword">import</span> GaussianNB<br><br><span class="hljs-comment"># load the data into a dataframe</span><br>rain = pd.read_csv(<span class="hljs-string">&#x27;seattleWeather_1948-2017.csv&#x27;</span>).dropna()<br>rain.head()<br><br><span class="hljs-comment"># use the temperatures to predict whether or not there was rain that day</span><br>features = rain[[<span class="hljs-string">&#x27;TMIN&#x27;</span>, <span class="hljs-string">&#x27;TMAX&#x27;</span>]]<br>target = rain.RAIN.astype(<span class="hljs-built_in">bool</span>)<br>X_train, X_test, y_train, y_test = train_test_split(features, target, random_state=<span class="hljs-number">42</span>)<br><br><span class="hljs-comment"># use a Naive Bayes Classifier and make hard predictions</span><br>nb_rain = GaussianNB().fit(X_train, y_train)<br>accuracy = nb_rain.score(X_train, y_train)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;The hard predictions were right <span class="hljs-subst">&#123;<span class="hljs-number">100</span>*accuracy:<span class="hljs-number">5.2</span>f&#125;</span>% of the time&#x27;</span>)<br><br><span class="hljs-comment"># use the predict_proba method to get the probability of the positive case</span><br>predictions = nb_rain.predict_proba(X_train)[:, <span class="hljs-number">1</span>]<br><br><span class="hljs-comment"># call calibration_curve to &quot;bin&quot; similar predicted probabilities together, and calculate what percentage of the time</span><br><span class="hljs-comment"># it actually rains in that bin</span><br>binned_true_p, binned_predict_p = calibration_curve(y_train, predictions, n_bins=<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p>è°ƒç”¨<ahref="https://scikit-learn.org/stable/modules/generated/sklearn.calibration.calibration_curve.html">calibration_curve</a>å°†ç›¸ä¼¼çš„é¢„æµ‹æ¦‚ç‡åˆ†ç®±åœ¨ä¸€èµ·ï¼Œå¹¶è®¡ç®—åœ¨è¯¥ç»‘å®šä¸­å®é™…ä¸‹é›¨çš„æ—¶é—´ç™¾åˆ†æ¯”ã€‚</p><figure><img src="https://image.yinan.fun/202308201042945.png" alt="æ ¡å‡†æ›²çº¿" /><figcaption aria-hidden="true">æ ¡å‡†æ›²çº¿</figcaption></figure><p>å¦‚æœæˆ‘ä»¬çš„åˆ†ç±»å™¨è¾“å‡ºè‰¯å¥½çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæ ¡å‡†æ›²çº¿ä¸Šè¿™äº›ç‚¹å°†æ¥è¿‘è¿™æ¡çº¢çº¿ã€‚æ ¡å‡†æ›²çº¿ä¸Šçš„ç‚¹å‘Šè¯‰æˆ‘ä»¬ï¼Œå½“æˆ‘ä»¬çš„åˆ†ç±»å™¨å£°ç§°ä¸‹é›¨çš„æ¦‚ç‡çº¦ä¸º25%æ—¶ï¼Œå®é™…ä¸Šæœ‰33%çš„æ—¶é—´ä¸‹é›¨äº†ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ç»™å‡ºäº†çœ‹èµ·æ¥åƒæ¦‚ç‡çš„åˆ†æ•°ï¼Œå¹¶ä¸”æ˜¯ç”±<code>predict_proba</code>ç”Ÿæˆçš„ï¼Œä½†å½“æˆ‘ä»¬æŸ¥çœ‹æ ¡å‡†æ›²çº¿æ—¶ï¼Œæˆ‘ä»¬å‘ç°å®ƒä»¬å®é™…ä¸Šåªæ˜¯åˆ†æ•°ã€‚</p><h2 id="é‡æ–°æ ¡å‡†å’Œæ™®æ‹‰ç‰¹ç¼©æ”¾">é‡æ–°æ ¡å‡†å’Œæ™®æ‹‰ç‰¹ç¼©æ”¾</h2><p>å½“æ¨¡å‹çš„<code>predict_proba</code>æ–¹æ³•ç»™å‡ºåˆ†æ•°è€Œä¸æ˜¯æ¦‚ç‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ ¡å‡†åˆ†æ•°ï¼Œä½¿å…¶æ›´æ¥è¿‘æ¦‚ç‡ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæ™®æ‹‰ç‰¹ç¼©æ”¾ï¼ˆPlattscalingï¼‰ï¼Œåœ¨Scikit-learnä¸­ä½œä¸º<code>CalibratedClassifierCV</code>å®ç°ã€‚</p><p>Platt scalingæ˜¯ä¸€ä¸ªä¸¤å‚æ•°(two-parameter)ä¼˜åŒ–é—®é¢˜ï¼Œè€Œä¼˜åŒ–çš„ç›®æ ‡ä¸ºï¼š<span class="math display">\[min-\sum_i{t_i{\rm log}(p_i)+(1-t_i){\rm log}(1-p_i)}\]</span> å…¶ä¸­ <span class="math display">\[t_i=\frac{y_i+1}{2}\]</span></p><p><span class="math display">\[p_i = \frac{1}{1+e^{Af(x_i)+B}}\]</span></p><p><spanclass="math inline">\(f\)</span>è¡¨ç¤ºä¸€ä¸ªäºŒåˆ†ç±»æ¨¡å‹ï¼Œyçš„å€¼ä¸º-1æˆ–+1ï¼ŒAå’ŒBå°±æ˜¯æ™®æ‹‰ç‰¹ç¼©æ”¾è¦å­¦ä¹ çš„å‚æ•°ã€‚</p><p>åœ¨å¤©æ°”ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ™®æ‹‰ç‰¹ç¼©æ”¾åº”ç”¨äºæˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">calibrated_nb_rain = CalibratedClassifierCV(nb_rain, cv=<span class="hljs-number">5</span>, method=<span class="hljs-string">&#x27;isotonic&#x27;</span>)<br><span class="hljs-comment"># Note we need to refit!</span><br>calibrated_nb_rain.fit(X_train, y_train);<br><br><span class="hljs-comment"># access the probabilities after recalibration</span><br>calibrated_probs = calibrated_nb_rain.predict_proba(X_test)[:, <span class="hljs-number">1</span>]<br>binned_true_p, binned_predict_p = calibration_curve(y_test, calibrated_probs, n_bins=<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure><p><img src="https://image.yinan.fun/202308201323942.png"alt="image-20230820115155793" />ä¿®æ­£åçš„æ¦‚ç‡æ›´æ¥è¿‘çº¢çº¿ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆ†ç±»æ¦‚ç‡è½¬åˆ†æ•°</title>
    <link href="/%E5%88%86%E7%B1%BB%E6%A6%82%E7%8E%87%E8%BD%AC%E5%88%86%E6%95%B0.html"/>
    <url>/%E5%88%86%E7%B1%BB%E6%A6%82%E7%8E%87%E8%BD%AC%E5%88%86%E6%95%B0.html</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚ç‡è½¬åˆ†æ•°">æ¦‚ç‡è½¬åˆ†æ•°</h1><p>åˆ†ç±»å¯ä»¥åˆ†ä¸ºç¡¬åˆ†ç±»å’Œè½¯åˆ†ç±»ã€‚</p><p><strong>ç¡¬åˆ†ç±»ï¼ˆhardclassificationï¼‰</strong>æ˜¯å½“æˆ‘ä»¬è¿›è¡Œè§‚å¯Ÿå¹¶é¢„æµ‹å®ƒå±äºå“ªä¸ªç±»åˆ«æ—¶ã€‚ä¾‹å¦‚ï¼Œé“¶è¡Œå¯ä»¥ä½¿ç”¨æŸäººçš„è´¢åŠ¡å†å²ï¼ˆè§‚å¯Ÿï¼‰æ¥é¢„æµ‹ä»–ä»¬æ˜¯å¦ä¼šå¿è¿˜è´·æ¬¾ã€‚åŒ»ç”Ÿå¯ä»¥æµ‹é‡è‚¿ç˜¤ï¼ˆè§‚å¯Ÿç»“æœï¼‰ï¼Œä»¥é¢„æµ‹è‚¿ç˜¤æ˜¯å¦æ˜¯æ¶æ€§è‚¿ç˜¤ï¼Œæ˜¯å¦éœ€è¦åˆ‡é™¤ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œ<strong>è½¯åˆ†ç±»ï¼ˆsoftclassificationï¼‰</strong>è¡¨ç¤ºæ¨¡å‹å¯¹å…¶é¢„æµ‹çš„ä¿¡å¿ƒã€‚åœ¨å‘æ”¾è´·æ¬¾æ—¶ï¼Œæ¨¡å‹å¯èƒ½ä¼šåšå‡ºç¡¬åˆ†ç±»ï¼Œå³ä¸¤ä¸ªå®¢æˆ·éƒ½ä¼šå¿è¿˜è´·æ¬¾ï¼Œä½†è½¯åˆ†ç±»æ˜¯å®¢æˆ·1æœ‰80%çš„æœºä¼šå¿è¿˜è´·æ¬¾ï¼Œè€Œå®¢æˆ·2æœ‰95%çš„æœºä¼šå¿è¿˜è´·æ¬¾ã€‚</p><p>å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªè½¯åˆ†ç±»å™¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é€‰æ‹©ä¸€ä¸ªé˜ˆå€¼æ¥åˆ¶ä½œä¸€ä¸ªç¡¬åˆ†ç±»å™¨ï¼šåªéœ€å°†æ‰€æœ‰è½¯é¢„æµ‹é«˜äºé˜ˆå€¼çš„è§‚æµ‹å½’ç±»ä¸ºæ­£ç±»ï¼Œå°†è½¯é¢„æµ‹ä½äºé˜ˆå€¼çš„è§‚æµ‹å½’ç±»ä¸ºè´Ÿç±»ã€‚å¯¹äºè®¡ç®—æ¦‚ç‡çš„scikit-learnåˆ†ç±»å™¨ï¼Œè¿™å°±æ˜¯å®ƒä»¬åœ¨é»˜è®¤é˜ˆå€¼ä¸º50%çš„æƒ…å†µä¸‹çš„å·¥ä½œæ–¹å¼ã€‚ä½¿ç”¨æ¦‚ç‡ä½œä¸ºé—¨æ§›ä¹Ÿæœ‰åŠ©äºä½¿æ¨¡å‹æ›´å®¹æ˜“è§£é‡Šï¼šå¯¹äºè´·æ¬¾åˆ†ç±»å™¨ï¼Œæ‚¨åªæƒ³æ¥å—æ‚¨çœŸæ­£æœ‰ä¿¡å¿ƒçš„äººï¼ˆä¾‹å¦‚ï¼Œé‚£äº›å¿è¿˜è´·æ¬¾çš„å‡ ç‡é«˜å‡º85%çš„äººï¼‰ã€‚å¯¹äºè‚¿ç˜¤ç—…ä¾‹ï¼Œæ‚¨å¯èƒ½ä¼šå†³å®šè®©åŒ»ç”Ÿæ£€æŸ¥ä»»ä½•æœ‰5%ä»¥ä¸Šæ¶æ€§å‡ ç‡çš„è‚¿ç˜¤ã€‚</p><p>è™½ç„¶æ¦‚ç‡æ˜¯è¿›è¡Œè½¯åˆ†ç±»çš„æ–¹ä¾¿æ–¹æ³•ï¼Œä½†æˆ‘ä»¬çœŸæ­£éœ€è¦çš„åªæ˜¯åˆ†æ•°ã€‚å¯¹äºäºŒåˆ†ç±»å™¨æ¥è¯´ï¼Œè¿™æ˜¯æœ€å®¹æ˜“è§£é‡Šçš„ã€‚å°†å…¶ä¸­ä¸€ä¸ªç±»åˆ«ç§°ä¸ºæ­£ç±»ï¼Œæˆ‘ä»¬ä»åˆ†æ•°ä¸­å”¯ä¸€éœ€è¦çš„å°±æ˜¯<strong>æ›´é«˜çš„åˆ†æ•°æ„å‘³ç€æ¨¡å‹æ›´æœ‰ä¿¡å¿ƒè¾“å…¥ï¼ˆobservationï¼‰å±äºæ­£ç±»ã€‚</strong></p><p><ahref="https://yinan.fun/åˆ†ç±»é—®é¢˜ä¸­æ¦‚ç‡ä¸åˆ†æ•°">åˆ†ç±»é—®é¢˜ä¸­æ¦‚ç‡ä¸åˆ†æ•°</a></p><h2 id="äºŒåˆ†ç±»">äºŒåˆ†ç±»</h2><p>åˆ†æ•°è¯„ä»·å¥½åï¼Œæ ·æœ¬æ˜¯å¥½æ ·æœ¬ï¼ˆæ ‡ç­¾ä¸º1ï¼‰çš„æ¦‚ç‡è¶Šé«˜ï¼Œåˆ†æ•°è¶Šé«˜ã€‚</p><ol type="1"><li><p>å°†é€¾æœŸç‡æ¦‚ç‡å€¼ç›´æ¥ä¹˜ä»¥100å°±å¾—åˆ°åˆ†æ•°äº†ï¼Œä½†æ˜¯LRå¾—åˆ°çš„æ¦‚ç‡å€¼å¾€å¾€æ˜¯ä¸å‡åŒ€çš„ï¼Œæ¯”å¦‚è®²æ¦‚ç‡å€¼æ’åºåï¼Œå¤´éƒ¨å’Œå°¾éƒ¨çš„æ¦‚ç‡å€¼è¾ƒå°‘ï¼Œå¤§éƒ¨åˆ†æ¦‚ç‡éƒ½é›†ä¸­åœ¨ä¸­é—´æŸä¸ªåŒºåŸŸï¼Œè¿™æ—¶è¿™ç§æ–¹æ³•å°±å¤±æ•ˆäº†ã€‚<span class="math display">\[Score=p\times 100\]</span></p></li><li><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯å°†æ¦‚ç‡å€¼è¿›è¡Œæ’åºï¼Œæ‰¾å‡ºå¤´éƒ¨çš„20%æ¦‚ç‡å€¼æ˜ å°„åˆ°80-100åˆ†ï¼Œå°¾éƒ¨çš„20%æ¦‚ç‡å€¼æ˜ å°„åˆ°0-60åˆ†ï¼Œä¸­é—´çš„60%æ¦‚ç‡å€¼æ˜ å°„åˆ°60-80åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> pandas <span class="hljs-keyword">import</span> DataFrame<br> <br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">score_model</span>(<span class="hljs-params">result_train, bins_num=<span class="hljs-number">10</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">        æ ¹æ®è¾“å…¥çš„æ ·æœ¬æ•°æ®ï¼Œè¿›è¡Œæ‰“åˆ†æ¨¡å‹çš„è®­ç»ƒï¼š</span><br><span class="hljs-string">            è¾“å…¥æ•°æ®æ ¼å¼ï¼šdict ç»„æˆlistï¼Œ dict = &#123;score : ml_model_proba&#125;</span><br><span class="hljs-string">            è¾“å‡ºæ•°æ®æ ¼å¼ï¼šbin_dict = &#123;i:&#123;&#x27;left&#x27;: , &#x27;right&#x27;: , &#x27;line_train_list&#x27;&#125;&#125;</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    sorted_result_train = <span class="hljs-built_in">sorted</span>(result_train, key=<span class="hljs-keyword">lambda</span> result_train:result_train[<span class="hljs-string">&#x27;score&#x27;</span>], reverse=<span class="hljs-literal">False</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-built_in">len</span>(sorted_result_train))<br>    score_bins = &#123;&#125;<br>    every_len = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">len</span>(sorted_result_train) / bins_num)<br>    <span class="hljs-built_in">print</span>(every_len)<br>    <span class="hljs-comment"># 30åˆ†ç²’åº¦ï¼Œåšåˆ†æ¡¶ï¼Œæ¡¶å†…ç›´çº¿æ‹Ÿåˆ</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, bins_num):<br>        left = sorted_result_train[i*every_len][<span class="hljs-string">&#x27;score&#x27;</span>]<br>        right = sorted_result_train[(i+<span class="hljs-number">1</span>)*every_len-<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;score&#x27;</span>]<br>        step = <span class="hljs-number">300</span>/bins_num<br>        score_map = [<span class="hljs-number">800</span>-i*step, <span class="hljs-number">800</span>-(i+<span class="hljs-number">1</span>)*step]<br>        <span class="hljs-keyword">if</span> i == bins_num-<span class="hljs-number">1</span>:<br>            right = sorted_result_train[-<span class="hljs-number">1</span>][<span class="hljs-string">&#x27;score&#x27;</span>]<br>        line_train = np.polyfit([left, right], score_map, <span class="hljs-number">1</span>)<br>        line_train_list = line_train.tolist()<br>        bins = <span class="hljs-built_in">dict</span>()<br>        bins[<span class="hljs-string">&#x27;left&#x27;</span>] = left<br>        bins[<span class="hljs-string">&#x27;right&#x27;</span>] = right<br>        bins[<span class="hljs-string">&#x27;line_train_list&#x27;</span>] = line_train_list<br>        score_bins[i] = bins<br>    <span class="hljs-keyword">return</span> score_bins<br> <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_score</span>(<span class="hljs-params">score_bins, result_proab</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">       æ‰“åˆ†æ¨¡å‹ï¼šæ ¹æ®è¾“å…¥çš„result_proab, æŒ‰ç…§score_binsè¿›è¡Œæ‰“åˆ†ï¼›score_binså°±æ˜¯æ‰“åˆ†model</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    proab = result_proab<br>    score = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> k,v <span class="hljs-keyword">in</span> score_bins.items():<br>        <span class="hljs-keyword">if</span> proab &gt;= v[<span class="hljs-string">&#x27;left&#x27;</span>] <span class="hljs-keyword">and</span> proab &lt; v[<span class="hljs-string">&#x27;right&#x27;</span>]:<br>            score = v[<span class="hljs-string">&#x27;line_train_list&#x27;</span>][<span class="hljs-number">0</span>] * proab + v[<span class="hljs-string">&#x27;line_train_list&#x27;</span>][<span class="hljs-number">1</span>]<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> score<br> <br> <br>scores = np.random.random(<span class="hljs-number">20</span>)<br>ids = <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)<br>df = DataFrame([ids,scores]).T<br>df.columns = [<span class="hljs-string">&quot;id&quot;</span>, <span class="hljs-string">&quot;score&quot;</span>]<br>dic = df.to_dict(orient=<span class="hljs-string">&quot;records&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;dic:&quot;</span>,dic)<br><span class="hljs-comment">#è®­ç»ƒæ‰“åˆ†æ¨¡å‹ï¼ˆå°†é€¾æœŸçš„æ¦‚ç‡æ˜ å°„ä¸º500-800ä¹‹é—´çš„åˆ†æ•°ï¼Œåˆ†æ•°è¶Šé«˜ï¼Œç”¨æˆ·è¶Šå¥½ï¼‰</span><br>score_bins = score_model(dic)<br><span class="hljs-built_in">print</span>(score_bins)<br><span class="hljs-comment">#è¾“å…¥predæ¦‚ç‡å€¼ï¼Œè¾“å‡ºåˆ†æ•°</span><br>result_proab = <span class="hljs-number">0.083882018</span><br>score = predict_score(score_bins, result_proab)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;score:&quot;</span>, score)<br></code></pre></td></tr></table></figure></li><li><p>è¯„åˆ†è¡¨</p><p>è¯„åˆ†å¡é¢„æµ‹åˆ†æ•°æ—¶ä¸éœ€è¦è®¡ç®—æ¦‚ç‡ï¼Œè€Œæ˜¯ç›´æ¥ç”¨çº¿æ€§éƒ¨åˆ†è½¬æ¢æˆåˆ†æ•°ï¼Œæ¯ä¸€ä¸ªç‰¹å¾xçš„åˆ†æ•°å’Œå°±æ˜¯æ€»åˆ†ã€‚<span class="math display">\[\begin{align}Score&amp;=A+B\times\ln(odds) \\&amp;=A+B\times(\omega_0+\omega_1x_1+\cdots+\omega_nx_x)\\&amp;=(A+B\omega_0)+B\omega_1x_1+\cdots+B\omega_nx_x\end{align}\]</span> <ahref="https://yinan.fun/lr%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A6%82%E7%8E%87%E5%80%BC%E8%BD%AC%E5%88%86%E6%95%B0">è¯„åˆ†è¡¨åŸç†</a></p><p><ahref="https://yinan.fun/%E8%AF%84%E5%88%86%E5%8D%A1%E6%A8%A1%E5%9E%8B">è¯„åˆ†è¡¨å»ºæ¨¡</a></p></li></ol><h2 id="å¤šåˆ†ç±»">å¤šåˆ†ç±»</h2><p>å¤šåˆ†ç±»æ— æ³•ç›´æ¥æ ¹æ®æ ·æœ¬æ ‡ç­¾ç¡®å®šæ ·æœ¬çš„å¥½åï¼Œéœ€è¦å®šä¹‰æ¯ä¸ªæ ‡ç­¾çš„å¥½åç¨‹åº¦ã€‚</p><ol type="1"><li><p>ç¡®å®šæ¯ä¸ªç±»åˆ«iåˆ†æ•°ä¸º<spanclass="math inline">\(s_i\)</span>ï¼Œåˆ†æ•°ä¸º <span class="math display">\[s=\sum_{i=1}^n p_i\times s_i\]</span></p><blockquote><p>äºŒåˆ†ç±»ï¼Œ<span class="math inline">\(s_0=0, s_1=100\)</span>ã€‚</p></blockquote></li><li><p>è®¡ç®—æ ·æœ¬ä¸ºå¥½æ ·æœ¬çš„æ¦‚ç‡ï¼Œå†è½¬åŒ–ä¸ºåˆ†æ•°ã€‚</p></li></ol><h2 id="æ¦‚ç‡è¯„åˆ†æ–¹æ³•">æ¦‚ç‡è¯„åˆ†æ–¹æ³•</h2><p>åˆ†æ•°è¯„ä»·é¢„æµ‹æ¦‚ç‡çš„å‡†ç¡®ç‡</p><p><ahref="https://yinan.fun/%E6%A6%82%E7%8E%87%E8%AF%84%E5%88%86%E6%96%B9%E6%B3%95">æ¦‚ç‡è¯„åˆ†æ–¹æ³•</a></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¯„åˆ†å¡æ¨¡å‹</title>
    <link href="/%E8%AF%84%E5%88%86%E5%8D%A1%E6%A8%A1%E5%9E%8B.html"/>
    <url>/%E8%AF%84%E5%88%86%E5%8D%A1%E6%A8%A1%E5%9E%8B.html</url>
    
    <content type="html"><![CDATA[<h1 id="è¯„åˆ†å¡æ¨¡å‹">è¯„åˆ†å¡æ¨¡å‹</h1><h2 id="æ•°æ®å¯¼å…¥">æ•°æ®å¯¼å…¥</h2><p>ä½¿ç”¨kaggleä¸Šçš„<ahref="https://www.kaggle.com/c/GiveMeSomeCredit/data">Give Me SomeCredit</a>æ•°æ®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">df = pd.read_csv(<span class="hljs-string">&#x27;cs-training.csv&#x27;</span>)<br></code></pre></td></tr></table></figure><h2 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h2><h3 id="ç¼ºå¤±å€¼å¤„ç†">ç¼ºå¤±å€¼å¤„ç†</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-built_in">print</span>(df.info())<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">&lt;class <span class="hljs-string">&#x27;pandas.core.frame.DataFrame&#x27;</span>&gt;<br>RangeIndex: 150000 entries, 0 to 149999<br>Data columns (total 12 columns):<br> <span class="hljs-comment">#   Column      Non-Null Count   Dtype  </span><br>---  ------      --------------   -----  <br> 0   ç”¨æˆ·ID        150000 non-null  int64  <br> 1   å¥½åå®¢æˆ·        150000 non-null  int64  <br> 2   å¯ç”¨é¢åº¦æ¯”å€¼      150000 non-null  float64<br> 3   å¹´é¾„          150000 non-null  int64  <br> 4   é€¾æœŸ30-59å¤©ç¬”æ•°  150000 non-null  int64  <br> 5   è´Ÿå€ºç‡         150000 non-null  float64<br> 6   æœˆæ”¶å…¥         120269 non-null  float64<br> 7   ä¿¡è´·æ•°é‡        150000 non-null  int64  <br> 8   é€¾æœŸ90å¤©ç¬”æ•°     150000 non-null  int64  <br> 9   å›ºå®šèµ„äº§è´·æ¬¾æ•°é‡    150000 non-null  int64  <br> 10  é€¾æœŸ60-89å¤©ç¬”æ•°  150000 non-null  int64  <br> 11  å®¶å±æ•°é‡        146076 non-null  float64<br>dtypes: float64(4), int64(8)<br>memory usage: 13.7 MB<br></code></pre></td></tr></table></figure><p>æœˆæ”¶å…¥ç¼ºå¤±æ¯”:19.82%ï¼Œå®¶å±æ•°é‡ç¼ºå¤±æ¯”:2.62%ã€‚</p><p>å®¶å±æ•°é‡å¯¹åº”çš„ç¼ºå¤±æ¯”ä¾‹ä½äº5%ï¼Œå¯ç›´æ¥åˆ é™¤ï¼›æœˆæ”¶å…¥ç¼ºå¤±æ¯”æ¯”è¾ƒé«˜ï¼Œä¸èƒ½ç›´æ¥åˆ é™¤ï¼Œåˆ©ç”¨å¡«å……å¹³å‡å€¼çš„æ–¹æ³•è¿›è¡Œè¡¥å……ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç¼ºå¤±å€¼å¡«å……</span><br>df = df.fillna(&#123;<span class="hljs-string">&#x27;æœˆæ”¶å…¥&#x27;</span>:df[<span class="hljs-string">&#x27;æœˆæ”¶å…¥&#x27;</span>].mean()&#125;)<br><span class="hljs-comment"># ç¼ºå¤±å€¼åˆ é™¤</span><br>df.dropna(inplace = <span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure><h3 id="å¼‚å¸¸å€¼å¤„ç†">å¼‚å¸¸å€¼å¤„ç†</h3><p>ç”¨ç®±å½¢å›¾åˆ¤æ–­å¼‚å¸¸å€¼ï¼Œå†è¿‡æ»¤å¼‚å¸¸å€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># å¼‚å¸¸å€¼è¿‡æ»¤</span><br>df = df[df[<span class="hljs-string">&quot;å›ºå®šèµ„äº§è´·æ¬¾æ•°é‡&quot;</span>]&lt;<span class="hljs-number">50</span>]<br>df = df[df[<span class="hljs-string">&quot;é€¾æœŸ30-59å¤©ç¬”æ•°&quot;</span>]&lt;<span class="hljs-number">80</span>]<br>df = df[df[<span class="hljs-string">&quot;å¹´é¾„&quot;</span>]&gt;<span class="hljs-number">0</span>]<br>df = df[df[<span class="hljs-string">&#x27;å¯ç”¨é¢åº¦æ¯”å€¼&#x27;</span>]&lt;=<span class="hljs-number">1</span>]<br></code></pre></td></tr></table></figure><h2 id="ç‰¹å¾é€‰æ‹©">ç‰¹å¾é€‰æ‹©</h2><p>è¿‡æ»¤æ‰ä¸€äº›å¯¹äºç›®æ ‡å˜é‡å½±å“æƒé‡è¾ƒå°çš„ç‰¹å¾å˜é‡ï¼Œè¿™é‡Œä½¿ç”¨IVå€¼è¿›è¡Œç‰¹å¾ç­›é€‰ã€‚</p><h3 id="woeåˆ†ç®±">WOEåˆ†ç®±</h3><p>WOEï¼ˆWeight ofEvidenceï¼‰å³è¯æ®æƒé‡ï¼Œå¯ä»¥å°†logisticå›å½’æ¨¡å‹è½¬åŒ–ä¸ºæ ‡å‡†è¯„åˆ†å¡æ ¼å¼ï¼ŒWOEæ˜¯å¯¹åŸå§‹è‡ªå˜é‡çš„ä¸€ç§ç¼–ç å½¢å¼ï¼Œè¦å¯¹ä¸€ä¸ªå˜é‡è¿›è¡ŒWOEç¼–ç ï¼Œéœ€è¦é¦–å…ˆæŠŠè¿™ä¸ªå˜é‡è¿›è¡Œåˆ†ç»„å¤„ç†ï¼ˆä¹Ÿå«ç¦»æ•£åŒ–ã€åˆ†ç®±ï¼‰ã€‚WOE=ln(åæ ·æœ¬å æ¯”/å¥½æ ·æœ¬å æ¯”)<span class="math display">\[WOE_i=\ln(\frac{Bad_{X=X_i}/Bad_{tatol}}{Good_{X=X_i}/Good_{tatol}})\]</span> WOEåˆ†ç®±å°±æ˜¯å°†è¿ç»­å˜é‡ç¦»æ•£åŒ–ï¼Œå³åˆ‡åˆ†æˆä¸åŒçš„åŒºé—´æ®µï¼Œç¦»æ•£åŒ–åçš„å˜é‡å…·æœ‰å¾ˆå¥½çš„ç¨³å®šæ€§ï¼Œæ¯”å¦‚å¹´é¾„è¿™ä¸ªè¿ç»­å˜é‡ï¼Œå¦‚æœæ˜¯è¿ç»­å€¼çš„æ—¶å€™21å’Œ29å°±æ˜¯ä¸¤ä¸ªä¸åŒçš„å€¼ï¼Œå¯¹æ¨¡å‹çš„æ•ˆæœå¯èƒ½å°±ä¸ä¸€æ ·ï¼Œå¦‚æœç¦»æ•£åŒ–æˆ20-30çš„æ—¶å€™ï¼Œè¿™ä¸¤ä¸ªå¹´é¾„å¯¹æ¨¡å‹çš„æ•ˆæœå°±æ˜¯ä¸€æ ·ï¼Œæ›´åŠ ç¨³å®šã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># åˆ†ç®±</span><br>cut1, bins1 = pd.qcut(df[<span class="hljs-string">&quot;å¯ç”¨é¢åº¦æ¯”å€¼&quot;</span>],<span class="hljs-number">4</span>,labels=<span class="hljs-literal">False</span>, retbins=<span class="hljs-literal">True</span>)<br>cut2, bins2 = pd.qcut(df[<span class="hljs-string">&quot;å¹´é¾„&quot;</span>],<span class="hljs-number">8</span>,labels=<span class="hljs-literal">False</span>, retbins=<span class="hljs-literal">True</span>)<br>bins3=[-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">3</span>,<span class="hljs-number">5</span>,<span class="hljs-number">13</span>]<br>cut3=pd.cut(df[<span class="hljs-string">&quot;é€¾æœŸ30-59å¤©ç¬”æ•°&quot;</span>],bins3,labels=<span class="hljs-literal">False</span>)<br>cut4=pd.qcut(df[<span class="hljs-string">&quot;è´Ÿå€ºç‡&quot;</span>],<span class="hljs-number">3</span>,labels=<span class="hljs-literal">False</span>)<br>cut5=pd.qcut(df[<span class="hljs-string">&quot;æœˆæ”¶å…¥&quot;</span>],<span class="hljs-number">4</span>,labels=<span class="hljs-literal">False</span>)<br>cut6=pd.qcut(df[<span class="hljs-string">&quot;ä¿¡è´·æ•°é‡&quot;</span>],<span class="hljs-number">4</span>,labels=<span class="hljs-literal">False</span>)<br>bins7=[-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>,<span class="hljs-number">5</span>, <span class="hljs-number">20</span>]<br>cut7=pd.cut(df[<span class="hljs-string">&quot;é€¾æœŸ90å¤©ç¬”æ•°&quot;</span>],bins7,labels=<span class="hljs-literal">False</span>)<br>bins8=[-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">33</span>]<br>cut8=pd.cut(df[<span class="hljs-string">&quot;å›ºå®šèµ„äº§è´·æ¬¾æ•°é‡&quot;</span>],bins8,labels=<span class="hljs-literal">False</span>)<br>bins9=[-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">12</span>]<br>cut9=pd.cut(df[<span class="hljs-string">&quot;é€¾æœŸ60-89å¤©ç¬”æ•°&quot;</span>],bins9,labels=<span class="hljs-literal">False</span>)<br>bins10=[-<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">21</span>]<br>cut10=pd.cut(df[<span class="hljs-string">&quot;å®¶å±æ•°é‡&quot;</span>],bins10,labels=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è®¡ç®—WOE</span><br><span class="hljs-comment"># æ•´ä½“å¥½åæ¯”ï¼ˆå®šä¹‰æ ‡ç­¾ä¸º1ä¸ºå¥½å®¢æˆ·ï¼‰</span><br>total_rate = df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].<span class="hljs-built_in">sum</span>()/(df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].count()-df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].<span class="hljs-built_in">sum</span>())<br><br><span class="hljs-comment"># å®šä¹‰WOEå‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_woe</span>(<span class="hljs-params">cut</span>):<br>    grouped = df.groupby(cut)[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].value_counts()<br>    <span class="hljs-comment"># ç»„å†…å¥½åæ¯”</span><br>    woe = np.log(pd.DataFrame(grouped).unstack().iloc[:,<span class="hljs-number">1</span>]/pd.DataFrame(grouped).unstack().iloc[:,<span class="hljs-number">0</span>]/total_rate)<br>    <span class="hljs-keyword">return</span> woe<br><span class="hljs-comment"># è®¡ç®—WOEå€¼ï¼Œå¦‚æœè®¡ç®—å‡ºæ¥çš„WOEä¸æ˜¯å•è°ƒçš„å°±éœ€è¦é‡æ–°åˆ†ç®±</span><br>cut1_woe = get_woe(cut1)<br>cut2_woe = get_woe(cut2)<br>cut3_woe = get_woe(cut3)<br>cut4_woe = get_woe(cut4)<br>cut5_woe = get_woe(cut5)<br>cut6_woe = get_woe(cut6)<br>cut7_woe = get_woe(cut7)<br>cut8_woe = get_woe(cut8)<br>cut9_woe = get_woe(cut9)<br>cut10_woe = get_woe(cut10)<br></code></pre></td></tr></table></figure><h3 id="è®¡ç®—ivå€¼">è®¡ç®—IVå€¼</h3><p>IVï¼ˆInformationvalueï¼ŒIVï¼‰ä¿¡æ¯å€¼ï¼ŒIVå€¼è¡¡é‡ä¸€ä¸ªå˜é‡çš„ä¿¡æ¯é‡ï¼Œè®¡ç®—å…¬å¼ä¸ºSUMï¼ˆï¼ˆå¥½æ ·æœ¬å æ¯”-åæ ·æœ¬å æ¯”ï¼‰*è¿¹è±¡æƒæ•°ï¼‰ <span class="math display">\[IV=\sum_{i=1}^{N}(Good_{X=X_i}/Good_{tatol}-Bad_{X=X_i}/Bad_{tatol})\timesWOE_i\]</span></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># è®¡ç®—æ¯ä¸ªå˜é‡çš„IVå€¼</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_iv_data</span>(<span class="hljs-params">cut,cut_woe</span>):<br>    grouped = df.groupby(cut)[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].value_counts()<br>    cut_iv = ((grouped.unstack().iloc[:,<span class="hljs-number">1</span>]/df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].<span class="hljs-built_in">sum</span>()- grouped.unstack().iloc[:,<span class="hljs-number">0</span>]/(df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].count()-df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>].<span class="hljs-built_in">sum</span>()))*cut_woe).<span class="hljs-built_in">sum</span>()<br>    <span class="hljs-keyword">return</span> cut_iv<br><br><br>cut1_iv = get_iv_data(cut1,cut1_woe)<br>cut2_iv = get_iv_data(cut2,cut2_woe)<br>cut3_iv = get_iv_data(cut3,cut3_woe)<br>cut4_iv = get_iv_data(cut4,cut4_woe)<br>cut5_iv = get_iv_data(cut5,cut5_woe)<br>cut6_iv = get_iv_data(cut6,cut6_woe)<br>cut7_iv = get_iv_data(cut7,cut7_woe)<br>cut8_iv = get_iv_data(cut8,cut8_woe)<br>cut9_iv = get_iv_data(cut9,cut9_woe)<br>cut10_iv = get_iv_data(cut10,cut10_woe)<br></code></pre></td></tr></table></figure><figure><img src="https://image.yinan.fun/202308131313073.png"alt="image-20230812214550651" /><figcaption aria-hidden="true">image-20230812214550651</figcaption></figure><p>å¯ä»¥çœ‹åˆ°["è´Ÿå€ºç‡","æœˆæ”¶å…¥","ä¿¡è´·æ•°é‡","å›ºå®šèµ„äº§è´·æ¬¾é‡","å®¶å±æ•°é‡"]è¿™å‡ ä¸ªç‰¹å¾çš„IVå€¼è¿‡ä½ï¼Œå¯¹ç›®æ ‡å˜é‡çš„å½±å“è¾ƒå°ï¼Œå°†å…¶è¿‡æ»¤æ‰ã€‚</p><h3 id="ç”¨woeå€¼ä»£æ›¿åŸå§‹æ•°æ®">ç”¨WOEå€¼ä»£æ›¿åŸå§‹æ•°æ®</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment"># åŸå§‹åˆ†ç»„åçš„æ•°æ®é›†ï¼Œæ ¹æ®å„ç»„æ ‡ç­¾æ›¿ä»£ä¸ºå¯¹åº”çš„WOEå€¼</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">replace_data</span>(<span class="hljs-params">cut,cut_woe</span>):<br>   <span class="hljs-comment"># ä¿å­˜å„ç®±æ ‡ç­¾</span><br>    a = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cut.unique():<br>        a.append(i)<br>        a.sort()  <span class="hljs-comment"># æ¯ç®±ä»å°åˆ°å¤§æ’åºï¼Œå¹¶è®¡ç®—å¯¹åº”çš„WOEå€¼</span><br>    <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(a)):<br>        cut.replace(a[m],cut_woe.values[m],inplace = <span class="hljs-literal">True</span>)<br>    <span class="hljs-keyword">return</span> cut<br><span class="hljs-comment"># è¿›è¡Œæ›¿æ¢</span><br>df_new = pd.DataFrame()<br>df_new[<span class="hljs-string">&#x27;å¯ç”¨é¢åº¦æ¯”å€¼&#x27;</span>] = replace_data(cut1,cut1_woe)<br>df_new[<span class="hljs-string">&#x27;å¹´é¾„&#x27;</span>]=replace_data(cut2,cut2_woe)<br>df_new[<span class="hljs-string">&#x27;é€¾æœŸ30-59å¤©ç¬”æ•°&#x27;</span>] = replace_data(cut3,cut3_woe)<br>df_new[<span class="hljs-string">&#x27;é€¾æœŸ90å¤©ç¬”æ•°&#x27;</span>] = replace_data(cut7,cut7_woe)<br>df_new[<span class="hljs-string">&#x27;é€¾æœŸ60-89å¤©ç¬”æ•°&#x27;</span>] = replace_data(cut9,cut9_woe)<br>df_new[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>] = df[<span class="hljs-string">&#x27;å¥½åå®¢æˆ·&#x27;</span>]<br></code></pre></td></tr></table></figure><h2 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># æ¨¡å‹è®­ç»ƒåŠæµ‹è¯•</span><br>x = df_new.iloc[:,<span class="hljs-number">0</span>:-<span class="hljs-number">1</span>]<br>y = df_new.iloc[:,-<span class="hljs-number">1</span>]<br>x_train,x_test,y_train,y_test = train_test_split(x,y,test_size = <span class="hljs-number">0.4</span>,random_state = <span class="hljs-number">0</span>)<br>model = LogisticRegression()<br>clf = model.fit(x_train,y_train)<br><span class="hljs-comment"># é¢„æµ‹æ ‡ç­¾</span><br>y_pred  = clf.predict(x_test)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;æµ‹è¯•é›†çš„å¹³å‡æ­£ç¡®ç‡ï¼š&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(clf.score(x_test,y_test)))<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">æµ‹è¯•é›†çš„å¹³å‡æ­£ç¡®ç‡ï¼š0.9423646788588662<br></code></pre></td></tr></table></figure><h2 id="è®¡ç®—å¾—åˆ†">è®¡ç®—å¾—åˆ†</h2><p><span class="math display">\[\begin{align}Score&amp;=A+B\times\ln(odds) \\&amp;=A+B\times(\omega_0+\omega_1x_1+\cdots+\omega_nx_x)\\&amp;=(A+B\omega_0)+B\omega_1x_1+\cdots+B\omega_nx_x\end{align}\]</span></p><p>çº¦å®šï¼šå½“oddså¢åŠ ä¸€å€ï¼Œåˆ†æ•°å¢åŠ 20åˆ†ï¼›å½“odds = 1,åˆ†æ•°ä¸º600åˆ†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># ç³»æ•°å€¼</span><br>coe = clf.coef_<br>bias = clf.intercept_<br><span class="hljs-comment"># score = offset+factor*log(odds)</span><br>factor = <span class="hljs-number">20</span> / np.log(<span class="hljs-number">2</span>)<br>offset = <span class="hljs-number">600</span><br><br><span class="hljs-comment"># å®šä¹‰å˜é‡åˆ†æ•°è®¡ç®—å‡½æ•°</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_score</span>(<span class="hljs-params">coe,woe,factor</span>):<br>    scores = []<br>    <span class="hljs-keyword">for</span> w <span class="hljs-keyword">in</span> woe:<br>        score=<span class="hljs-built_in">round</span>(coe*w*factor,<span class="hljs-number">0</span>)<br>        scores.append(score)<br>    <span class="hljs-keyword">return</span> scores<br><br><span class="hljs-comment"># è®¡ç®—æ¯ä¸ªå˜é‡å¾—åˆ†</span><br>x1 = get_score(coe[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>],cut1_woe,factor)<br>x2 = get_score(coe[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>],cut2_woe,factor)<br>x3 = get_score(coe[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>],cut3_woe,factor)<br>x7 = get_score(coe[<span class="hljs-number">0</span>][<span class="hljs-number">3</span>],cut7_woe,factor)<br>x9 = get_score(coe[<span class="hljs-number">0</span>][<span class="hljs-number">4</span>],cut9_woe,factor)<br>base_score = offset + factor * bias;<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">åŸºç¡€åˆ†æ•°:[521.32931339]<br>å¯ç”¨é¢åº¦æ¯”å€¼å¯¹åº”åˆ†ç®±:[0., 0.02953715 0.1480833, 0.52137127, 1.]<br>å¯ç”¨é¢åº¦æ¯”å€¼å¯¹åº”çš„åˆ†æ•°:[-22.0, -21.0, -5.0, 19.0]<br>å¹´é¾„å¯¹åº”åˆ†ç®±:[ 21.  35.  41.  47.  52.  57.  63.  70. 107.]<br>å¹´é¾„å¯¹åº”çš„åˆ†æ•°:[8.0, 5.0, 4.0, 3.0, -0.0, -6.0, -13.0, -16.0]<br>é€¾æœŸ30-59å¤©ç¬”æ•°å¯¹åº”çš„åˆ†æ•°:[-8.0, 14.0, 27.0, 37.0, 42.0]<br>é€¾æœŸ90å¤©ç¬”æ•°å¯¹åº”çš„åˆ†æ•°:[-6.0, 34.0, 48.0, 57.0, 57.0]<br>é€¾æœŸ60-89å¤©ç¬”æ•°å¯¹åº”çš„åˆ†æ•°:[-3.0, 24.0, 35.0, 39.0]<br></code></pre></td></tr></table></figure><h2 id="è·å¾—è¯„åˆ†å¡">è·å¾—è¯„åˆ†å¡</h2><table><thead><tr class="header"><th>å˜é‡</th><th>åˆ†ç®±ç±»åˆ«</th><th>åˆ†æ•°</th></tr></thead><tbody><tr class="odd"><td>åŸºç¡€åˆ†æ•°</td><td>-</td><td>521.32931339</td></tr><tr class="even"><td>å¯ç”¨é¢åº¦</td><td>0 - 0.02953715</td><td>-22.0</td></tr><tr class="odd"><td></td><td>0.02953715 - 0.1480833</td><td>-21.0</td></tr><tr class="even"><td></td><td>0.1480833 - 0.52137127</td><td>-5.0</td></tr><tr class="odd"><td></td><td>0.52137127 - 1</td><td>19.0</td></tr><tr class="even"><td>å¹´é¾„</td><td>21 - 35</td><td>8.0</td></tr><tr class="odd"><td></td><td>35 - 41</td><td>5.0</td></tr><tr class="even"><td></td><td>41 - 47</td><td>4.0</td></tr><tr class="odd"><td></td><td>47 - 52</td><td>3.0</td></tr><tr class="even"><td></td><td>52 - 57</td><td>-0.0</td></tr><tr class="odd"><td></td><td>57 - 63</td><td>-6.0</td></tr><tr class="even"><td></td><td>63 - 70</td><td>-13.0</td></tr><tr class="odd"><td></td><td>70 - 107</td><td>-16.0</td></tr><tr class="even"><td>é€¾æœŸ30-59å¤©ç¬”æ•°</td><td>-1 - 0</td><td>-8.0</td></tr><tr class="odd"><td></td><td>0 - 1</td><td>14.0</td></tr><tr class="even"><td></td><td>1 - 3</td><td>27.0</td></tr><tr class="odd"><td></td><td>3 - 5</td><td>37.0</td></tr><tr class="even"><td></td><td>5 - 13</td><td>42.0</td></tr><tr class="odd"><td>é€¾æœŸ60-89å¤©ç¬”æ•°</td><td>-1 - 0</td><td>-3.0</td></tr><tr class="even"><td></td><td>0 - 1</td><td>24.0</td></tr><tr class="odd"><td></td><td>1 - 3</td><td>35.0</td></tr><tr class="even"><td></td><td>3 - 12</td><td>39.0</td></tr><tr class="odd"><td>é€¾æœŸ90å¤©ç¬”æ•°</td><td>-1 - 0</td><td>-6.0</td></tr><tr class="even"><td></td><td>0 - 1</td><td>34.0</td></tr><tr class="odd"><td></td><td>1 - 3</td><td>48.0</td></tr><tr class="even"><td></td><td>3 - 5</td><td>57.0</td></tr><tr class="odd"><td></td><td>5 - 20</td><td>57.0</td></tr></tbody></table><p>ä¸Šé¢å¾—åˆ°çš„æ˜¯ä¸åŒç‰¹å¾å€¼å¯¹åº”çš„åˆ†æ•°ï¼Œè¯„åˆ†è¶Šé«˜è¡¨æ˜è¯¥ç”¨æˆ·è¶Šæœ‰å¯èƒ½ç›¸åº”ç›®æ ‡å˜é‡ï¼Œæˆä¸ºåç”¨æˆ·ï¼›ç‰¹å¾åˆ’åˆ†åŒºé—´æ˜¯ä¾æ¬¡é€’å¢çš„ï¼Œç‰¹å¾åŒºé—´å€¼ä¸å¾—åˆ†æ˜¯ç›¸å¯¹åº”çš„ï¼Œå¹´é¾„è¶Šå¤§ï¼Œåè´¦çš„å¯èƒ½æ€§è¶Šä½ï¼›é€¾æœŸç¬”æ•°è¶Šå¤šï¼Œåè´¦å¯èƒ½æ€§è¶Šé«˜ï¼Œå¾—åˆ†è¶Šé«˜ï¼›æœ€åå°†æ‰€æœ‰çš„å˜é‡å¯¹åº”çš„å¾—åˆ†ç›¸åŠ ï¼Œå°±æ˜¯æ¯ä¸ªç”¨æˆ·çš„å¾—åˆ†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç”µé¥­ç…²å‰çƒ§</title>
    <link href="/%E7%94%B5%E9%A5%AD%E7%85%B2%E5%8F%89%E7%83%A7.html"/>
    <url>/%E7%94%B5%E9%A5%AD%E7%85%B2%E5%8F%89%E7%83%A7.html</url>
    
    <content type="html"><![CDATA[<h1 id="ç”µé¥­ç…²å‰çƒ§">ç”µé¥­ç…²å‰çƒ§</h1><p><ahref="https://www.bilibili.com/video/BV1yV4y187H9">https://www.bilibili.com/video/BV1yV4y187H9</a></p><h3 id="å‡†å¤‡æ¢…èŠ±è‚‰">å‡†å¤‡æ¢…èŠ±è‚‰</h3><blockquote><p>å¯ä»¥ç”¨äº”èŠ±è‚‰æ›¿ä»£</p></blockquote><figure><img src="https://image.yinan.fun/202308061129526.png"alt="ä¸€æ–¤äºŒä¸¤æ¢…èŠ±è‚‰" /><figcaption aria-hidden="true">ä¸€æ–¤äºŒä¸¤æ¢…èŠ±è‚‰</figcaption></figure><h3 id="æœ‰ç‚¹åšç”¨ç‰™ç­¾æ‰æ‰å­”">æœ‰ç‚¹åšï¼Œç”¨ç‰™ç­¾æ‰æ‰å­”</h3><blockquote><p>è…Œçš„æ—¶å€™åˆ‡å‡ å¤§å—ï¼Œç„¶åç”¨å‰å­æ­£åæ’çŒªè‚‰ï¼Œè¿™æ ·æ›´èƒ½å…¥å‘³</p></blockquote><figure><img src="https://image.yinan.fun/202308061107984.png"alt="image-20230806110717962" /><figcaption aria-hidden="true">image-20230806110717962</figcaption></figure><h3 id="è…Œåˆ¶è‚‰">è…Œåˆ¶è‚‰</h3><blockquote><p>èœ‚èœœå¯ä»¥ç”¨å†°ç³–æ›¿ä»£</p></blockquote><figure><img src="https://image.yinan.fun/202308061110146.png"alt="image-20230806111004086" /><figcaption aria-hidden="true">image-20230806111004086</figcaption></figure><figure><img src="https://image.yinan.fun/202308061129621.png"alt="image-20230806110857406" /><figcaption aria-hidden="true">image-20230806110857406</figcaption></figure><h3id="å¥—ä¸Šè¢‹å­æ”¾å†°ç®±å†·è—è…Œåˆ¶ä¸‰ä¸ªå°æ—¶ä»¥ä¸Š">å¥—ä¸Šè¢‹å­ï¼Œæ”¾å†°ç®±å†·è—è…Œåˆ¶ä¸‰ä¸ªå°æ—¶ä»¥ä¸Š</h3><blockquote><p>æœ€å¥½è¿‡å¤œè…Œåˆ¶</p></blockquote><figure><img src="https://image.yinan.fun/202308061129764.png"alt="image-20230806111136504" /><figcaption aria-hidden="true">image-20230806111136504</figcaption></figure><h3id="ç¬¬äºŒå¤©å…¨éƒ¨å€’å…¥ç”µé¥­ç…²æŒ‰ç…®é¥­é”®">ç¬¬äºŒå¤©å…¨éƒ¨å€’å…¥ç”µé¥­ç…²ï¼ŒæŒ‰ç…®é¥­é”®</h3><blockquote><p>ç”µé¥­é”…å°±ä¸ç”¨åŠ æ°´äº†ï¼Œä¸ç²˜é”…ä¹Ÿä¸åŠ æ°´ï¼Œé“é”…è¦åŠ ä¸€äº›æ°´çš„ã€‚</p><p>æ™®é€šç”µé¥­é”…ç›´æ¥ç…®é¥­é”®æ¨¡å¼å°±è¡Œäº†ï¼å¦‚æœåˆ‡çš„åšï¼Œç…®é¥­é”®ç»“æŸï¼Œä½ çœ‹ç€æ²¡ç†Ÿï¼Œå¯ä»¥å†ç…®ä¸€ä¼šã€‚ä¸€èˆ¬ç”µé¥­é”…ç…®é¥­é”®éƒ½æ˜¯40åˆ†é’Ÿå§</p></blockquote><figure><img src="https://image.yinan.fun/202308061129019.png"alt="image-20230806111235934" /><figcaption aria-hidden="true">image-20230806111235934</figcaption></figure><h3 id="æ—¶é—´åˆ°æ”¾å…¥é”…é‡Œæ”¶æ±">æ—¶é—´åˆ°æ”¾å…¥é”…é‡Œæ”¶æ±</h3><figure><img src="https://image.yinan.fun/202308061129554.png"alt="image-20230806111421930" /><figcaption aria-hidden="true">image-20230806111421930</figcaption></figure><h3 id="ä¸æ–­ç”¨å‹ºå­å¾€å‰çƒ§ä¸Šæ·‹æ±">ä¸æ–­ç”¨å‹ºå­å¾€å‰çƒ§ä¸Šæ·‹æ±</h3><figure><img src="https://image.yinan.fun/202308061129739.png"alt="image-20230806111536851" /><figcaption aria-hidden="true">image-20230806111536851</figcaption></figure><h3 id="æ”¶åˆ°æµ“ç¨ æŒ‚æ±çš„çŠ¶æ€">æ”¶åˆ°æµ“ç¨ æŒ‚æ±çš„çŠ¶æ€</h3><figure><img src="https://image.yinan.fun/202308061129948.png"alt="image-20230806111701219" /><figcaption aria-hidden="true">image-20230806111701219</figcaption></figure><h3 id="æ–œåˆ€åˆ‡">æ–œåˆ€åˆ‡</h3><blockquote><p>å°½é‡è–„ä¸€ç‚¹</p></blockquote><figure><img src="https://image.yinan.fun/202308061129154.png"alt="image-20230806111848910" /><figcaption aria-hidden="true">image-20230806111848910</figcaption></figure><h3 id="è£…ç›˜">è£…ç›˜</h3><figure><img src="https://image.yinan.fun/202308061129908.png"alt="image-20230806112715143" /><figcaption aria-hidden="true">image-20230806112715143</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>åƒçš„</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç”µé¥­ç…²</tag>
      
      <tag>è‚‰</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¦‚ç‡è¯„åˆ†æ–¹æ³•</title>
    <link href="/%E6%A6%82%E7%8E%87%E8%AF%84%E5%88%86%E6%96%B9%E6%B3%95.html"/>
    <url>/%E6%A6%82%E7%8E%87%E8%AF%84%E5%88%86%E6%96%B9%E6%B3%95.html</url>
    
    <content type="html"><![CDATA[<h1 id="æ¦‚ç‡è¯„åˆ†æ–¹æ³•">æ¦‚ç‡è¯„åˆ†æ–¹æ³•</h1><p>ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>è¯„ä¼°é¢„æµ‹æ¦‚ç‡å‡†ç¡®æ€§</strong>çš„æ–¹æ³•è¢«ç§°ä¸ºè¯„åˆ†è§„åˆ™æˆ–è¯„åˆ†å‡½æ•°ã€‚ä¸‹é¢å°†ä»‹ç»ä¸‰ç§è¯„åˆ†æ–¹æ³•ï¼Œå¯ç”¨äºè¯„ä¼°<strong>åˆ†ç±»é¢„æµ‹å»ºæ¨¡</strong>é—®é¢˜çš„é¢„æµ‹æ¦‚ç‡ã€‚</p><h2 id="log-loss-score">Log Loss Score</h2><p>Log loss, also called â€œlogistic loss,â€ â€œlogarithmic loss,â€ or â€œcrossentropyâ€ can be used as a measure for evaluating predictedprobabilities.</p><p>å°†æ¯ä¸ªé¢„æµ‹æ¦‚ç‡ä¸å®é™…ç±»è¾“å‡ºå€¼ï¼ˆ0æˆ–1ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶è®¡ç®—å‡ºä¸€ä¸ªåˆ†æ•°ï¼Œè¯¥åˆ†æ•°æ ¹æ®ä¸é¢„æœŸå€¼çš„è·ç¦»æ¥æƒ©ç½šæ¦‚ç‡ã€‚æƒ©ç½šæ˜¯å¯¹æ•°çš„ï¼Œå°å·®å¼‚çš„åˆ†æ•°å°å’Œå¤§å·®å¼‚çš„åˆ†æ•°å¤§ã€‚</p><p>å¯¹äºå¸¦æœ‰çœŸå®æ ‡ç­¾çš„å•ä¸ªæ ·å“ <span class="math inline">\(y \in\{0,1\}\)</span> å’Œæ¦‚ç‡ä¼°è®¡ <span class="math inline">\(p =\operatorname{Pr}(y = 1)\)</span>, log loss æ˜¯ï¼š <spanclass="math display">\[L_{\log}(y, p) = -(y \log (p) + (1 - y) \log (1 - p))\]</span></p><figure><img src="https://image.yinan.fun/202308051604385.png"alt="Log losså›¾åƒ" /><figcaption aria-hidden="true">Log losså›¾åƒ</figcaption></figure><h3 id="ç¼ºç‚¹">ç¼ºç‚¹</h3><p>Loglossçš„ç»“æœå¯¹æ•°æ®é›†å–å¹³å‡ï¼Œåœ¨å¹³è¡¡æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œåˆ†æ•°å°†æ˜¯åˆé€‚çš„ï¼Œåœ¨ä¸å¹³è¡¡æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œåˆ†æ•°å°†å…·æœ‰è¯¯å¯¼æ€§ã€‚</p><p>å¹³è¡¡æ•°æ®é›†Log Lossé¢„æµ‹çš„æŠ˜çº¿å›¾</p><figure><img src="https://image.yinan.fun/202308051604968.png"alt="å¹³è¡¡æ•°æ®é›†Log Lossé¢„æµ‹çš„æŠ˜çº¿å›¾" /><figcaption aria-hidden="true">å¹³è¡¡æ•°æ®é›†LogLossé¢„æµ‹çš„æŠ˜çº¿å›¾</figcaption></figure><p>ä¸å¹³è¡¡æ•°æ®é›†ï¼ˆ0å¤šï¼‰Log Lossé¢„æµ‹çš„æŠ˜çº¿å›¾</p><figure><img src="https://image.yinan.fun/202308051604640.png"alt="ä¸å¹³è¡¡æ•°æ®é›†Log Lossé¢„æµ‹çš„æŠ˜çº¿å›¾" /><figcaption aria-hidden="true">ä¸å¹³è¡¡æ•°æ®é›†LogLossé¢„æµ‹çš„æŠ˜çº¿å›¾</figcaption></figure><h3 id="å®ç°">å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">sklearn.metrics.log_loss(y_true, y_pred, *, eps=<span class="hljs-string">&#x27;auto&#x27;</span>, normalize=<span class="hljs-literal">True</span>, sample_weight=<span class="hljs-literal">None</span>, labels=<span class="hljs-literal">None</span>)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.log_loss.html</a></p><h2 id="brier-score">Brier Score</h2><p>BrierScoreè¡¡é‡çš„æ˜¯é¢„æµ‹æ¦‚ç‡å’Œå®é™…ç»“æœä¹‹é—´çš„<strong>å‡æ–¹å·®</strong>ã€‚åˆ†æ•°æ±‡æ€»äº†æ¦‚ç‡é¢„æµ‹ä¸­è¯¯å·®çš„å¤§å°ã€‚é”™è¯¯åˆ†æ•°å§‹ç»ˆåœ¨0.0å’Œ1.0ä¹‹é—´ï¼Œå…¶ä¸­å®Œç¾çš„æ¨¡å‹çš„åˆ†æ•°ä¸º0ã€‚</p><figure><img src="https://image.yinan.fun/202308051604434.png"alt="Brier Scoreå›¾åƒ" /><figcaption aria-hidden="true">Brier Scoreå›¾åƒ</figcaption></figure><h3 id="å®ç°-1">å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">sklearn.metrics.brier_score_loss(y_true, y_prob, *, sample_weight=<span class="hljs-literal">None</span>, pos_label=<span class="hljs-literal">None</span>)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.brier_score_loss.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.brier_score_loss.html</a></p><p>ä¸Log lossä¸€æ ·ï¼Œåœ¨ä¸å¹³è¡¡æ•°æ®é›†çš„æƒ…å†µä¸‹ï¼Œåˆ†æ•°å°†å…·æœ‰è¯¯å¯¼æ€§ã€‚</p><h2 id="roc-auc-score">ROC AUC Score</h2><p>ROCï¼ˆReceiver OperatingCharacteristicï¼‰æ›²çº¿æ˜¯ä¸€ç§ç”¨äºè¡¨ç¤ºåˆ†ç±»æ¨¡å‹æ€§èƒ½çš„å›¾å½¢å·¥å…·ã€‚å®ƒé€šè¿‡å°†<strong>çœŸé˜³æ€§ç‡ï¼ˆTruePositive Rateï¼ŒTPRï¼‰</strong>å’Œ<strong>å‡é˜³æ€§ç‡ï¼ˆFalse PositiveRateï¼ŒFPRï¼‰</strong>ä½œä¸ºæ¨ªçºµåæ ‡æ¥æç»˜åˆ†ç±»å™¨åœ¨<strong>ä¸åŒé˜ˆå€¼</strong>ä¸‹çš„æ€§èƒ½ã€‚</p><blockquote><p>çœŸé˜³æ€§ç‡ï¼ˆTrue PositiveRateï¼ŒTPRï¼‰æ˜¯æŒ‡åˆ†ç±»å™¨æ­£ç¡®è¯†åˆ«æ­£ä¾‹çš„èƒ½åŠ›ï¼Œå¯ä»¥ç†è§£ä¸ºæ‰€æœ‰é˜³æ€§ç¾¤ä½“ä¸­è¢«æ£€æµ‹å‡ºæ¥çš„æ¯”ç‡ï¼ŒTPRè¶Šæ¥è¿‘1è¶Šå¥½ã€‚</p><p>å‡é˜³æ€§ç‡ï¼ˆFalse PositiveRateï¼ŒFPRï¼‰æ˜¯æŒ‡åœ¨æ‰€æœ‰å®é™…ä¸ºè´Ÿä¾‹çš„æ ·æœ¬ä¸­ï¼Œæ¨¡å‹é”™è¯¯åœ°é¢„æµ‹ä¸ºæ­£ä¾‹çš„æ ·æœ¬æ¯”ä¾‹ï¼ŒFPRè¶Šæ¥è¿‘0è¶Šå¥½ã€‚</p></blockquote><p><span class="math display">\[TPR=\frac{TP}{P}=\frac{TP}{TP+FN}\]</span></p><p><span class="math display">\[FPR=\frac{FP}{N}=\frac{FP}{FP+TN}\]</span></p><figure><img src="https://image.yinan.fun/202308051604179.png"alt="æ··æ·†çŸ©é˜µå›¾" /><figcaption aria-hidden="true">æ··æ·†çŸ©é˜µå›¾</figcaption></figure><figure><img src="https://image.yinan.fun/202308051624977.png" alt="ROCæ›²çº¿" /><figcaption aria-hidden="true">ROCæ›²çº¿</figcaption></figure><p><code>sklearn</code> <code>LogisticRegression</code> çš„ROCæ›²çº¿ï¼š</p><figure><img src="https://image.yinan.fun/202308051604070.png"alt="LogisticRegressionçš„ROCæ›²çº¿" /><figcaption aria-hidden="true">LogisticRegressionçš„ROCæ›²çº¿</figcaption></figure><p>AUCï¼ˆArea Under rocCurveï¼‰æ˜¯<strong>ROCæ›²çº¿ä¸‹çš„é¢ç§¯</strong>ï¼Œç”¨äºè¡¡é‡åˆ†ç±»å™¨æ€§èƒ½ã€‚AUCå€¼è¶Šæ¥è¿‘1ï¼Œè¡¨ç¤ºåˆ†ç±»å™¨æ€§èƒ½è¶Šå¥½ï¼›åä¹‹ï¼ŒAUCå€¼è¶Šæ¥è¿‘0ï¼Œè¡¨ç¤ºåˆ†ç±»å™¨æ€§èƒ½è¶Šå·®ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸é€šè¿‡è®¡ç®—AUCå€¼æ¥è¯„ä¼°åˆ†ç±»å™¨çš„æ€§èƒ½ã€‚</p><p>ROCæ›²çº¿å›´æˆçš„é¢ç§¯(å³AUC)å¯ä»¥è§£è¯»ä¸ºï¼šä»æ‰€æœ‰æ­£ä¾‹ä¸­éšæœºé€‰å–ä¸€ä¸ªæ ·æœ¬Aï¼Œå†ä»æ‰€æœ‰è´Ÿä¾‹ä¸­éšæœºé€‰å–ä¸€ä¸ªæ ·æœ¬Bï¼Œåˆ†ç±»å™¨å°†Aåˆ¤ä¸ºæ­£ä¾‹çš„æ¦‚ç‡æ¯”å°†Båˆ¤ä¸ºæ­£ä¾‹çš„æ¦‚ç‡å¤§çš„å¯èƒ½æ€§ã€‚</p><blockquote><p><strong>AUCçš„ä¸€èˆ¬åˆ¤æ–­æ ‡å‡†ï¼š</strong></p><p>0.5 - 0.7ï¼šæ•ˆæœè¾ƒä½ï¼Œä½†ç”¨äºé¢„æµ‹è‚¡ç¥¨å·²ç»å¾ˆä¸é”™äº†</p><p>0.7 - 0.85ï¼šæ•ˆæœä¸€èˆ¬</p><p>0.85 - 0.95ï¼šæ•ˆæœå¾ˆå¥½</p><p>0.95 - 1ï¼šæ•ˆæœéå¸¸å¥½ï¼Œä½†ä¸€èˆ¬ä¸å¤ªå¯èƒ½</p></blockquote><h3 id="ä¼˜ç‚¹">ä¼˜ç‚¹</h3><p>TPRç”¨åˆ°çš„TPå’ŒFNåŒå±Påˆ—ï¼ŒFPRç”¨åˆ°çš„FPå’ŒTNåŒå±Nåˆ—ï¼Œæ‰€ä»¥å³ä½¿Pæˆ–Nçš„æ•´ä½“æ•°é‡å‘ç”Ÿäº†æ”¹å˜ï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°å¦ä¸€åˆ—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æ­£ä¾‹ä¸è´Ÿä¾‹çš„æ¯”ä¾‹å‘ç”Ÿäº†å¾ˆå¤§å˜åŒ–ï¼ŒROCæ›²çº¿ä¹Ÿä¸ä¼šäº§ç”Ÿå¤§çš„å˜åŒ–ï¼Œè€ŒåƒPrecisionä½¿ç”¨çš„TPå’ŒFPå°±åˆ†å±ä¸¤åˆ—ï¼Œåˆ™æ˜“å—ç±»åˆ«åˆ†å¸ƒæ”¹å˜çš„å½±å“ã€‚</p><h3 id="ç¼ºç‚¹-1">ç¼ºç‚¹</h3><p>åœ¨ç±»åˆ«ä¸å¹³è¡¡çš„èƒŒæ™¯ä¸‹ï¼Œè´Ÿä¾‹çš„æ•°ç›®ä¼—å¤šè‡´ä½¿FPRçš„å¢é•¿ä¸æ˜æ˜¾ï¼ŒROCæ›²çº¿çš„æ¨ªè½´é‡‡ç”¨FPRï¼Œæ ¹æ®<spanclass="math inline">\(FPR=\frac{FP}{N}=\frac{FP}{FP+TN}\)</span>ï¼Œå½“è´Ÿä¾‹Nçš„æ•°é‡è¿œè¶…æ­£ä¾‹Pæ—¶ï¼ŒFPçš„å¤§å¹…å¢é•¿åªèƒ½æ¢æ¥FPRçš„å¾®å°æ”¹å˜ã€‚ç»“æœæ˜¯è™½ç„¶å¤§é‡è´Ÿä¾‹è¢«é”™åˆ¤æˆæ­£ä¾‹ï¼Œåœ¨ROCæ›²çº¿ä¸Šå´æ— æ³•ç›´è§‚åœ°çœ‹å‡ºæ¥ã€‚</p><h3 id="å®ç°-2">å®ç°</h3><ol type="1"><li><p><code>roc_curve</code>å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">fpr, tpr, thresholds = sklearn.metrics.roc_curve(y_true, y_score)<br>pyplot.plot(fpr, tpr)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html</a></p></li><li><p><code>roc_auc_score</code>å‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">auc_score = sklearn.metrics.roc_auc_score(y_true, y_score)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html</a></p></li></ol><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><ol type="1"><li>https://machinelearningmastery.com/how-to-score-probability-predictions-in-python/</li><li>https://zhuanlan.zhihu.com/p/616190701</li><li>https://zhuanlan.zhihu.com/p/352271971</li><li>https://zhuanlan.zhihu.com/p/34655990</li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LRçš„é¢„æµ‹æ¦‚ç‡å€¼è½¬åˆ†æ•°</title>
    <link href="/LR%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A6%82%E7%8E%87%E5%80%BC%E8%BD%AC%E5%88%86%E6%95%B0.html"/>
    <url>/LR%E7%9A%84%E9%A2%84%E6%B5%8B%E6%A6%82%E7%8E%87%E5%80%BC%E8%BD%AC%E5%88%86%E6%95%B0.html</url>
    
    <content type="html"><![CDATA[<h1 id="lrçš„é¢„æµ‹æ¦‚ç‡å€¼è½¬åˆ†æ•°è¯„åˆ†å¡">LRçš„é¢„æµ‹æ¦‚ç‡å€¼è½¬åˆ†æ•°ï¼ˆè¯„åˆ†å¡ï¼‰</h1><p>èƒŒæ™¯ï¼šåœ¨äº’è”ç½‘é‡‘èä¸­ï¼Œä¸€èˆ¬ç”¨LRæ¨¡å‹æ¥é¢„æµ‹ä¸€ä¸ªå€Ÿè´·ç”¨æˆ·çš„å¥½åï¼Œä½†æ˜¯LRæ¨¡å‹å¾—åˆ°çš„ç»“æœæ˜¯é€¾æœŸçš„æ¦‚ç‡å€¼ï¼Œå¦‚ä½•ä»…ä»…ç»™å‡ºé¢„æµ‹æ¦‚ç‡å€¼ï¼Œäººä¸€èˆ¬å¾ˆéš¾åˆ¤æ–­è¿™ä¸ªæ¦‚ç‡å€¼ä»£è¡¨çš„ç”¨æˆ·è´¨é‡å¥½åï¼Œä½†æ˜¯å¦‚æœèƒ½å¤Ÿç»™å‡ºåˆ†æ•°å°±æ¯”è¾ƒç†è§£äº†ã€‚è€Œæˆ‘ä»¬ä¸€èˆ¬è¦æŠŠé€¾æœŸæ¦‚ç‡è½¬ä¸ºåˆ†æ•°æ¥ä¾›å…¬å¸è¿›è¡Œå†³ç­–ï¼Œé‚£ä¹ˆå¦‚ä½•å°†é€¾æœŸæ¦‚ç‡è½¬åŒ–ä¸ºç”¨æˆ·è´¨é‡çš„å¾—åˆ†ï¼Œä¾‹å¦‚0-100å‘¢ï¼Ÿ</p><h2 id="è¯„åˆ†å¡çš„åˆ†æ•°è½¬åŒ–">è¯„åˆ†å¡çš„åˆ†æ•°è½¬åŒ–</h2><p>é€»è¾‘å›å½’ï¼ˆLogisticRegressionï¼‰æ˜¯ä¸€ç§å› å˜é‡ä¸äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ä¹‹é—´çš„ä¸€ç§æ˜ å°„å…³ç³»ã€‚å…¶ä¸­çš„<strong>p/(1-p)</strong>ï¼Œç§°ä¸º<strong>odds</strong>ï¼Œå³<strong>äº‹ä»¶æˆåŠŸçš„æ¦‚ç‡</strong>é™¤ä»¥<strong>äº‹ä»¶å¤±è´¥çš„æ¦‚ç‡</strong>ã€‚<span class="math display">\[odds=\frac{p}{1-p}\]</span> å¯¹å‡ ç‡å–å¯¹æ•°å¾—åˆ°<strong>å¯¹æ•°å‡ ç‡</strong>(logoddsï¼Œäº¦ç§°logit)ï¼š <span class="math display">\[log\frac{p}{1-p}=\omega^Tx+b\]</span></p><blockquote><p><span class="math display">\[y=\frac{1}{1+e^{-(w^{\rm{T}}x+b)}}\]</span></p><p><span class="math display">\[\ln \frac{y}{1-y}=w^{\rm{T}}x+b\]</span></p></blockquote><p><span class="math display">\[Score=A+B\times\ln(odds)\]</span></p><p>è®¾å®šå½“æ¯å¢åŠ 1å€æ—¶ï¼Œå¢åŠ çš„åˆ†æ•°PDOï¼ˆpoint of doubleoddsï¼‰ï¼Œå³æ¯”ç‡ç¿»ç•ªçš„å€æ•° <span class="math display">\[Score+PDO=A+B\times\ln(2odds)\]</span></p><h2 id="æ±‚è§£aå’Œb">æ±‚è§£Aå’ŒB</h2><p>è¦ç®—å‡ºç³»æ•°Aã€Bçš„è¯ï¼Œéœ€è¦ä»ä¸šåŠ¡è§’åº¦å…ˆé¢„è®¾ä¸¤ä¸ªå‰ææ¡ä»¶ï¼š</p><ol type="1"><li>åœ¨æŸä¸ªç‰¹å®šçš„æ¯”ç‡<spanclass="math inline">\(\theta_0\)</span>è®¾å®šç‰¹å®šçš„é¢„æœŸåˆ†å€¼<spanclass="math inline">\(S_0\)</span></li><li>æŒ‡å®šæ¯”ç‡ç¿»ç•ªæ—¶åˆ†æ•°çš„å˜åŠ¨å€¼ï¼ˆPDOï¼‰</li></ol><blockquote><p>è§£é‡Šï¼š</p><ol type="1"><li>æ¯”å¦‚æ ¹æ®ä¸šåŠ¡ç»éªŒï¼Œæ¶ˆè´¹é‡‘èä¿¡è´·çš„å®¢æˆ·è¿çº¦ç‡4.8%ç®—æ­£å¸¸ï¼ˆ<spanclass="math inline">\(\theta_0=Odds=5\%\)</span>ï¼‰ã€‚é¢„è®¾è¯„åˆ†å¡çš„åˆ†å€¼ä¸º0-100åˆ†ï¼Œé‚£å–é¢„æœŸåˆ†å€¼<spanclass="math inline">\(S_0\)</span>ä¸º50åˆ†ï¼Œå¹¶æŒ‡å®šå½“OddsæŒ‰åŒå€ä¸Šä¸‹æµ®åŠ¨æ—¶ï¼ˆæ¯”å¦‚2.5%æˆ–10%ï¼‰ï¼Œåˆ†å€¼åˆ™å¯¹åº”ä¸Šä¸‹å˜åŠ¨10åˆ†ï¼ˆæ¯”å¦‚60åˆ†æˆ–40åˆ†ï¼‰ã€‚</li><li>è¿™é‡Œ<spanclass="math inline">\(\theta_0=5\%\)</span>æ˜¯æ ¹æ®ä¸šåŠ¡ç»éªŒæ¥çš„ï¼Œæ²¡æœ‰æ•°å­¦ä¾æ®ï¼›</li><li>0-100åˆ†æ˜¯æ ¹æ®åšè¯„åˆ†å¡çš„éœ€è¦æ¥çš„ï¼Œæ²¡æœ‰æ•°å­¦ä¾æ®ã€‚è¦æ˜¯æƒ³åšæˆ600-1000åˆ†çš„è¯„åˆ†å¡ä¹Ÿå¯ä»¥ï¼Œä¿®æ”¹å¯¹åº”çš„<spanclass="math inline">\(S_0\)</span>å’ŒPDOå°±è¡Œï¼›</li><li><spanclass="math inline">\(S_0=50\)</span>åˆ†æ˜¯æ ¹æ®0-100åˆ†æ¥çš„ï¼Œä¹Ÿå¯ä»¥å–45åˆ†æˆ–73åˆ†ï¼Œä¸é‡è¦ã€‚é‡è¦çš„æ˜¯éšç€Oddsç¿»ç•ªå˜åŠ¨æ—¶ï¼Œåˆ†æ•°ä¹Ÿéšä¹‹å˜åŠ¨çš„è”åŠ¨å˜åŒ–ä½“ç³»ï¼ˆä½ ç¿»ç•ªæˆ‘å°±å˜PDO=10åˆ†ï¼‰</li></ol></blockquote><p><span class="math display">\[B = PDO/ln(2)\]</span></p><p><span class="math display">\[A = S_0-PDO*ln(\theta_0)/ln(2)\]</span></p><h2 id="è¯„åˆ†å¡çš„å¥½å¤„">è¯„åˆ†å¡çš„å¥½å¤„</h2><p>è¯„åˆ†å¡ä¸ä½¿ç”¨æ¦‚ç‡è½¬æ¢åˆ†æ•°ï¼Œè€Œæ˜¯ç”¨çº¿æ€§éƒ¨åˆ†è½¬æ¢æˆåˆ†æ•°ï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ¯ä¸€ä¸ªç‰¹å¾<spanclass="math inline">\(x\)</span>çš„åˆ†æ•°å’Œå°±æ˜¯æ€»åˆ†ï¼Œè€Œå¦‚æœç”¨æ¦‚ç‡è½¬åˆ†ï¼Œåˆ™å•ä¸ªç‰¹å¾å¢åŠ såˆ†ï¼Œæ€»åˆ†å¹¶ä¸å¢åŠ såˆ†ã€‚<span class="math display">\[\begin{align}Score&amp;=A+B\times\ln(odds) \\&amp;=A+B\times(\omega_0+\omega_1x_1+\cdots+\omega_nx_x)\\&amp;=(A+B\omega_0)+B\omega_1x_1+\cdots+B\omega_nx_x\end{align}\]</span> <spanclass="math inline">\((A+B\omega_0)\)</span>æ˜¯åŸºç¡€åˆ†æ•°ï¼Œ<spanclass="math inline">\(B\omega_1x_1,\cdots,B\omega_nx_x\)</span>æ˜¯æ¯ä¸ªå˜é‡å¯¹åº”åˆ†é…çš„åˆ†æ•°ï¼Œæ±‚å’Œå¾—åˆ°æ€»åˆ†æ•°ã€‚</p><h2 id="åˆ†ç®±">åˆ†ç®±</h2><p>å¦‚æœä¹‹å‰æ­¥éª¤ä¸­æ¯ä¸ªå˜é‡éƒ½æœ‰è¿›è¡Œåˆ†ç®±æ“ä½œï¼Œå°±æŠŠæ¯ä¸ªå˜é‡å¯¹åº”çš„åˆ†æ•°ï¼Œåˆ†åˆ«ä¹˜ä»¥å˜é‡ä¸­æ¯ä¸ªåˆ†ç®±çš„WOEï¼Œå¾—åˆ°æ¯ä¸ªåˆ†ç®±çš„è¯„åˆ†ç»“æœã€‚</p><blockquote><p>WOEï¼ˆWeight ofEvidenceï¼‰å³è¯æ®æƒé‡ï¼Œå¯ä»¥å°†logisticå›å½’æ¨¡å‹è½¬åŒ–ä¸ºæ ‡å‡†è¯„åˆ†å¡æ ¼å¼ï¼ŒWOEæ˜¯å¯¹åŸå§‹è‡ªå˜é‡çš„ä¸€ç§ç¼–ç å½¢å¼ï¼Œè¦å¯¹ä¸€ä¸ªå˜é‡è¿›è¡ŒWOEç¼–ç ï¼Œéœ€è¦é¦–å…ˆæŠŠè¿™ä¸ªå˜é‡è¿›è¡Œåˆ†ç»„å¤„ç†ï¼ˆä¹Ÿå«ç¦»æ•£åŒ–ã€åˆ†ç®±ï¼‰ã€‚WOE=ln(åæ ·æœ¬å æ¯”/å¥½æ ·æœ¬å æ¯”)<span class="math display">\[WOE_i=\ln(\frac{Bad_{X=X_i}/Bad_{tatol}}{Good_{X=X_i}/Good_{tatol}})\]</span></p></blockquote><figure><img src="https://image.yinan.fun/202308271006692.png" alt="è¯„åˆ†å¡" /><figcaption aria-hidden="true">è¯„åˆ†å¡</figcaption></figure><p>ä»¥ä¸Šæ­¥éª¤éƒ½å®Œæˆåï¼Œå‡å¦‚æ–°äº§ç”Ÿä¸€ä¸ªæ–°æ ·æœ¬ï¼Œæˆ‘ä»¬åªéœ€å°†æ­¤ç”¨æˆ·æ¯ä¸ªå˜é‡å¯¹åº”åˆ°å„åˆ†ç®±ä¸­å¾—åˆ°å…¶å¯¹åº”çš„WOEå€¼ï¼Œå†æ ¹æ®ä¸Šé¢çš„å…¬å¼è®¡ç®—å‡ºè¿™ä¸ªæ ·æœ¬åœ¨æ¯ä¸ªå˜é‡ä¸‹çš„åˆ†æ•°ã€‚æœ€åå°†æ‰€æœ‰å˜é‡å¯¹åº”çš„åˆ†æ•°ç›¸åŠ ï¼Œå³ä¸ºæœ€ç»ˆè¯„åˆ†ç»“æœã€‚</p><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><ol type="1"><li>https://blog.csdn.net/sscc_learning/article/details/78591210</li><li>https://www.ngui.cc/el/3600135.html?action=onClick</li></ol>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å›¾åƒè´¨é‡è¯„ä»·æŒ‡æ ‡</title>
    <link href="/%E5%9B%BE%E5%83%8F%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87.html"/>
    <url>/%E5%9B%BE%E5%83%8F%E8%B4%A8%E9%87%8F%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87.html</url>
    
    <content type="html"><![CDATA[<h1 id="å›¾åƒè´¨é‡è¯„ä»·æŒ‡æ ‡">å›¾åƒè´¨é‡è¯„ä»·æŒ‡æ ‡</h1><p>å›¾åƒè´¨é‡è¯„ä»·æŒ‡æ ‡çš„æœ€å¸¸è§åˆ†ç±»æ˜¯é€šè¿‡å‚è€ƒå›¾åƒçš„å¯ç”¨æ€§ï¼Œå³å…¨å‚è€ƒï¼ˆfull-reference,FRï¼‰ã€å‡å°‘å‚è€ƒï¼ˆreduced-reference, RRï¼‰å’Œæ— å‚è€ƒï¼ˆno-reference,NRï¼‰è´¨é‡åº¦é‡ã€‚FRåº¦é‡è®¡ç®—å¤±çœŸå›¾åƒå’Œå‚è€ƒå›¾åƒä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå½“å‚è€ƒå›¾åƒçš„éƒ¨åˆ†ä¿¡æ¯å¯ç”¨æ—¶åº”ç”¨RRåº¦é‡ï¼Œè€ŒNRåº¦é‡åˆ©ç”¨å›¾åƒç»Ÿè®¡æ¥è¯„ä¼°å›¾åƒè´¨é‡ï¼Œå› ä¸ºå‚è€ƒå›¾åƒçš„ä¿¡æ¯å®Œå…¨ä¸å¯ç”¨ã€‚</p><figure><img src="https://image.yinan.fun/image-20230724182132014.png"alt="Representative FR and RR IQA methods" /><figcaption aria-hidden="true">Representative FR and RR IQAmethods</figcaption></figure><h2 id="psnr-peak-signal-to-noise-ratio-å³°å€¼ä¿¡å™ªæ¯”">1. PSNR (PeakSignal-to-Noise Ratio) å³°å€¼ä¿¡å™ªæ¯”</h2><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º<span class="math inline">\(m\timesn\)</span>çš„å¹²å‡€å›¾åƒå’Œå™ªå£°å›¾åƒï¼Œ<strong>å‡æ–¹è¯¯å·®(MSE)</strong>å®šä¹‰ä¸ºï¼š</p><p><span class="math display">\[MSE=\frac{1}{mn}\sum_{i=0}^{m-1}\sum_{i=0}^{n-1}[I(i,j)-K(i,j)]^2\]</span> ç„¶å<strong>PSNR(dB) </strong> å°±å®šä¹‰ä¸ºï¼š</p><p><span class="math display">\[PSNR=10\times log_{10}(\frac{MAX_I^2}{MSE})\]</span></p><p>å…¶ä¸­<spanclass="math inline">\(MAX_I^2\)</span>ä¸ºå›¾ç‰‡å¯èƒ½çš„æœ€å¤§åƒç´ å€¼ã€‚å¦‚æœæ¯ä¸ªåƒç´ éƒ½ç”±8 ä½äºŒè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆå°±ä¸º255ã€‚é€šå¸¸ï¼Œå¦‚æœåƒç´ å€¼ç”±Bä½äºŒè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œé‚£ä¹ˆ<spanclass="math inline">\(MAX_I^2=2^B-1\)</span>ã€‚</p><p>ä¸€èˆ¬åœ°ï¼Œé’ˆå¯¹ uint8 æ•°æ®ï¼Œæœ€å¤§åƒç´ å€¼ä¸º255,ï¼›é’ˆå¯¹æµ®ç‚¹å‹æ•°æ®ï¼Œæœ€å¤§åƒç´ å€¼ä¸º 1ã€‚</p><p>ä¸Šé¢æ˜¯é’ˆå¯¹ç°åº¦å›¾åƒçš„è®¡ç®—æ–¹æ³•ï¼Œå¦‚æœæ˜¯å½©è‰²å›¾åƒï¼Œé€šå¸¸æœ‰ä¸‰ç§æ–¹æ³•æ¥è®¡ç®—ã€‚</p><ul><li>åˆ†åˆ«è®¡ç®— RGB ä¸‰ä¸ªé€šé“çš„ PSNRï¼Œç„¶åå–å¹³å‡å€¼ã€‚</li><li>è®¡ç®— RGB ä¸‰é€šé“çš„ MSE ï¼Œç„¶åå†é™¤ä»¥ 3 ã€‚</li><li>å°†å›¾ç‰‡è½¬åŒ–ä¸º YCbCr æ ¼å¼ï¼Œç„¶ååªè®¡ç®— Y åˆ†é‡ä¹Ÿå°±æ˜¯äº®åº¦åˆ†é‡çš„PSNRã€‚</li></ul><p>å…¶ä¸­ï¼Œç¬¬äºŒå’Œç¬¬ä¸‰ç§æ–¹æ³•æ¯”è¾ƒå¸¸è§ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># method 1</span><br>diff = im1 - im2<br>mse = np.mean(np.square(diff))<br>psnr = <span class="hljs-number">10</span> * np.log10(<span class="hljs-number">255</span> * <span class="hljs-number">255</span> / mse)<br><br><span class="hljs-comment"># method 2</span><br><span class="hljs-keyword">from</span> skimage.metrics <span class="hljs-keyword">import</span> structural_similarity <span class="hljs-keyword">as</span> ssim<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment">#è½¬ä¸ºç°åº¦å›¾åƒ</span><br>img1 = Image.<span class="hljs-built_in">open</span>(img1_path).convert(<span class="hljs-string">&#x27;L&#x27;</span>)<br>img2 = Image.<span class="hljs-built_in">open</span>(img2_path).convert(<span class="hljs-string">&#x27;L&#x27;</span>)<br>img2 = img2.resize(img1.size)<br>image_true, image_test = np.array(img1), np.array(img2)<br>psnr = skimage.metrics.peak_signal_noise_ratio(image_true, image_test, *, data_range=<span class="hljs-literal">None</span>)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-image.org/docs/dev/api/skimage.metrics.html#skimage.metrics.peak_signal_noise_ratio">https://scikit-image.org/docs/dev/api/skimage.metrics.html#skimage.metrics.peak_signal_noise_ratio</a></p><ul><li><p>å‚æ•°ï¼š</p><p><code>image_true</code>:ndarrayã€‚Ground-truthå›¾åƒï¼Œä¸im_testå½¢çŠ¶ç›¸åŒ</p><p><code>image_test</code>: ndarrayã€‚æµ‹è¯•å›¾åƒ</p><p><code>data_range</code>: int,optionalã€‚è¾“å…¥å›¾åƒçš„æ•°æ®èŒƒå›´(å¯èƒ½å€¼çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´çš„è·ç¦»)ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ˜¯æ ¹æ®å›¾åƒæ•°æ®ç±»å‹ä¼°è®¡çš„</p></li><li><p>è¿”å›å€¼</p><p><code>psnr</code>: floatã€‚PSNRå€¼åº¦é‡</p></li></ul><p>é’ˆå¯¹è¶…å…‰è°±å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹ä¸åŒæ³¢æ®µåˆ†åˆ«è®¡ç®—PSNRï¼Œç„¶åå–å¹³å‡å€¼ï¼Œè¿™ä¸ªæŒ‡æ ‡ç§°ä¸º MPSNRã€‚</p><p>PSNRç­‰å›¾åƒä¿çœŸåº¦æµ‹é‡æ–¹æ³•è™½ç„¶è¢«å¹¿æ³›é‡‡ç”¨ï¼Œä½†å´æ— æ³•å¾ˆå¥½åœ°åæ˜ è§†è§‰è´¨é‡ã€‚ä¸ºäº†è¿›ä¸€æ­¥æ¥è¿‘äººç±»è§†è§‰ç³»ç»Ÿï¼ˆhumanvisual system, HVSï¼‰çš„è´¨é‡è¯„ä¼°ï¼Œäººä»¬å¼•å…¥äº†ç»“æ„ç›¸ä¼¼æ€§æŒ‡æ•°æµ‹é‡ï¼ˆStructuralsimilarity index measure, SSIMï¼‰ï¼Œåˆ©ç”¨å…¶å¯¹ç»“æ„ä¿¡æ¯å˜åŒ–çš„æ•æ„Ÿæ€§ã€‚</p><h2 id="ssim-structural-similarity-ç»“æ„ç›¸ä¼¼æ€§">2. SSIM (StructuralSIMilarity) ç»“æ„ç›¸ä¼¼æ€§</h2><p>SSIMå…¬å¼åŸºäºæ ·æœ¬xå’Œyä¹‹é—´çš„ä¸‰ä¸ªæ¯”è¾ƒè¡¡é‡ï¼šäº®åº¦ (luminance)ã€å¯¹æ¯”åº¦(contrast) å’Œç»“æ„ (structure)ã€‚</p><p><span class="math display">\[l(x,y)=\frac{2\mu_x\mu_y+c_1}{\mu_x^2+\mu_y^2+c_1}\\c(x,y)=\frac{2\sigma_x\sigma_y+c_2}{\sigma_x^2+\sigma_y^2+c_2}\\s(x,y)=\frac{2\sigma_{xy}+c_3}{\sigma_x\sigma_y+c_3}\\\]</span></p><p>ä¸€èˆ¬å–<span class="math inline">\(c_3=c_2/2\)</span>ã€‚</p><ul><li><span class="math inline">\(\mu_x\)</span>ä¸ºxå‡å€¼ï¼Œ<spanclass="math inline">\(\sigma_x\)</span>ä¸ºxæ–¹å·®ï¼Œ<spanclass="math inline">\(\sigma_{xy}\)</span>ä¸ºxå’Œyçš„åæ–¹å·®</li><li><span class="math inline">\(c_1=(k_1L)^2\)</span>,<spanclass="math inline">\(c_2=(k_2L)^2\)</span>ä¸ºä¸¤ä¸ªå¸¸æ•°ï¼Œé¿å…é™¤é›¶</li><li>Lä¸ºåƒç´ å€¼çš„èŒƒå›´ï¼Œ<span class="math inline">\(L=2^B-1\)</span></li><li><span class="math inline">\(k_1=0.01,k_2=0.03\)</span>ä¸ºé»˜è®¤å€¼</li></ul><p>é‚£ä¹ˆ</p><p><span class="math display">\[SSIM(x,y)=[l(x,y)^\alpha\times c(x,y)^\beta\times s(x,y)^\gamma]\]</span> <spanclass="math inline">\(\alpha,\beta,\gamma\)</span>åˆ†åˆ«ä»£è¡¨äº†ä¸åŒç‰¹å¾åœ¨SSIMè¡¡é‡ä¸­çš„å æ¯”ï¼Œå½“éƒ½ä¸º1æ—¶ï¼Œæœ‰ï¼š<span class="math display">\[SSIM(x,y)=\frac{(2\mu_x\mu_y+c_1)(2\sigma_x\sigma_y+c_2)}{(\mu_x^2+\mu_y^2+c_1)(\sigma_x^2+\sigma_y^2+c_2)}\]</span></p><p>æ¯æ¬¡è®¡ç®—çš„æ—¶å€™éƒ½ä»å›¾ç‰‡ä¸Šå–ä¸€ä¸ª<span class="math inline">\(N\timesN\)</span>çš„çª—å£ï¼Œç„¶åä¸æ–­æ»‘åŠ¨çª—å£è¿›è¡Œè®¡ç®—ï¼Œæœ€åå–å¹³å‡å€¼ä½œä¸ºå…¨å±€çš„SSIMã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">skimage.metrics.structural_similarity(im1, im2, *, win_size=<span class="hljs-literal">None</span>, gradient=<span class="hljs-literal">False</span>, data_range=<span class="hljs-literal">None</span>, <br>                                      channel_axis=<span class="hljs-literal">None</span>, gaussian_weights=<span class="hljs-literal">False</span>, full=<span class="hljs-literal">False</span>, **kwargs)<br></code></pre></td></tr></table></figure><p><ahref="https://scikit-image.org/docs/dev/api/skimage.metrics.html#skimage.metrics.structural_similarity">https://scikit-image.org/docs/dev/api/skimage.metrics.html#skimage.metrics.structural_similarity</a></p><ul><li><p>å‚æ•°ï¼š</p><p><code>im1</code>, <code>im2</code>:ndarrayã€‚ä¸¤ä¸ªå›¾ç‰‡ï¼Œä»»ä½•å…·æœ‰ç›¸åŒå½¢çŠ¶çš„ç»´åº¦ã€‚</p><p><code>win_size</code>: int or None,optionalã€‚ç”¨æ¥æ¯”å¯¹çš„æ»‘åŠ¨çª—å£çš„å˜é•¿ã€‚å¿…é¡»æ˜¯å¥‡æ•°ã€‚å¦‚æœ</p><p><code>gradient</code>: bool,optionalã€‚å¦‚æœä¸ºTrueï¼Œä¹Ÿä¼šè¿”å›ç›¸å¯¹äºim2çš„æ¢¯åº¦</p><p><code>data_range</code>: float,optionalã€‚è¾“å…¥å›¾åƒçš„æ•°æ®èŒƒå›´ï¼ˆæœ€å¤§å’Œæœ€å°å€¼ä¹‹é—´å¯èƒ½çš„è·ç¦»ï¼‰ä½¿ç”¨é»˜è®¤ï¼Œè¿™ä¼šä»å›¾åƒæ•°æ®ç±»å‹ä¸­ä¼°è®¡</p><p><code>channel_axis</code>: int or None,optionalã€‚å¦‚æœä¸ºNoneï¼Œå›¾åƒè¢«å‡å®šä¸ºç°åº¦å›¾ï¼ˆå•é€šé“ï¼‰ï¼Œå¦åˆ™ï¼Œä½¿ç”¨è¯¥å‚æ•°ç´¢å¼•è½´çš„æ•°ç»„å¯¹åº”çš„é€šé“</p><p><code>gaussian_weights</code>: bool,optionalã€‚å¦‚æœä¸ºTrueï¼Œåˆ™æ¯ä¸ªpatchçš„å‡å€¼å’Œæ–¹å·®ç”±å®½åº¦Ïƒ=1.5çš„å½’ä¸€åŒ–é«˜æ–¯æ ¸è¿›è¡Œç©ºé—´åŠ æƒã€‚</p><p><code>full</code>: bool,optionalã€‚å¦‚æœä¸ºTrueï¼Œä¹Ÿè¿”å›å®Œæ•´çš„ç»“æ„ç›¸ä¼¼åº¦å›¾åƒ</p></li><li><p>è¿”å›å€¼</p><p><code>mssim</code>: floatã€‚å›¾åƒä¸Šçš„å¹³å‡ç»“æ„ç›¸ä¼¼åº¦æŒ‡æ•°</p><p><code>grad</code>:ndarrayã€‚im1å’Œim2ä¹‹é—´çš„ç»“æ„ç›¸ä¼¼åº¦æ¢¯åº¦ã€‚è¿™åªåœ¨æ¢¯åº¦è®¾ç½®ä¸ºTrueæ—¶è¿”å›</p><p><code>S</code>:ndarrayã€‚å®Œæ•´çš„SSIMæ˜ åƒã€‚è¿™åªåœ¨fullè®¾ç½®ä¸ºTrueæ—¶è¿”å›</p></li></ul><p>é’ˆå¯¹è¶…å…‰è°±å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦é’ˆå¯¹ä¸åŒæ³¢æ®µåˆ†åˆ«è®¡ç®—SSIMï¼Œç„¶åå–å¹³å‡å€¼ï¼Œè¿™ä¸ªæŒ‡æ ‡ç§°ä¸º MSSIMã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯„ä»·æŒ‡æ ‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äº†è§£Llama</title>
    <link href="/%E4%BA%86%E8%A7%A3Llama.html"/>
    <url>/%E4%BA%86%E8%A7%A3Llama.html</url>
    
    <content type="html"><![CDATA[<h1 id="äº†è§£llama">äº†è§£Llama</h1><p>å®˜ç½‘ï¼š<ahref="https://ai.meta.com/llama/">https://ai.meta.com/llama/</a></p><p>æ–‡ç« ï¼š<ahref="https://ai.meta.com/research/publications/llama-2-open-foundation-and-fine-tuned-chat-models/">https://ai.meta.com/research/publications/llama-2-open-foundation-and-fine-tuned-chat-models/</a></p><h2 id="ä»‹ç»">ä»‹ç»</h2><p>This release includes model weights and starting code for pretrainedand fine-tuned Llama language models â€” ranging from 7B to 70Bparameters(7B, 13B, 70B).</p><p>Llama 2 pretrained models are trained on 2 trillion tokens, and havedouble the context length than Llama 1. Its fine-tuned models have beentrained on over 1 million human annotations.</p><p><strong>Auto-regressive transformers</strong> are<strong>pretrained</strong> on an extensive corpus of self-superviseddata, followed by <strong>alignment</strong> with human preferences viatechniques such as Reinforcement Learning with Human Feedback(RLHF).</p><blockquote><p>Auto-regression is a time series model that <strong>uses observationsfrom previous time steps as input</strong> to a regression equation topredict the value at the next time step</p></blockquote><figure><img src="https://image.yinan.fun/image-20230723111842222.png"alt="AT VS. NAT" /><figcaption aria-hidden="true">AT VS. NAT</figcaption></figure><p>Llama2æ¨¡å‹è®­ç»ƒåŒ…æ‹¬ï¼šé¢„è®­ç»ƒï¼Œæœ‰ç›‘ç£å¾®è°ƒï¼ŒRLHFã€‚</p><figure><img src="https://image.yinan.fun/image-20230721150225425.png"alt="Training of Llama 2-Chat" /><figcaption aria-hidden="true">Training of Llama 2-Chat</figcaption></figure><p>The training methodology is simple, but high computationalrequirements.</p><h2 id="è®­ç»ƒ">è®­ç»ƒ</h2><h3 id="é¢„è®­ç»ƒæ•°æ®">é¢„è®­ç»ƒæ•°æ®</h3><ul><li><p>è®­ç»ƒè¯­æ–™åº“åŒ…æ‹¬æ¥è‡ªå…¬å¼€æ¥æºçš„æ–°æ•°æ®ç»„åˆï¼Œå…¶ä¸­ä¸åŒ…æ‹¬æ¥è‡ª Metaäº§å“æˆ–æœåŠ¡çš„æ•°æ®ã€‚</p></li><li><p>å‰”é™¤æŸäº›å·²çŸ¥åŒ…å«å¤§é‡ä¸ªäººéšç§ä¿¡æ¯çš„ç½‘ç«™çš„æ•°æ®ã€‚</p></li><li><p>åœ¨ 2ä¸‡äº¿ä¸ªtokemçš„æ•°æ®ä¸Šè¿›è¡Œäº†è®­ç»ƒï¼Œå¾ˆå¥½åœ°æƒè¡¡æ€§èƒ½ä¸æˆæœ¬ã€‚</p></li><li><p>å¯¹æœ€çœŸå®çš„æ•°æ®æºè¿›è¡Œä¸Šé‡‡æ ·ï¼Œä»¥å¢åŠ çŸ¥è¯†å’Œå‡å°‘é”™è¯¯ã€‚</p></li></ul><h3 id="è®­ç»ƒç»†èŠ‚">è®­ç»ƒç»†èŠ‚</h3><p>We adopt most of the <strong>pretraining setting and modelarchitecture from Llama 1</strong>. We use the <strong>standardtransformer architecture</strong> (Vaswani et al., 2017), applypre-normalization using <strong>RMSNorm</strong> (Zhang and Sennrich,2019), use the <strong>SwiGLU</strong> activation function (Shazeer,2020), and rotary positional embeddings (RoPE, Su et al. 2022). Theprimary architectural differences from Llama 1 include increased<strong>context length</strong> and <strong>grouped-queryattention</strong> (GQA).</p><blockquote><p>LayerNormæ˜¯å¯¹ç‰¹å¾å¼ é‡æŒ‰ç…§æŸä¸€ç»´åº¦æˆ–æŸå‡ ä¸ªç»´åº¦è¿›è¡Œ0å‡å€¼ï¼Œ1æ–¹å·®çš„å½’ä¸€åŒ–ã€‚RMSNormæ˜¯å¯¹LayerNormçš„ä¸€ä¸ªæ”¹è¿›ï¼Œæ²¡æœ‰åšre-centeræ“ä½œï¼ˆç§»é™¤äº†å…¶ä¸­çš„å‡å€¼é¡¹ï¼‰ã€‚RMSNormä¹Ÿæ˜¯ä¸€ç§æ ‡å‡†åŒ–æ–¹æ³•ï¼Œä½†ä¸ LayerNormä¸åŒï¼Œå®ƒä¸æ˜¯ä½¿ç”¨æ•´ä¸ªæ ·æœ¬çš„å‡å€¼å’Œæ–¹å·®ï¼Œè€Œæ˜¯ä½¿ç”¨å¹³æ–¹æ ¹çš„å‡å€¼æ¥å½’ä¸€åŒ–ï¼Œè¿™æ ·åšå¯ä»¥é™ä½å™ªå£°çš„å½±å“ã€‚</p></blockquote><blockquote><p>æ—‹è½¬å¼ä½ç½®ç¼–ç ï¼ˆRoPEï¼‰æœ€æ—©æ˜¯ä¸€ç§èƒ½å¤Ÿå°†ç›¸å¯¹ä½ç½®ä¿¡æ¯ä¾èµ–é›†æˆåˆ°self-attentionä¸­å¹¶æå‡transformeræ¶æ„æ€§èƒ½çš„ä½ç½®ç¼–ç æ–¹å¼ã€‚</p></blockquote><blockquote><p>GQAï¼ˆGrouped-QueryAttentionï¼‰æ˜¯åˆ†ç»„æŸ¥è¯¢æ³¨æ„åŠ›ï¼ŒGQAå°†æŸ¥è¯¢å¤´åˆ†æˆGç»„ï¼Œæ¯ä¸ªç»„å…±äº«ä¸€ä¸ªKey å’ŒValue çŸ©é˜µã€‚GQA-Gæ˜¯æŒ‡å…·æœ‰Gç»„çš„grouped-queryattentionã€‚å…¶ä¸­å¤šä¸ªæŸ¥è¯¢å¤´å…³æ³¨ç›¸åŒçš„é”®å’Œå€¼å¤´ï¼Œä»¥å‡å°‘æ¨ç†è¿‡ç¨‹ä¸­ KVç¼“å­˜çš„å¤§å°ï¼Œå¹¶å¯ä»¥æ˜¾è‘—æé«˜æ¨ç†ååé‡ã€‚GQA-1å…·æœ‰å•ä¸ªç»„ï¼Œå› æ­¤å…·æœ‰å•ä¸ªKeyå’Œ Valueï¼Œç­‰æ•ˆäºMQAã€‚è€ŒGQA-Hå…·æœ‰ä¸å¤´æ•°ç›¸ç­‰çš„ç»„ï¼Œç­‰æ•ˆäºMHAã€‚</p></blockquote><figure><img src="https://image.yinan.fun/image-20230723112453383.png"alt="Llama 2 family of models" /><figcaption aria-hidden="true">Llama 2 family of models</figcaption></figure><ul><li><p>Hyperparameters</p><p>We trained using the <strong>AdamW optimizer</strong> (Loshchilov andHutter, 2017), with Î²1 = 0.9, Î²2 = 0.95, eps = 10-5. We use a<strong>cosine learning rate schedule</strong>, with warmup of 2000steps, and decay final learning rate down to 10% of the peak learningrate. We use a weight decay of 0.1 and gradient clipping of1.0.</p></li></ul><figure><img src="https://image.yinan.fun/image-20230723115454030.png"alt="Training Loss for Llama 2 models" /><figcaption aria-hidden="true">Training Loss for Llama 2models</figcaption></figure><ul><li><p>Tokenizer</p><p>We use the same tokenizer as Llama 1; it employs a <strong>bytepairencoding</strong> (BPE) algorithm (Sennrich et al., 2016) using theimplementation from SentencePiece (Kudo and Richardson, 2018). As withLlama 1, we split all numbers into individual digits and use bytes todecompose unknown UTF-8 characters. The total vocabulary size is 32ktokens.</p></li><li><p>Llama 2é¢„è®­ç»ƒæ¨¡å‹è¯„ä¼°</p><ul><li>å’Œå¼€æºæ¨¡å‹å¯¹æ¯”ï¼ŒLlama 2æ€§èƒ½æœ€å¥½ã€‚</li></ul><figure><img src="https://image.yinan.fun/image-20230723120200445.png"alt="Overall performance on grouped academic benchmarks compared to open-source base models" /><figcaption aria-hidden="true">Overall performance on grouped academicbenchmarks compared to open-source base models</figcaption></figure><ul><li>å’Œé—­æºæ¨¡å‹å¯¹æ¯”ï¼ŒLlama 2æœ‰å¾ˆå¤§çš„æ€§èƒ½å·®è·ã€‚</li></ul><figure><img src="https://image.yinan.fun/image-20230723120239606.png"alt="Comparison to closed-source models" /><figcaption aria-hidden="true">Comparison to closed-sourcemodels</figcaption></figure></li></ul><h2 id="å¾®è°ƒ">å¾®è°ƒ</h2><p>Llama 2-Chatæ˜¯æ•°æœˆç ”ç©¶å’Œåå¤åº”ç”¨å¯¹é½ï¼ˆalignmentï¼‰æŠ€æœ¯çš„æˆæœï¼ŒåŒ…æ‹¬æŒ‡ä»¤è°ƒæ•´ï¼ˆinstructiontuningï¼‰å’Œ RLHFï¼Œéœ€è¦å¤§é‡çš„è®¡ç®—å’Œæ³¨é‡Šèµ„æºã€‚</p><h3 id="supervised-fine-tuning-sft">Supervised Fine-Tuning (SFT)</h3><ul><li><p>Getting Started</p><p>To bootstrap, we started the SFT stage with <strong>publiclyavailable instruction tuning data</strong> (Chung et al., 2022), asutilized previously in Touvron et al. (2023).</p></li><li><p>Quality Is All You Need</p><p>By setting aside millions of examples from third-party datasets andusing <strong>fewer but higher-quality examples</strong> from our ownvendor-based annotation efforts, our results notably improved.</p></li></ul><p>For the fine-tuning process, each sample consists of a prompt and ananswer. To ensure the model sequence length is properly filled, we<strong>concatenate all the prompts and answers</strong> from thetraining set. A special token is utilized to separate the prompt andanswer segments. We utilize an autoregressive objective and zero-out theloss on tokens from the user prompt, so as a result, we backpropagateonly on answer tokens. Finally, we fine-tune the model for 2 epochs.</p><h3 id="reinforcement-learning-with-human-feedback-rlhf">ReinforcementLearning with Human Feedback (RLHF)</h3><p>RLHF is a model training procedure that is applied to a fine-tunedlanguage model to <strong>further align model behavior with humanpreferences and instruction following</strong>. We collect data thatrepresents empirically sampled human preferences, whereby humanannotators select which of two model outputs they prefer. This humanfeedback is subsequently used to <strong>train a reward model</strong>,which learns patterns in the preferences of the human annotators and canthen automate preference decisions.</p><ul><li><h4 id="human-preference-data-collection">Human Preference DataCollection</h4><p>Our annotation procedure proceeds as follows. We ask annotators tofirst <strong>write a prompt</strong>, then choose between two sampledmodel responses, based on provided criteria. In order to<strong>maximize the diversity</strong>, the two responses to a givenprompt are sampled from two different model variants, and varying thetemperature hyper-parameter. In addition to giving participants a forcedchoice, we also ask annotators to <strong>label the degree</strong> towhich they prefer their chosen response over the alternative: eithertheir choice is significantly better, better, slightly better, ornegligibly better/ unsure.</p><p>For our collection of preference annotations, we focus on<strong>helpfulness and safety</strong>.</p><p>Llama 2-Chat improvement also <strong>shifted the modelâ€™s datadistribution</strong>. Since reward model accuracy can quickly degradeif not exposed to this new sample distribution, i.e., fromhyper-specialization (Scialom et al., 2020b), it is important before anew Llama 2-Chat tuning iteration to <strong>gather new preferencedata</strong> using the latest Llama 2-Chat iterations. This step helpskeep the reward model on-distribution and maintain an accurate rewardfor the latest model.</p></li><li><h4 id="reward-modeling">Reward Modeling</h4><p>The reward model takes a model response and its corresponding prompt(including contexts from previous turns) as inputs and outputs a scalarscore to indicate the quality (e.g., helpfulness and safety) of themodel generation.</p><p>Helpfulness and safety sometimes trade off (Bai et al., 2022a), whichcan make it challenging for a single reward model to perform well onboth. To address this, we train <strong>two separate rewardmodels</strong>, one optimized for helpfulness (referred to asHelpfulness RM) and another for safety (Safety RM).</p><p><strong>Training Objectives</strong> <span class="math display">\[\mathcal{L}_{ranking}=-log(\sigma(r_{\theta}(x,y_c)-r_{\theta}(x,y_r)-m(r)))\]</span> where <span class="math inline">\(r_{\theta}(x,y)\)</span> isthe scalar score output for prompt <spanclass="math inline">\(x\)</span> and completion <spanclass="math inline">\(y\)</span> with model weights <spanclass="math inline">\(\theta\)</span>. <spanclass="math inline">\(y_c\)</span> is the preferred response thatannotators choose and <span class="math inline">\(y_r\)</span> is therejected counterpart. Margin <span class="math inline">\(m(r)\)</span>is a discrete function of the preference rating. Naturally, we use alarge margin for pairs with distinct responses, and a smaller one forthose with similar responses.</p></li><li><h4 id="iterative-fine-tuning">Iterative Fine-Tuning</h4><p>Two main algorithms</p><ul><li><p>Proximal Policy Optimization (PPO) (Schulman et al., 2017), thestandard in RLHF literature.</p><blockquote><p>è¿‘ç«¯ç­–ç•¥ä¼˜åŒ–ï¼ˆproximal policyoptimizationï¼ŒPPOï¼‰ï¼Œé€šè¿‡é‡è¦æ€§é‡‡æ ·æŠŠåŒç­–ç•¥æ¢æˆå¼‚ç­–ç•¥ã€‚</p><p><ahref="https://datawhalechina.github.io/easy-rl/#/chapter5/chapter5">https://datawhalechina.github.io/easy-rl/#/chapter5/chapter5</a></p></blockquote></li><li><p>Rejection Sampling fine-tuning. We <strong>sample Koutputs</strong> from the model and <strong>select the bestcandidate</strong> with our reward. Here, we go one step further, anduse the selected outputs for a <strong>gradient update</strong>. Foreach prompt, the sample obtaining the highest reward score is consideredthe new <strong>gold standard</strong>. Similar to Scialom et al.(2020a), we then fine-tune our model on the new set of ranked samples,reinforcing the reward.</p><blockquote><p>æŒ‘å‡ºåˆ†æ•°æœ€é«˜çš„responseä½œä¸ºtraining targetï¼Œåšsupervised fine-tuning(SFT)ã€‚</p></blockquote><p>We perform rejection <strong>sampling only</strong> with our<strong>largest 70B Llama 2-Chat</strong>. All smaller models are<strong>fine-tuned on rejection sampled data from the largermodel</strong>, thus distilling the large-model capabilities into thesmaller ones.</p></li></ul></li></ul><h2 id="ä½¿ç”¨llama">ä½¿ç”¨Llama</h2><p><ahref="https://huggingface.co/docs/transformers/main/en/model_doc/llama">https://huggingface.co/docs/transformers/main/en/model_doc/llama</a></p><p><ahref="https://huggingface.co/docs/transformers/main/en/model_doc/llama2">https://huggingface.co/docs/transformers/main/en/model_doc/llama2</a></p><ul><li>ä¸‹è½½æ¨¡å‹å‚æ•°ã€‚Weights for the LLaMA models can be obtained from byfilling out <ahref="https://docs.google.com/forms/d/e/1FAIpQLSfqNECQnMkycAp2jP4Z9TFX0cGR4uf7b_fBxjY_OjhJILlKGA/viewform?usp=send_form">thisform</a></li><li>è½¬æ¢ä¸ºHugging Faceæ ¼å¼ã€‚After downloading the weights, they willneed to be converted to the Hugging Face Transformers format using the<ahref="https://github.com/huggingface/transformers/blob/main/src/transformers/models/llama/convert_llama_weights_to_hf.py">conversionscript</a>. The script can be called with the following (example)command:</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">python src/transformers/models/llama/convert_llama_weights_to_hf.py \<br>    --input_dir /path/to/downloaded/llama/weights --model_size 7B --output_dir /output/path<br></code></pre></td></tr></table></figure><ul><li>åŠ è½½æ¨¡å‹å’Œtokenizerã€‚After conversion, the model and tokenizer canbe loaded via:</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> LlamaForCausalLM, LlamaTokenizer<br><br>tokenizer = LlamaTokenizer.from_pretrained(<span class="hljs-string">&quot;/output/path&quot;</span>)<br>model = LlamaForCausalLM.from_pretrained(<span class="hljs-string">&quot;/output/path&quot;</span>)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è°ƒè¯•è¿è¡Œåé©¼æ¨¡å‹</title>
    <link href="/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E5%8D%8E%E9%A9%BC%E6%A8%A1%E5%9E%8B.html"/>
    <url>/%E8%B0%83%E8%AF%95%E8%BF%90%E8%A1%8C%E5%8D%8E%E9%A9%BC%E6%A8%A1%E5%9E%8B.html</url>
    
    <content type="html"><![CDATA[<h1 id="è°ƒè¯•è¿è¡Œåé©¼æ¨¡å‹">è°ƒè¯•è¿è¡Œåé©¼æ¨¡å‹</h1><p>è®ºæ–‡åœ°å€ï¼š<ahref="https://arxiv.org/abs/2304.06975">https://arxiv.org/abs/2304.06975</a></p><p>é¡¹ç›®åœ°å€ï¼š<ahref="https://github.com/SCIR-HI/Huatuo-Llama-Med-Chinese">https://github.com/SCIR-HI/Huatuo-Llama-Med-Chinese</a></p><ul><li><p>è¿è¡Œ<code>infer.py</code>æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">UnicodeDecodeError: <span class="hljs-string">&#x27;gbk&#x27;</span> codec can<span class="hljs-string">&#x27;t decode byte 0xae in position 84: illegal </span><br><span class="hljs-string">multibyte sequence</span><br></code></pre></td></tr></table></figure><p>ä¿®æ”¹<code>prompter.py</code>21è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_name, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> fp:<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹<code>infer.py</code>18è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(instruct_dir, <span class="hljs-string">&quot;r&quot;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br></code></pre></td></tr></table></figure></li><li><p>è¿è¡Œ<code>infer.py</code>æŠ¥é”™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">HFValidationError: Repo <span class="hljs-built_in">id</span> must use alphanumeric chars or <span class="hljs-string">&#x27;-&#x27;</span>, <span class="hljs-string">&#x27;_&#x27;</span>, <span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;--&#x27;</span> <br>and <span class="hljs-string">&#x27;..&#x27;</span> are forbidden, <span class="hljs-string">&#x27;-&#x27;</span> and <span class="hljs-string">&#x27;.&#x27;</span> cannot start or end the name, max length is<br>96: <span class="hljs-string">&#x27;&#x27;</span>.<br></code></pre></td></tr></table></figure><p>å°è¯•ä¸‹è½½æ¨¡å‹å‚æ•°ï¼Œè°ƒç”¨æœ¬åœ°æ¨¡å‹å‚æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">base_model: <span class="hljs-built_in">str</span> = <span class="hljs-string">&quot;./llama-7b-hf&quot;</span>,<br></code></pre></td></tr></table></figure></li><li><p>è¿è¡Œ<code>infer.py</code>æŠ¥é”™ï¼ˆä½¿ç”¨CPUï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">The current device_map had weights offloaded to the disk. Please provide an offload_folder <span class="hljs-keyword">for</span> them. Alternatively, make sure you have safetensors installed <span class="hljs-keyword">if</span> the model you are using offers the weights <span class="hljs-keyword">in</span> this format<br></code></pre></td></tr></table></figure><p><ahref="https://github.com/huggingface/transformers/issues/18698">https://github.com/huggingface/transformers/issues/18698</a>è¿™é‡Œè¯´</p><p>There is no support for using the CPU as a main device in Accelerateyet. If you want to use the model on CPU, just don't specific<code>device_map="auto"</code>.</p><p>å‚æ•°å»æ‰<code>device_map="auto"</code></p></li><li><p>ä¿®æ”¹<code>infer.py</code>13è¡Œï¼ˆä½¿ç”¨CPUï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">device = <span class="hljs-string">&#x27;cuda&#x27;</span> <span class="hljs-keyword">if</span> torch.cuda.is_available() <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;cpu&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>è¿è¡Œ<code>infer.py</code>æŠ¥é”™ï¼ˆä½¿ç”¨CPUï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">RuntimeError: <span class="hljs-string">&quot;addmm_impl_cpu_&quot;</span> not implemented <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;Half&#x27;</span><br></code></pre></td></tr></table></figure><p>CPUæ— æ³•ä½¿ç”¨ <code>fp16</code>ï¼ˆåŠç²¾åº¦ï¼‰ï¼ŒæŠŠ<code>model.half()</code>ï¼Œæ”¹æˆ<code>model.float()</code></p></li><li><p>æœªå¾®è°ƒæ¨¡å‹ç»“æœï¼ˆCPUè·‘äº†ä¸¤ä¸ªå°æ—¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">###infering###</span><br><span class="hljs-comment">###instruction###</span><br>å°å¼ æœ€è¿‘æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡å¼±ã€‚<br><span class="hljs-comment">###golden output###</span><br>å°å¼ å¯èƒ½æ‚£æœ‰å¿ƒè‚Œç‚ï¼Œå»ºè®®è¿›è¡Œå¿ƒç”µå›¾å’Œå¿ƒè„è¶…å£°ç­‰æ£€æŸ¥æ¥ç¡®å®šè¯Šæ–­ã€‚æ²»ç–—æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨æ³¼å°¼æ¾ã€ç”Ÿè„‰é¥®å’Œä¸‰ç£·é…¸è…ºè‹·ç­‰è¯ç‰©ï¼ŒåŒæ—¶å»ºè®®é€‚å½“æ§åˆ¶ä½“æ¸©ï¼Œä¿æŒè‰¯å¥½çš„è¥å…»çŠ¶å†µã€‚<br><span class="hljs-comment">###model output###</span><br>å°å¼ æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡å¼±ã€‚ é—®é¢˜ï¼šå°å¼ æœ€è¿‘æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡å¼±ã€‚ é—®é¢˜ï¼šå°å¼ æœ€è¿‘æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡å¼±ã€‚ é—®é¢˜ï¼šå°å¼ æœ€è¿‘æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡ï¿½ï¿½<br></code></pre></td></tr></table></figure></li><li><p>å¾®è°ƒæ¨¡å‹ç»“æœï¼ˆåŸºäºåŒ»å­¦çŸ¥è¯†åº“å¯¹<code>LLaMA</code>è¿›è¡ŒæŒ‡ä»¤å¾®è°ƒçš„<code>LoRA</code>æƒé‡æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">using lora ./lora-llama-med<br><span class="hljs-comment">###infering###</span><br><span class="hljs-comment">###instruction###</span><br>å°å¼ æœ€è¿‘æ„Ÿè§‰èº«ä½“ä¸é€‚ï¼Œå‡ºç°å¿ƒæ‚¸ã€æ°”ä¿ƒç­‰ç—‡çŠ¶ã€‚ä½“æ£€å‘ç°å¿ƒè„æ‰©å¤§ã€æåŠ¨å‡å¼±ã€‚<br><span class="hljs-comment">###golden output###</span><br>å°å¼ å¯èƒ½æ‚£æœ‰å¿ƒè‚Œç‚ï¼Œå»ºè®®è¿›è¡Œå¿ƒç”µå›¾å’Œå¿ƒè„è¶…å£°ç­‰æ£€æŸ¥æ¥ç¡®å®šè¯Šæ–­ã€‚æ²»ç–—æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨æ³¼å°¼æ¾ã€ç”Ÿè„‰é¥®å’Œä¸‰ç£·é…¸è…ºè‹·ç­‰è¯ç‰©ï¼ŒåŒæ—¶å»ºè®®é€‚å½“æ§åˆ¶ä½“æ¸©ï¼Œä¿æŒè‰¯å¥½çš„è¥å…»çŠ¶å†µã€‚<br><span class="hljs-comment">###model output###</span><br>å°å¼ å¯èƒ½æ‚£æœ‰å¿ƒè‚Œç‚ï¼Œéœ€è¦è¿›è¡Œå¿ƒè„è¶…å£°ã€å¿ƒç”µå›¾æ£€æŸ¥ç­‰è¾…åŠ©æ£€æŸ¥ä»¥ç¡®å®šè¯Šæ–­ã€‚æ²»ç–—æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨æŠ—ç”Ÿç´ ã€æŠ—åè¡€é…¸ç­‰è¯ç‰©è¿›è¡Œæ²»ç–—ï¼ŒåŒæ—¶å»ºè®®åŠ å¼ºè¥å…»ï¼Œé¿å…è¿‡åº¦åŠ³ç´¯ã€‚&lt;/s&gt;<br><span class="hljs-comment">###infering###</span><br><span class="hljs-comment">###instruction###</span><br>å°åˆ˜æœ€è¿‘å’³å—½æµé¼»æ¶•ï¼Œåº”è¯¥é‡‡å–å“ªäº›æ²»ç–—æ–¹æ¡ˆï¼Ÿ<br><span class="hljs-comment">###golden output###</span><br>ä¸­è¯å¯¹å’³å—½çš„æ²»ç–—å…·æœ‰å¤šé¶ç‚¹ä¼˜åŠ¿ï¼Œå¦‚è¿èŠ±æ¸…å’³ç‰‡ç­‰ï¼Œå…¶èæ±‡äº†ä¸œæ±‰å¼ ä»²æ™¯ã€Šä¼¤å¯’è®ºã€‹ä¸­å®£è‚ºæ³„çƒ­ã€æ­¢å’³å¹³å–˜çš„éº»æçŸ³ç”˜æ±¤ï¼›æ˜ä»£å¶æ–‡é¾„ã€ŠåŒ»å­¦ç»Ÿæ—¨ã€‹ä¸­çš„æ¸…é‡‘åŒ–ç—°æ±¤ï¼Œå…¶ä¸­æ¸…åŠå¤ç‡¥æ¹¿åŒ–ç—°ï¼Œæ¡‘ç™½çš®æ­¢å’³å¹³å–˜ï¼Œè‹¦æä»é•‡å’³å¹³å–˜ï¼Œæ¡”æ¢—å®£è‚ºåˆ©å’½ã€é•‡å’³æ’ç—°ï¼Œå‰èƒ¡é™æ°”åŒ–ç—°ï¼›å®«å»·è¦è¯å¤§é»„é€šè…‘æ³„è‚ºï¼Œè®©å¼•èµ·å’³å—½çš„è‚ºéƒ¨çƒ­æ¯’é€šè¿‡æ’ä¾¿æ’å‡ºä½“å¤–ï¼›å†é…åˆå…·æœ‰æ¸…çƒ­è§£æ¯’ä½œç”¨çš„å±±é“¶èŠ±ã€é»„èŠ©ã€è¿ç¿˜ç­‰ï¼Œå¯ä»¥è¯´æ˜¯é›†ä¸­äº†æ¸…å®£è‚ºçƒ­ã€æ­¢å’³åŒ–ç—°ã€ä¿ƒè¿›æ’ç—°ã€åˆ©å’½å¹³å–˜çš„ä¸€æ‰¹è¯ç‰©ï¼Œå‘æŒ¥å¤šé¶ç‚¹æ²»ç–—ä½œç”¨ã€‚<br><span class="hljs-comment">###model output###</span><br>å¯¹äºå°åˆ˜çš„å’³å—½æµé¼»æ¶•ï¼Œæ²»ç–—æ–¹æ¡ˆå¯ä»¥è€ƒè™‘ä½¿ç”¨é“¾éœ‰ç´ ã€æ°¨è‹„è¥¿æ—ã€ç¡«å”‘å˜Œå‘¤ç­‰è¯ç‰©ã€‚&lt;/s&gt;<br></code></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Ideaå¿«æ·é”®</title>
    <link href="/Idea%E5%BF%AB%E6%8D%B7%E9%94%AE.html"/>
    <url>/Idea%E5%BF%AB%E6%8D%B7%E9%94%AE.html</url>
    
    <content type="html"><![CDATA[<h1 id="ideaå¼€å‘å¸¸ç”¨å¿«æ·é”®">IDEAå¼€å‘å¸¸ç”¨å¿«æ·é”®</h1><table><thead><tr class="header"><th>å¿«æ·é”®ç»„åˆ</th><th>å®ç°æ•ˆæœ</th></tr></thead><tbody><tr class="odd"><td>psvm + Tabé”® / main + Tabé”®</td><td>public static void main(String[] args)</td></tr><tr class="even"><td>sout + Tabé”®</td><td>System.out.println()</td></tr><tr class="odd"><td>Ctrl + X</td><td>åˆ é™¤å½“å‰è¡Œ</td></tr><tr class="even"><td>Ctrl +D</td><td>å¤åˆ¶å½“å‰è¡Œ</td></tr><tr class="odd"><td>Alt+Insert(æˆ–å³é”®Generate)</td><td>ç”Ÿæˆä»£ç (å¦‚get,setæ–¹æ³•,æ„é€ å‡½æ•°ç­‰)</td></tr><tr class="even"><td>Ctrl+Alt+T</td><td>ç”Ÿæˆtry catch ï¼ˆæˆ–è€… Alt+enteré€‰æ‹©ï¼‰</td></tr><tr class="odd"><td>CTRL+ALT+T</td><td>æŠŠé€‰ä¸­çš„ä»£ç æ”¾åœ¨ TRY{} IF{} ELSE{} é‡Œ</td></tr><tr class="even"><td>Ctr+shift+U</td><td>å®ç°å¤§å°å†™ä¹‹é—´çš„è½¬åŒ–</td></tr><tr class="odd"><td>ALT+å›è½¦</td><td>å¯¼å…¥åŒ…,è‡ªåŠ¨ä¿®æ­£</td></tr><tr class="even"><td>CTRL+ALT+L</td><td>æ ¼å¼åŒ–ä»£ç </td></tr><tr class="odd"><td>CTRL+ALT+I</td><td>è‡ªåŠ¨ç¼©è¿›</td></tr><tr class="even"><td>CTRL+E</td><td>æœ€è¿‘æ›´æ”¹çš„ä»£ç </td></tr><tr class="odd"><td>fori</td><td>ç”Ÿæˆfor (int i = 0; i &lt; ; i++) {}</td></tr><tr class="even"><td>Alt + &lt;â€“å·¦å³â€“&gt;é”®</td><td>å®ç°çª—å£å·¦å³æ›´æ¢ï¼ˆå¤šçª—å£ï¼‰</td></tr><tr class="odd"><td>Ctrl + é¼ æ ‡ç‚¹å‡»</td><td>å¿«é€Ÿæ‰¾åˆ°æˆå‘˜å˜é‡çš„å‡ºå¤„</td></tr><tr class="even"><td>Shift+F6</td><td>é‡æ„/é‡å‘½å (åŒ…ã€ç±»ã€æ–¹æ³•ã€å˜é‡ã€ç”šè‡³æ³¨é‡Šç­‰)</td></tr><tr class="odd"><td>CTRL+Q</td><td>æŸ¥çœ‹å½“å‰æ–¹æ³•çš„å£°æ˜</td></tr><tr class="even"><td>Ctrl+Alt+V</td><td>è‡ªåŠ¨åˆ›å»ºå˜é‡ï¼ˆnew å¯¹è±¡();ä¹‹åé€‰æ‹©æŒ‰å¿«æ·é”®ï¼‰</td></tr><tr class="odd"><td>Ctrl+O</td><td>é‡å†™æ–¹æ³•</td></tr><tr class="even"><td>Ctrl+I</td><td>å®ç°æ–¹æ³•</td></tr><tr class="odd"><td>ALT+/</td><td>ä»£ç æç¤º</td></tr><tr class="even"><td>Ctrl+Shift+R</td><td>åœ¨å½“å‰é¡¹ç›®ä¸­æ›¿æ¢æŒ‡å®šå†…å®¹</td></tr><tr class="odd"><td>Ctrl+E</td><td>æœ€è¿‘ç¼–è¾‘çš„æ–‡ä»¶åˆ—è¡¨</td></tr><tr class="even"><td>Ctrl+P</td><td>æ˜¾ç¤ºæ–¹æ³•å‚æ•°ä¿¡æ¯</td></tr><tr class="odd"><td>Ctrl+Shift+Insert</td><td>æŸ¥çœ‹å†å²å¤åˆ¶è®°å½•ï¼Œideaå¯ä»¥ä¿ç•™å†å²å¤åˆ¶çš„ 100 æ¡è®°å½•</td></tr></tbody></table><h2 id="æ§åˆ¶å°è¯­å¥-system.out-ç›¸å…³">æ§åˆ¶å°è¯­å¥ System.out ç›¸å…³ï¼š</h2><table><thead><tr class="header"><th>ç”Ÿæˆæ§åˆ¶å°çš„ç›¸å…³å¿«æ·é”®</th><th>æè¿°</th></tr></thead><tbody><tr class="odd"><td>sout + Tabé”®</td><td>ç”ŸæˆSystem.out.println();ï¼Œè¾“å‡ºåˆ°æ§åˆ¶å°è¯­å¥å¹¶æ¢è¡Œã€‚</td></tr><tr class="even"><td>souf + Tabé”®</td><td>ç”ŸæˆSystem.out.printf("");,è¾“å‡ºä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ°æ§åˆ¶å°ã€‚</td></tr><tr class="odd"><td>soutm + Tabé”®</td><td>ç”ŸæˆSystem.out.println("ç±»å.æ–¹æ³•å");ï¼Œè¾“å‡ºå½“å‰ ç±»å’Œæ–¹æ³•ååˆ°æ§åˆ¶å°ã€‚</td></tr><tr class="even"><td>soutp + Tabé”®</td><td>ç”ŸæˆSystem.out.println(æ‰€æœ‰æ–¹æ³•å‚æ•°å+å€¼);ï¼Œè¾“å‡ºå½“å‰æ–¹æ³•çš„å‚æ•°åå’Œå€¼ åˆ°æ§åˆ¶å°ã€‚</td></tr></tbody></table><h2 id="æŸ¥æ‰¾">æŸ¥æ‰¾</h2><table><thead><tr class="header"><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr class="odd"><td>Ctrl + F</td><td>åœ¨å½“å‰æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æŸ¥æ‰¾</td></tr><tr class="even"><td>Ctrl + R</td><td>åœ¨å½“å‰æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æ›¿æ¢</td></tr><tr class="odd"><td>Shift + Ctrl + F</td><td>åœ¨é¡¹ç›®è¿›è¡Œæ–‡æœ¬æŸ¥æ‰¾</td></tr><tr class="even"><td>Shift + Ctrl + R</td><td>åœ¨é¡¹ç›®è¿›è¡Œæ–‡æœ¬æ›¿æ¢</td></tr><tr class="odd"><td>Shift + Shift</td><td>å¿«é€Ÿæœç´¢</td></tr><tr class="even"><td>Ctrl + N</td><td>æŸ¥æ‰¾class</td></tr><tr class="odd"><td>Ctrl + Shift + N</td><td>æŸ¥æ‰¾æ–‡ä»¶</td></tr><tr class="even"><td>Ctrl + Shift + Alt + N</td><td>æŸ¥æ‰¾symbolï¼ˆæŸ¥æ‰¾æŸä¸ªæ–¹æ³•åï¼‰</td></tr></tbody></table><h2 id="è·³è½¬åˆ‡æ¢">è·³è½¬åˆ‡æ¢</h2><table><thead><tr class="header"><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr class="odd"><td>Ctrl + E</td><td>æœ€è¿‘æ–‡ä»¶</td></tr><tr class="even"><td>Ctrl + Tab</td><td>åˆ‡æ¢æ–‡ä»¶</td></tr><tr class="odd"><td>Ctrl + Alt + â†/â†’</td><td>è·³è½¬å†å²å…‰æ ‡æ‰€åœ¨å¤„</td></tr><tr class="even"><td>Alt + â†/â†’ æ–¹å‘é”®</td><td>åˆ‡æ¢å­tab</td></tr><tr class="odd"><td>Ctrl + G</td><td>go toï¼ˆè·³è½¬æŒ‡å®šè¡Œå·ï¼‰</td></tr></tbody></table><h2 id="ç¼–ç ç›¸å…³">ç¼–ç ç›¸å…³</h2><table><thead><tr class="header"><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr class="odd"><td>Ctrl + W</td><td>å¿«é€Ÿé€‰ä¸­</td></tr><tr class="even"><td>(Shift + Ctrl) + Alt + J</td><td>å¿«é€Ÿé€‰ä¸­åŒæ–‡æœ¬</td></tr><tr class="odd"><td>Ctrl + C/Ctrl + X/Ctrl + D</td><td>å¿«é€Ÿå¤åˆ¶æˆ–å‰ªåˆ‡</td></tr><tr class="even"><td>å¤šè¡Œé€‰ä¸­ Tab / Shift + Tab</td><td>tab</td></tr><tr class="odd"><td>Ctrl + Y</td><td>åˆ é™¤æ•´è¡Œ</td></tr><tr class="even"><td>æ»šè½®ç‚¹å‡»å˜é‡/æ–¹æ³•/ç±»</td><td>å¿«é€Ÿè¿›å…¥å˜é‡/æ–¹æ³•/ç±»çš„å®šä¹‰å¤„</td></tr><tr class="odd"><td>Shift + ç‚¹å‡»Tab</td><td>å¿«é€Ÿå…³é—­tab</td></tr><tr class="even"><td>Ctrl + Z ã€Ctrl + Shift + Z</td><td>åæ‚”è¯ï¼Œæ’¤é”€/å–æ¶ˆæ’¤é”€</td></tr><tr class="odd"><td>Ctrl + Shift + enter</td><td>è‡ªåŠ¨æ”¶å°¾ï¼Œä»£ç è‡ªåŠ¨è¡¥å…¨</td></tr><tr class="even"><td>Alt + enter</td><td>IntelliJ IDEAæ ¹æ®å…‰æ ‡æ‰€åœ¨é—®é¢˜ï¼Œæä¾›å¿«é€Ÿä¿®å¤é€‰æ‹©ï¼Œå…‰æ ‡æ”¾åœ¨çš„ä½ç½®ä¸åŒæç¤ºçš„ç»“æœä¹Ÿä¸åŒ</td></tr><tr class="odd"><td>Alt + â†‘/â†“</td><td>æ–¹æ³•å¿«é€Ÿè·³è½¬</td></tr><tr class="even"><td>F2</td><td>è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé«˜äº®é”™è¯¯ æˆ– è­¦å‘Šä½ç½®</td></tr><tr class="odd"><td>Alt + Insert</td><td>ä»£ç è‡ªåŠ¨ç”Ÿæˆï¼Œå¦‚ç”Ÿæˆå¯¹è±¡çš„ set / get æ–¹æ³•ï¼Œæ„é€ å‡½æ•°ï¼ŒtoString()ç­‰</td></tr><tr class="even"><td>Ctrl + Shift + L</td><td>æ ¼å¼åŒ–ä»£ç </td></tr><tr class="odd"><td>Shift + F6</td><td>å¿«é€Ÿä¿®æ”¹æ–¹æ³•åã€å˜é‡åã€æ–‡ä»¶åã€ç±»åç­‰</td></tr><tr class="even"><td>Ctrl + F6</td><td>å¿«é€Ÿä¿®æ”¹æ–¹æ³•ç­¾å</td></tr></tbody></table><h2 id="ä»£ç é˜…è¯»ç›¸å…³">ä»£ç é˜…è¯»ç›¸å…³</h2><table><thead><tr class="header"><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr class="odd"><td>Ctrl + P</td><td>æ–¹æ³•å‚æ•°æç¤ºæ˜¾ç¤º</td></tr><tr class="even"><td>Ctrl + Shift + i</td><td>å°±å¯ä»¥åœ¨å½“å‰ç±»é‡Œå†å¼¹å‡ºä¸€ä¸ªçª—å£å‡ºæ¥</td></tr><tr class="odd"><td>Alt + F7</td><td>å¯ä»¥åˆ—å‡ºå˜é‡åœ¨å“ªäº›åœ°æ–¹è¢«ä½¿ç”¨äº†</td></tr><tr class="even"><td>å…‰æ ‡åœ¨å­ç±»æ¥å£åï¼ŒCtrl + u</td><td>è·³åˆ°çˆ¶ç±»æ¥å£</td></tr><tr class="odd"><td>Alt + F1 + 1ï¼Œ esc</td><td></td></tr><tr class="even"><td>(Shift) + Ctrl + +/-</td><td>ä»£ç å—æŠ˜å </td></tr><tr class="odd"><td>Ctrl + Shift + â†/â†’</td><td>ç§»åŠ¨çª—å£åˆ†å‰²çº¿</td></tr><tr class="even"><td>Ctrl + (Alt) + B</td><td>è·³è½¬æ–¹æ³•å®šä¹‰/å®ç°</td></tr><tr class="odd"><td>Ctrl + H</td><td>ç±»çš„å±‚çº§å…³ç³»</td></tr><tr class="even"><td>Ctrl + F12</td><td>Show Members ç±»æˆå‘˜å¿«é€Ÿæ˜¾ç¤º</td></tr></tbody></table><h2 id="ç‰ˆæœ¬ç®¡ç†ç›¸å…³">ç‰ˆæœ¬ç®¡ç†ç›¸å…³</h2><table><thead><tr class="header"><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr class="odd"><td>Ctrl + D</td><td>Show Diff</td></tr><tr class="even"><td>(Shift) + F7</td><td>ï¼ˆä¸Šï¼‰ä¸‹ä¸€å¤„ä¿®æ”¹</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å¤‡å¿˜å¤§å…¨</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¿«æ·é”®</tag>
      
      <tag>Idea</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Domain-Adversarial Training of Neural Networksï¼ˆDaNNï¼‰å®ç°</title>
    <link href="/Domain-Adversarial-Training-of-Neural-Networks%EF%BC%88DaNN%EF%BC%89%E5%AE%9E%E7%8E%B0.html"/>
    <url>/Domain-Adversarial-Training-of-Neural-Networks%EF%BC%88DaNN%EF%BC%89%E5%AE%9E%E7%8E%B0.html</url>
    
    <content type="html"><![CDATA[<h1id="domain-adversarial-training-of-neural-networksdannå®ç°">Domain-AdversarialTraining of Neural Networksï¼ˆDaNNï¼‰å®ç°</h1><h2 id="æ€»ä½“ä»‹ç»">æ€»ä½“ä»‹ç»</h2><p>åœ¨ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦<strong>å¤§é‡å¸¦æ ‡ç­¾çš„æ•°æ®</strong>è¿›è¡Œè®­ç»ƒï¼Œå¹¶ä¸”éœ€è¦ä¿è¯<strong>è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ•°æ®åˆ†å¸ƒç›¸ä¼¼</strong>ã€‚åœ¨ä¸€äº›é—®é¢˜ä¸­ï¼Œå¦‚æœè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æ•°æ®å…·æœ‰ä¸åŒçš„åˆ†å¸ƒï¼Œè®­ç»ƒåçš„åˆ†ç±»å™¨åœ¨æµ‹è¯•é›†ä¸Šå°±æ²¡æœ‰å¥½çš„è¡¨ç°ã€‚</p><p><strong>åŸŸé€‚åº”</strong>ï¼ˆDomainAdaptionï¼‰æ˜¯<strong>è¿ç§»å­¦ä¹ </strong>ä¸­ä¸€ä¸ªé‡è¦çš„åˆ†æ”¯ï¼Œç›®çš„æ˜¯æŠŠå…·æœ‰ä¸åŒåˆ†å¸ƒçš„<strong>æºåŸŸ</strong>(SourceDomain) å’Œ<strong>ç›®æ ‡åŸŸ</strong> (Target Domain)ä¸­çš„æ•°æ®ï¼Œæ˜ å°„åˆ°åŒä¸€ä¸ªç‰¹å¾ç©ºé—´ï¼Œå¯»æ‰¾æŸä¸€ç§åº¦é‡å‡†åˆ™ï¼Œä½¿å…¶åœ¨è¿™ä¸ªç©ºé—´ä¸Šçš„â€œè·ç¦»â€å°½å¯èƒ½è¿‘ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨æºåŸŸ(å¸¦æ ‡ç­¾) ä¸Šè®­ç»ƒå¥½çš„åˆ†ç±»å™¨ï¼Œå°±å¯ä»¥ç›´æ¥ç”¨äºç›®æ ‡åŸŸæ•°æ®çš„åˆ†ç±»ã€‚</p><p><strong>DaNN</strong>æ˜¯ä¸€ç§åŸŸé€‚åº”å­¦ä¹ æ–¹æ³•ï¼Œå®ƒé‡‡ç”¨äº†GANçš„æ€æƒ³ã€‚ä¸ºäº†ä½¿æ¨¡å‹åœ¨ç›®æ ‡é›†ä¸Šä¹Ÿèƒ½æœ‰å¥½çš„è¡¨ç°ï¼Œå®ƒçš„ç›®çš„æ˜¯ä½¿æ¨¡å‹ç‰¹å¾æå–å™¨åœ¨æºåŸŸå’Œç›®æ ‡åŸŸæå–çš„ç‰¹å¾å…·æœ‰ç›¸åŒçš„åˆ†å¸ƒã€‚</p><p>DANNç»“æ„ä¸»è¦åŒ…å«3ä¸ªéƒ¨åˆ†ï¼š</p><figure><img src="https://image.yinan.fun/image-20230713155252247.png"alt="image-20230713155252247" /><figcaption aria-hidden="true">image-20230713155252247</figcaption></figure><ul><li><strong>ç‰¹å¾æå–å™¨</strong> ï¼ˆfeature extractorï¼‰ -å›¾ç¤ºç»¿è‰²éƒ¨åˆ†ï¼Œç”¨æ¥<strong>å°†æ•°æ®æ˜ å°„åˆ°ç‰¹å®šçš„ç‰¹å¾ç©ºé—´</strong>ï¼Œä½¿æ ‡ç­¾é¢„æµ‹å™¨èƒ½å¤Ÿåˆ†è¾¨å‡ºæ¥è‡ªæºåŸŸæ•°æ®çš„ç±»åˆ«çš„åŒæ—¶ï¼ŒåŸŸåˆ¤åˆ«å™¨æ— æ³•åŒºåˆ†æ•°æ®æ¥è‡ªå“ªä¸ªåŸŸã€‚</li><li>æ ‡ç­¾é¢„æµ‹å™¨ ï¼ˆlabel predictorï¼‰ -å›¾ç¤ºè“è‰²éƒ¨åˆ†ï¼Œå¯¹æ¥è‡ªæºåŸŸçš„æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œå°½å¯èƒ½åˆ†å‡º<strong>æ­£ç¡®çš„æ ‡ç­¾</strong>ã€‚</li><li><strong>åŸŸåˆ¤åˆ«å™¨</strong>ï¼ˆdomain classifierï¼‰-å›¾ç¤ºçº¢è‰²éƒ¨åˆ†ï¼Œå¯¹ç‰¹å¾ç©ºé—´çš„æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œå°½å¯èƒ½åˆ†å‡º<strong>æ•°æ®æ¥è‡ªå“ªä¸ªåŸŸ</strong>ã€‚</li></ul><p>å¯¹æŠ—è¿ç§»ç½‘ç»œçš„æ€»æŸå¤±ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼šç½‘ç»œçš„è®­ç»ƒæŸå¤±ï¼ˆæ ‡ç­¾é¢„æµ‹å™¨æŸå¤±ï¼‰å’ŒåŸŸåˆ¤åˆ«æŸå¤±ã€‚</p><p>æˆ‘ä»¬é€šè¿‡æœ€å°åŒ–ç›®æ ‡å‡½æ•°æ¥æ›´æ–°æ ‡ç­¾é¢„æµ‹å™¨çš„å‚æ•°ï¼Œæœ€å¤§åŒ–ç›®æ ‡å‡½æ•°æ¥æ›´æ–°åŸŸåˆ¤åˆ«å™¨çš„å‚æ•°ã€‚</p><p>ç›¸å…³è®ºæ–‡ï¼šhttps://arxiv.org/abs/1505.07818</p><h2 id="ä»£ç å®ç°">ä»£ç å®ç°</h2><p>ç‰¹å¾æå–å™¨å®ç°ï¼ŒVGGç½‘ç»œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">FeatureExtractor</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(FeatureExtractor, self).__init__()<br><br>        self.conv = nn.Sequential(<br>            nn.Conv2d(<span class="hljs-number">1</span>, <span class="hljs-number">64</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">64</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">64</span>, <span class="hljs-number">128</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">128</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">128</span>, <span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">256</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">256</span>, <span class="hljs-number">256</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">256</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>),<br><br>            nn.Conv2d(<span class="hljs-number">256</span>, <span class="hljs-number">512</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br>            nn.BatchNorm2d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br>            nn.MaxPool2d(<span class="hljs-number">2</span>)<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, x</span>):<br>        x = self.conv(x).squeeze()<br>        <span class="hljs-keyword">return</span> x<br></code></pre></td></tr></table></figure><p>æ ‡ç­¾é¢„æµ‹å™¨å®ç°ï¼Œç”±çº¿æ€§å±‚ç»„æˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">LabelPredictor</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(LabelPredictor, self).__init__()<br><br>        self.layer = nn.Sequential(<br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">10</span>),<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, h</span>):<br>        c = self.layer(h)<br>        <span class="hljs-keyword">return</span> c<br></code></pre></td></tr></table></figure><p>åŸŸåˆ¤åˆ«å™¨å®ç°ï¼Œç”±çº¿æ€§å±‚ç»„æˆã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DomainClassifier</span>(nn.Module):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(DomainClassifier, self).__init__()<br><br>        self.layer = nn.Sequential(<br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">512</span>),<br>            nn.BatchNorm1d(<span class="hljs-number">512</span>),<br>            nn.ReLU(),<br><br>            nn.Linear(<span class="hljs-number">512</span>, <span class="hljs-number">1</span>),<br>        )<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, h</span>):<br>        y = self.layer(h)<br>        <span class="hljs-keyword">return</span> y<br></code></pre></td></tr></table></figure><p>æŸå¤±å‡½æ•°é€‰æ‹©</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">class_criterion = nn.CrossEntropyLoss()<br>domain_criterion = nn.BCEWithLogitsLoss()<br></code></pre></td></tr></table></figure><p>è®­ç»ƒè¿‡ç¨‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">for</span> i, ((source_data, source_label), (target_data, _)) <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(<span class="hljs-built_in">zip</span>(source_dataloader, target_dataloader)):<br>    source_data = source_data.to(device)<br>    source_label = source_label.to(device)<br>    target_data = target_data.to(device)<br>    mixed_data = torch.cat([source_data, target_data], dim=<span class="hljs-number">0</span>)<br>    domain_label = torch.zeros([source_data.shape[<span class="hljs-number">0</span>] + target_data.shape[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>]).to(device)<br>    domain_label[:source_data.shape[<span class="hljs-number">0</span>]] = <span class="hljs-number">1</span><br><br>    <span class="hljs-comment"># 1. å…ˆè®­ç»ƒdomain classifier</span><br>    feature = feature_extractor(mixed_data)<br>    domain_logits = domain_classifier(feature.detach())<br>    loss = domain_criterion(domain_logits, domain_label)<br>    domain_classifier_losses.append(loss.item())<br>    running_D_loss += loss.item()<br>    loss.backward()<br>    optimizer_D.step()<br><br>    <span class="hljs-comment"># 2. è®­ç»ƒ feature extractor å’Œ label classifier</span><br>    class_logits = label_predictor(feature[:source_data.shape[<span class="hljs-number">0</span>]])<br>    domain_logits = domain_classifier(feature)<br>    loss = class_criterion(class_logits, source_label) - lamb * domain_criterion(domain_logits, domain_label)<br>    total_losses.append(loss.item())<br>    running_F_loss += loss.item()<br>    loss.backward()<br>    optimizer_F.step()<br>    optimizer_C.step()<br><br>    optimizer_D.zero_grad()<br>    optimizer_F.zero_grad()<br>    optimizer_C.zero_grad()<br></code></pre></td></tr></table></figure><h2 id="ç»“æœ">ç»“æœ</h2><p>è®­ç»ƒæŸå¤±ä¸Šä¸‹æ³¢åŠ¨ï¼Œæ˜¯ç‰¹å¾æå–å™¨å’ŒåŸŸåˆ¤åˆ«å™¨åœ¨ä¸æ–­å¯¹æŠ—ã€‚</p><figure><img src="https://image.yinan.fun/image-20230713171352103.png"alt="image-20230713171352103" /><figcaption aria-hidden="true">image-20230713171352103</figcaption></figure><p>è®­ç»ƒ10ã€100ã€200ä¸ªepochåï¼Œç‰¹å¾æå–å™¨æå–çš„ç‰¹å¾åˆ†å¸ƒæŒ‰ç±»åˆ«å’Œsource/targetå±•ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œéšç€è®­ç»ƒçš„è¿‡ç¨‹ï¼Œç‰¹å¾è¶Šæ¥è¶Šèƒ½åŒºåˆ†ä¸åŒçš„ç±»ï¼Œsourceå’Œtargetdomainçš„åˆ†å¸ƒè¶Šæ¥è¶Šä¸€è‡´ã€‚</p><figure><img src="https://image.yinan.fun/image-20230713171446520.png"alt="image-20230713171446520" /><figcaption aria-hidden="true">image-20230713171446520</figcaption></figure><figure><img src="https://image.yinan.fun/image-20230713171459818.png"alt="image-20230713171459818" /><figcaption aria-hidden="true">image-20230713171459818</figcaption></figure><figure><img src="https://image.yinan.fun/image-20230713171519185.png"alt="image-20230713171519185" /><figcaption aria-hidden="true">image-20230713171519185</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœºå™¨å­¦ä¹ </tag>
      
      <tag>æ·±åº¦å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äº†è§£ChatGPT</title>
    <link href="/%E4%BA%86%E8%A7%A3ChatGPT.html"/>
    <url>/%E4%BA%86%E8%A7%A3ChatGPT.html</url>
    
    <content type="html"><![CDATA[<h1 id="äº†è§£chatgpt">äº†è§£ChatGPT</h1><h2 id="chatgptçš„åŠŸèƒ½">1. ChatGPTçš„åŠŸèƒ½</h2><p>å¦‚æœæˆ‘ä»¬å‘ChatGPTè¯¢é—®ChatGPTçš„<strong>åŠŸèƒ½</strong>ï¼š</p><p>ChatGPTå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ol type="1"><li>å›ç­”é—®é¢˜ï¼šChatGPTå¯ä»¥<strong>å›ç­”å„ç§é—®é¢˜</strong>ï¼ŒåŒ…æ‹¬å¸¸è§çŸ¥è¯†ã€äº‹å®ã€å®šä¹‰ã€å†å²äº‹ä»¶ç­‰ã€‚</li><li>æä¾›è§£é‡Šï¼šChatGPTå¯ä»¥<strong>è§£é‡Šå¤æ‚çš„æ¦‚å¿µ</strong>ã€åŸç†ã€æœ¯è¯­ç­‰ï¼Œå¹¶å¸®åŠ©ä½ æ›´å¥½åœ°ç†è§£ã€‚</li><li>æä¾›å»ºè®®ï¼šChatGPTå¯ä»¥<strong>æä¾›å…³äºå„ç§ä¸»é¢˜çš„å»ºè®®</strong>ï¼Œä¾‹å¦‚æ—…è¡Œç›®çš„åœ°ã€ç”µå½±æ¨èã€é£Ÿè°±ç­‰ã€‚</li><li>è¿›è¡Œå¯¹è¯ï¼šChatGPTå¯ä»¥<strong>è¿›è¡Œå¯¹è¯</strong>ï¼Œä½ å¯ä»¥ä¸å®ƒäº¤æµï¼Œåˆ†äº«è§‚ç‚¹ã€æé—®é—®é¢˜æˆ–å¯»æ±‚å¸®åŠ©ã€‚</li><li>å†™ä½œè¾…åŠ©ï¼šå¦‚æœä½ éœ€è¦<strong>å†™ä½œæ–‡ç« </strong>ã€åˆ›ä½œæ•…äº‹æˆ–æ’°å†™é‚®ä»¶ï¼ŒChatGPTå¯ä»¥<strong>æä¾›çµæ„Ÿ</strong>ã€æä¾›å†™ä½œå»ºè®®å’Œè¿›è¡Œæ–‡æœ¬ç”Ÿæˆã€‚</li></ol><p>è¯·æ³¨æ„ï¼Œå°½ç®¡ChatGPTå…·å¤‡å¹¿æ³›çš„çŸ¥è¯†å’Œè¯­è¨€ç†è§£èƒ½åŠ›ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œ<strong>å¯èƒ½ä¼šå‡ºç°é”™è¯¯æˆ–æä¾›ä¸å‡†ç¡®çš„ç­”æ¡ˆ</strong>ã€‚åœ¨ä½¿ç”¨æ—¶ï¼Œè¯·è°¨æ…è¯„ä¼°å’ŒéªŒè¯ä¿¡æ¯çš„å‡†ç¡®æ€§ã€‚ï¼ˆChatGPTç”Ÿæˆï¼‰</p><p>å¦å¤–ï¼Œä»OpenAIçš„å®˜ç½‘æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼ŒChatGPT<strong>ä»¥å¯¹è¯çš„æ–¹å¼è¿›è¡Œäº¤äº’</strong>ï¼Œå¯¹è¯å½¢å¼ä½¿ChatGPTèƒ½å¤Ÿå›ç­”åç»­é—®é¢˜ã€æ‰¿è®¤é”™è¯¯ã€è´¨ç–‘ä¸æ­£ç¡®çš„å‰æå¹¶æ‹’ç»ä¸é€‚å½“çš„è¯·æ±‚ã€‚</p><p>OpenAIçš„å®˜ç½‘ä¹Ÿåˆ—å‡ºäº†ChatGPTçš„<strong>ç¼ºç‚¹</strong>ï¼Œä¾‹å¦‚æœ‰æ—¶ä¼šå›ç­”çœ‹ä¼¼æœ‰é“ç†ä½†æ˜¯æ˜¯é”™è¯¯æˆ–æ²¡æ„ä¹‰çš„å›ç­”ï¼Œå¯¹æé—®çš„æ–¹å¼æ•æ„Ÿï¼Œæ¨¡å‹è¿‡äºå†—é•¿ï¼Œåœ¨ç”¨æˆ·è¯¢é—®æ¨¡ç³Šçš„é—®é¢˜æ—¶çŒœæµ‹ç”¨æˆ·çš„æƒ³æ³•ã€‚</p><h2 id="chatgptçš„åŸç†">2. ChatGPTçš„åŸç†</h2><p>å¦‚æœæˆ‘ä»¬å‘ChatGPTè¯¢é—®ChatGPTçš„<strong>åŸç†</strong>ï¼š</p><p>ChatGPTçš„å®ç°æ˜¯åŸºäº<strong>æ·±åº¦å­¦ä¹ </strong>å’Œ<strong>è‡ªç›‘ç£å­¦ä¹ </strong>çš„æ–¹æ³•ã€‚ä¸‹é¢å°†è¯¦ç»†è¯´æ˜ChatGPTçš„å®ç°è¿‡ç¨‹ï¼š</p><ol type="1"><li>æ•°æ®æ”¶é›†ï¼šä¸ºäº†<strong>é¢„è®­ç»ƒ</strong>ChatGPTï¼Œå¤§é‡çš„äº’è”ç½‘<strong>æ–‡æœ¬æ•°æ®</strong>è¢«æ”¶é›†å’Œå‡†å¤‡ã€‚è¿™äº›æ•°æ®å¯ä»¥åŒ…æ‹¬ç½‘é¡µå†…å®¹ã€ä¹¦ç±ã€ç»´åŸºç™¾ç§‘ã€æ–°é—»æ–‡ç« ç­‰ã€‚è¿™äº›æ–‡æœ¬æ•°æ®è¢«ç”¨æ¥æ„å»ºä¸€ä¸ªåºå¤§çš„è¯­æ–™åº“ï¼Œä½œä¸ºæ¨¡å‹çš„è®­ç»ƒæ•°æ®ã€‚</li><li>æ„å»ºTransformeræ¨¡å‹ï¼šChatGPTæ˜¯åŸºäº<strong>Transformer</strong>æ¨¡å‹æ„å»ºçš„ã€‚Transformeræ¨¡å‹æ˜¯ä¸€ç§ä½¿ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆself-attentionï¼‰çš„åºåˆ—åˆ°åºåˆ—æ¨¡å‹ï¼Œå®ƒèƒ½å¤Ÿå¤„ç†é•¿è·ç¦»ä¾èµ–å…³ç³»å¹¶æ•æ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚Transformeræ¨¡å‹ç”±å¤šä¸ªç¼–ç å™¨å’Œè§£ç å™¨å±‚ç»„æˆï¼Œæ¯ä¸ªå±‚éƒ½åŒ…å«å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶å’Œå‰é¦ˆç¥ç»ç½‘ç»œã€‚</li><li>é¢„è®­ç»ƒï¼šåœ¨<strong>é¢„è®­ç»ƒ</strong>é˜¶æ®µï¼ŒChatGPTä½¿ç”¨å¤§è§„æ¨¡çš„è¯­æ–™åº“è¿›è¡Œè®­ç»ƒã€‚æ¨¡å‹é€šè¿‡<strong>è‡ªç›‘ç£å­¦ä¹ </strong>çš„æ–¹å¼è¿›è¡Œé¢„è®­ç»ƒï¼Œå³åœ¨æ²¡æœ‰äººå·¥æ ‡æ³¨çš„æƒ…å†µä¸‹è¿›è¡Œè®­ç»ƒã€‚é¢„è®­ç»ƒçš„ç›®æ ‡æ˜¯<strong>é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯æˆ–æ ‡è®°</strong>ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°è¯­è¨€çš„ç»Ÿè®¡è§„å¾‹ã€è¯­ä¹‰å…³ç³»å’Œä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚é¢„è®­ç»ƒä½¿ç”¨äº†å¤§é‡çš„è®¡ç®—èµ„æºå’Œå¹¶è¡Œè®¡ç®—ï¼Œé€šå¸¸éœ€è¦èŠ±è´¹æ•°å¤©ç”šè‡³æ•°å‘¨çš„æ—¶é—´ã€‚</li><li>å¾®è°ƒï¼šåœ¨é¢„è®­ç»ƒä¹‹åï¼ŒChatGPTéœ€è¦è¿›è¡Œ<strong>å¾®è°ƒ</strong>ä»¥<strong>é€‚åº”ç‰¹å®šçš„ä»»åŠ¡</strong>ã€‚å¯¹äºå¯¹è¯å¼äº¤äº’ï¼Œå¾®è°ƒé˜¶æ®µé€šå¸¸ä½¿ç”¨<strong>å¯¹è¯æ•°æ®</strong>è¿›è¡Œè®­ç»ƒã€‚å¯¹è¯æ•°æ®åŒ…æ‹¬ç”¨æˆ·çš„é—®é¢˜å’Œæ¨¡å‹çš„å›ç­”ã€‚é€šè¿‡åœ¨è¿™äº›å¯¹è¯æ•°æ®ä¸Šè¿›è¡Œå¾®è°ƒï¼Œæ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£å’Œç”Ÿæˆå¯¹è¯ï¼Œå¹¶æä¾›å‡†ç¡®çš„å›ç­”ã€‚</li><li>æ¨¡å‹ä¼˜åŒ–å’Œéƒ¨ç½²ï¼šåœ¨å¾®è°ƒä¹‹åï¼ŒChatGPTéœ€è¦è¿›è¡Œ<strong>æ¨¡å‹ä¼˜åŒ–å’Œéƒ¨ç½²</strong>ï¼Œä»¥æé«˜æ€§èƒ½å’Œæ•ˆç‡ã€‚è¿™åŒ…æ‹¬æ¨¡å‹çš„å‹ç¼©ã€åŠ é€Ÿå’Œä¼˜åŒ–ï¼Œä»¥ä¾¿åœ¨å®é™…åº”ç”¨ä¸­èƒ½å¤Ÿå¿«é€Ÿå“åº”ç”¨æˆ·çš„è¯·æ±‚ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒChatGPTçš„å®ç°è¿‡ç¨‹éå¸¸å¤æ‚ï¼Œå¹¶éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œæ•°æ®ã€‚OpenAIå›¢é˜Ÿåœ¨å®ç°ChatGPTæ—¶æŠ•å…¥äº†å¤§é‡çš„ç ”ç©¶å’Œå·¥ç¨‹å·¥ä½œï¼Œä»¥ä½¿å…¶å…·å¤‡å¼ºå¤§çš„è¯­è¨€ç†è§£å’Œç”Ÿæˆèƒ½åŠ›ã€‚ï¼ˆChatGPTç”Ÿæˆï¼‰</p><p>OpenAIçš„å®˜ç½‘ç®€è¦è¯´æ˜äº†ChatGPTçš„æ–¹æ³•ã€‚æ¨¡å‹è®­ç»ƒä½¿ç”¨äº†<strong>ReinforcementLearning from Human Feedback</strong>(RLHF)ï¼Œå³ä»¥å¼ºåŒ–å­¦ä¹ æ–¹å¼ä¾æ®äººç±»åé¦ˆä¼˜åŒ–è¯­è¨€æ¨¡å‹ã€‚å¼€å§‹ä½¿ç”¨æœ‰ç›‘ç£çš„å¾®è°ƒè®­ç»ƒåˆå§‹æ¨¡å‹ã€‚ç„¶åæ”¶é›†comparisondataä¸ºå¼ºåŒ–å­¦ä¹ è®­ç»ƒä¸€ä¸ªå¥–åŠ±æ¨¡å‹ï¼ˆreward modelï¼‰ã€‚æœ€åä½¿ç”¨Proximal PolicyOptimizationå¼ºåŒ–å­¦ä¹ ç®—æ³•å¾®è°ƒæ¨¡å‹ã€‚</p><figure><img src="https://image.yinan.fun/ChatGPT_Diagram.svg"alt="Chatgpt Diagram" /><figcaption aria-hidden="true">Chatgpt Diagram</figcaption></figure><p>OpenAIçš„å®˜ç½‘è¯´ï¼šWe trained this model using Reinforcement Learningfrom Human Feedback (RLHF), using the same methods as <ahref="https://openai.com/blog/instruction-following/"><strong>InstructGPT</strong></a>,but with slight differences in the data collection setup.å› æ­¤ï¼Œè¦äº†è§£æ›´å¤šå…³äºChatGPTä¹Ÿå¯ä»¥é˜…è¯»instructGPTçš„è®ºæ–‡ï¼šhttps://arxiv.org/abs/2203.02155ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ChatGPT</tag>
      
      <tag>è¯­è¨€æ¨¡å‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çˆ±æ¥¼è¡¨æƒ…åŒ…ç½‘ç«™</title>
    <link href="/%E7%88%B1%E6%A5%BC%E8%A1%A8%E6%83%85%E5%8C%85%E7%BD%91%E7%AB%99.html"/>
    <url>/%E7%88%B1%E6%A5%BC%E8%A1%A8%E6%83%85%E5%8C%85%E7%BD%91%E7%AB%99.html</url>
    
    <content type="html"><![CDATA[<h1 id="çˆ±æ¥¼-è¡¨æƒ…åŒ…ç½‘ç«™">çˆ±æ¥¼-è¡¨æƒ…åŒ…ç½‘ç«™</h1><h2 id="é¡µé¢å±•ç¤º">é¡µé¢å±•ç¤º</h2><ul><li>ä¸»é¡µ</li></ul><figure><img src="https://image.yinan.fun/202308242323122.png"alt="image-20230717161539797" /><figcaption aria-hidden="true">image-20230717161539797</figcaption></figure><ul><li>ç®¡ç†å‘˜é¡µé¢</li></ul><figure><img src="https://image.yinan.fun/image-20230717161629434.png"alt="image-20230717161629434" /><figcaption aria-hidden="true">image-20230717161629434</figcaption></figure><ul><li>åç«¯æ–‡æ¡£</li></ul><figure><img src="https://image.yinan.fun/image-20230717161823777.png"alt="image-20230717161823777" /><figcaption aria-hidden="true">image-20230717161823777</figcaption></figure><h2 id="éœ€æ±‚åˆ†æ">éœ€æ±‚åˆ†æ</h2><ol type="1"><li>ç”¨æˆ·æ ¹æ®åå­—å’Œæ ‡ç­¾æœç´¢è¡¨æƒ…åŒ…</li><li>ç”¨æˆ·ä¸Šä¼ è¡¨æƒ…åŒ…</li><li>ç®¡ç†å‘˜ç®¡ç†è¡¨æƒ…åŒ…</li></ol><h2 id="æŠ€æœ¯æ ˆ">æŠ€æœ¯æ ˆ</h2><h3 id="å‰ç«¯">å‰ç«¯</h3><ul><li>æ¡†æ¶ï¼šVue 3</li><li>ç»„ä»¶åº“ï¼šAnt Design Vue</li><li>è¯·æ±‚ï¼šAxios</li><li>è·¯ç”±ï¼šVue Router</li><li>æ–‡ä»¶ä¸‹è½½ï¼šFileSaver</li></ul><h3 id="åç«¯">åç«¯</h3><ul><li>Java 8</li><li>å¼€å‘æ¡†æ¶ï¼šSpringBoot 2.x</li><li>æ•°æ®è®¿é—®ï¼šMyBatis + MyBatis Plus</li><li>ç¼“å­˜ï¼šRedis</li><li>é¡¹ç›®ç®¡ç†ï¼šMaven</li><li>æ¥å£æ–‡æ¡£ï¼šSwagger + Knife4j</li></ul><h3 id="å­˜å‚¨">å­˜å‚¨</h3><ul><li>æ•°æ®åº“ï¼šMySQL</li><li>å¯¹è±¡å­˜å‚¨ï¼šä¸ƒç‰›äº‘ COS</li></ul><h3 id="éƒ¨ç½²">éƒ¨ç½²</h3><ul><li>å‰ç«¯ï¼šNginx + Docker</li><li>åç«¯ï¼šDockerå®¹å™¨</li></ul><h2 id="ç‰¹æ€§">ç‰¹æ€§</h2><ol type="1"><li>ä½¿ç”¨ Redisç¼“å­˜é¦–é¡µé«˜é¢‘è®¿é—®çš„è¡¨æƒ…åŒ…åˆ—è¡¨ï¼Œå°†æ¥å£å“åº”æ—¶é•¿ä»120æ¯«ç§’ç¼©çŸ­è‡³20æ¯«ç§’ã€‚<br /></li><li>é€‰ç”¨ MyBatis + MyBatis-Plusè¿›è¡Œæ•°æ®è®¿é—®å±‚å¼€å‘ï¼Œå¤ç”¨å¤§å¤šæ•°é€šç”¨æ–¹æ³•ï¼Œå¹¶ä¸”é€šè¿‡ç»§æ‰¿å®šåˆ¶äº†è‡ªå·±çš„é€šç”¨æ“ä½œæ¨¡æ¿ï¼Œå¤§å¹…æå‡äº†é¡¹ç›®å¼€å‘æ•ˆç‡ã€‚<br /></li><li>ä¸ºäº†æ˜ç¡®æ¥å£çš„è¿”å›ï¼Œè‡ªå®šä¹‰ç»Ÿä¸€çš„é”™è¯¯ç ï¼Œå¹¶å°è£…äº†å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Œä»è€Œè§„èŒƒäº†å¼‚å¸¸è¿”å›ã€å±è”½äº†é¡¹ç›®å†—ä½™çš„æŠ¥é”™ç»†èŠ‚ã€‚<br /></li><li>è‡ªä¸»ç¼–å†™ Dockerfileï¼Œå¹¶é€šè¿‡å®¹å™¨éƒ¨ç½²ï¼Œæé«˜éƒ¨ç½²ä¸Šçº¿æ•ˆç‡ã€‚<br /></li><li>ä½¿ç”¨ Knife4j + Swaggerè‡ªåŠ¨ç”Ÿæˆåç«¯æ¥å£æ–‡æ¡£ï¼Œé¿å…äº†äººå·¥ç¼–å†™ç»´æŠ¤æ–‡æ¡£çš„éº»çƒ¦ã€‚<br /></li><li>å‰ç«¯ä½¿ç”¨ Vant UI ç»„ä»¶åº“ï¼Œå¹¶å°è£…äº†å…¨å±€é€šç”¨çš„ Layoutç»„ä»¶ï¼Œä½¿ä¸»é¡µã€æœç´¢é¡µã€ç®¡ç†é¡µå¸ƒå±€ä¸€è‡´ã€å¹¶å‡å°‘é‡å¤ä»£ç ã€‚</li></ol><h2 id="è½¯ä»¶è®¾è®¡">è½¯ä»¶è®¾è®¡</h2><h3 id="æ•°æ®åº“è®¾è®¡">æ•°æ®åº“è®¾è®¡</h3><p><strong>æ•°æ®åº“åï¼š</strong> ilou</p><table><thead><tr class="header"><th style="text-align: left;">è¡¨å</th><th style="text-align: left;">è¯´æ˜</th></tr></thead><tbody><tr class="odd"><td style="text-align: left;"><a href="#emoji">emoji</a></td><td style="text-align: left;">è¡¨æƒ…</td></tr><tr class="even"><td style="text-align: left;"><a href="#tag">tag</a></td><td style="text-align: left;">æ ‡ç­¾</td></tr></tbody></table><p><strong>è¡¨åï¼š</strong> <a id="tag">emoji</a></p><p><strong>è¯´æ˜ï¼š</strong> è¡¨æƒ…</p><p><strong>æ•°æ®åˆ—ï¼š</strong></p><table><thead><tr class="header"><th style="text-align: center;">åºå·</th><th style="text-align: left;">åç§°</th><th style="text-align: center;">æ•°æ®ç±»å‹</th><th style="text-align: center;">é•¿åº¦</th><th style="text-align: center;">å°æ•°ä½</th><th style="text-align: center;">å…è®¸ç©ºå€¼</th><th style="text-align: center;">ä¸»é”®</th><th style="text-align: center;">é»˜è®¤å€¼</th><th style="text-align: center;">è¯´æ˜</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">1</td><td style="text-align: left;">id</td><td style="text-align: center;">int</td><td style="text-align: center;">10</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">Y</td><td style="text-align: center;"></td><td style="text-align: center;"></td></tr><tr class="even"><td style="text-align: center;">2</td><td style="text-align: left;">url</td><td style="text-align: center;">varchar</td><td style="text-align: center;">4096</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;"></td><td style="text-align: center;"></td></tr><tr class="odd"><td style="text-align: center;">3</td><td style="text-align: left;">name</td><td style="text-align: center;">varchar</td><td style="text-align: center;">512</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;"></td><td style="text-align: center;"></td></tr><tr class="even"><td style="text-align: center;">4</td><td style="text-align: left;">userId</td><td style="text-align: center;">int</td><td style="text-align: center;">10</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;">0</td><td style="text-align: center;">ä¸Šä¼ ç”¨æˆ·id</td></tr><tr class="odd"><td style="text-align: center;">5</td><td style="text-align: left;">tags</td><td style="text-align: center;">varchar</td><td style="text-align: center;">1024</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;"></td><td style="text-align: center;">æ ‡ç­¾æ•°ç»„json</td></tr><tr class="even"><td style="text-align: center;">6</td><td style="text-align: left;">reviewStatus</td><td style="text-align: center;">int</td><td style="text-align: center;">10</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">N</td><td style="text-align: center;">0</td><td style="text-align: center;">0-å¾…å®¡æ ¸,1-é€šè¿‡,2-æ‹’ç»</td></tr><tr class="odd"><td style="text-align: center;">7</td><td style="text-align: left;">createTime</td><td style="text-align: center;">datetime</td><td style="text-align: center;">19</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;">CURRENT_TIMESTAMP</td><td style="text-align: center;"></td></tr><tr class="even"><td style="text-align: center;">8</td><td style="text-align: left;">isDelete</td><td style="text-align: center;">tinyint</td><td style="text-align: center;">3</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">N</td><td style="text-align: center;">0</td><td style="text-align: center;">æ˜¯å¦åˆ é™¤0-æœªåˆ é™¤1-å·²åˆ é™¤</td></tr><tr class="odd"><td style="text-align: center;">9</td><td style="text-align: left;">updateTime</td><td style="text-align: center;">datetime</td><td style="text-align: center;">19</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;">CURRENT_TIMESTAMP</td><td style="text-align: center;"></td></tr></tbody></table><p><strong>è¡¨åï¼š</strong> <a id="tag">tag</a></p><p><strong>è¯´æ˜ï¼š</strong> æ ‡ç­¾</p><p><strong>æ•°æ®åˆ—ï¼š</strong></p><table style="width:100%;"><thead><tr class="header"><th style="text-align: center;">åºå·</th><th style="text-align: left;">åç§°</th><th style="text-align: center;">æ•°æ®ç±»å‹</th><th style="text-align: center;">é•¿åº¦</th><th style="text-align: center;">å°æ•°ä½</th><th style="text-align: center;">å…è®¸ç©ºå€¼</th><th style="text-align: center;">ä¸»é”®</th><th style="text-align: center;">é»˜è®¤å€¼</th><th style="text-align: center;">è¯´æ˜</th></tr></thead><tbody><tr class="odd"><td style="text-align: center;">1</td><td style="text-align: left;">id</td><td style="text-align: center;">int</td><td style="text-align: center;">10</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">Y</td><td style="text-align: center;"></td><td style="text-align: center;"></td></tr><tr class="even"><td style="text-align: center;">2</td><td style="text-align: left;">name</td><td style="text-align: center;">varchar</td><td style="text-align: center;">512</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">N</td><td style="text-align: center;"></td><td style="text-align: center;">æ ‡ç­¾å</td></tr><tr class="odd"><td style="text-align: center;">3</td><td style="text-align: left;">createTime</td><td style="text-align: center;">datetime</td><td style="text-align: center;">19</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;">CURRENT_TIMESTAMP</td><td style="text-align: center;"></td></tr><tr class="even"><td style="text-align: center;">4</td><td style="text-align: left;">isDelete</td><td style="text-align: center;">tinyint</td><td style="text-align: center;">3</td><td style="text-align: center;">0</td><td style="text-align: center;">N</td><td style="text-align: center;">N</td><td style="text-align: center;">0</td><td style="text-align: center;">æ˜¯å¦åˆ é™¤0-æœªåˆ é™¤1-å·²åˆ é™¤</td></tr><tr class="odd"><td style="text-align: center;">5</td><td style="text-align: left;">updateTime</td><td style="text-align: center;">datetime</td><td style="text-align: center;">19</td><td style="text-align: center;">0</td><td style="text-align: center;">Y</td><td style="text-align: center;">N</td><td style="text-align: center;">CURRENT_TIMESTAMP</td><td style="text-align: center;"></td></tr></tbody></table><h3 id="åç«¯æ¥å£è®¾è®¡">åç«¯æ¥å£è®¾è®¡</h3><p><ahref="ilou-api.yinan.fun/api/doc.html">ilou-api.yinan.fun/api/doc.html</a></p><h3 id="é€šç”¨è¿”å›å¯¹è±¡">é€šç”¨è¿”å›å¯¹è±¡</h3><p>ç»™å¯¹è±¡è¡¥å……ä¸€äº›ä¿¡æ¯ï¼Œå‘Šè¯‰å‰ç«¯è¿™ä¸ªè¯·æ±‚åœ¨ä¸šåŠ¡å±‚é¢ä¸Šæ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java">SUCCESS(<span class="hljs-number">0</span>, <span class="hljs-string">&quot;ok&quot;</span>),<br>PARAMS_ERROR(<span class="hljs-number">40000</span>, <span class="hljs-string">&quot;è¯·æ±‚å‚æ•°é”™è¯¯&quot;</span>),<br>NOT_LOGIN_ERROR(<span class="hljs-number">40100</span>, <span class="hljs-string">&quot;æœªç™»å½•&quot;</span>),<br>NO_AUTH_ERROR(<span class="hljs-number">40101</span>, <span class="hljs-string">&quot;æ— æƒé™&quot;</span>),<br>NOT_FOUND_ERROR(<span class="hljs-number">40400</span>, <span class="hljs-string">&quot;è¯·æ±‚æ•°æ®ä¸å­˜åœ¨&quot;</span>),<br>FORBIDDEN_ERROR(<span class="hljs-number">40300</span>, <span class="hljs-string">&quot;ç¦æ­¢è®¿é—®&quot;</span>),<br>SYSTEM_ERROR(<span class="hljs-number">50000</span>, <span class="hljs-string">&quot;ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸&quot;</span>),<br>OPERATION_ERROR(<span class="hljs-number">50001</span>, <span class="hljs-string">&quot;æ“ä½œå¤±è´¥&quot;</span>),<br>FILE_UPLOAD_ERROR(<span class="hljs-number">50010</span>, <span class="hljs-string">&quot;æ–‡ä»¶ä¸Šä¼ é”™è¯¯&quot;</span>);<br></code></pre></td></tr></table></figure><h3 id="å…¨å±€å¼‚å¸¸å¤„ç†å™¨">å…¨å±€å¼‚å¸¸å¤„ç†å™¨</h3><ol type="1"><li><p>å®šä¹‰ä¸šåŠ¡å¼‚å¸¸ç±»</p><ol type="1"><li>ç›¸å¯¹äº java çš„å¼‚å¸¸ç±»ï¼Œæ”¯æŒæ›´å¤šå­—æ®µ</li><li>è‡ªå®šä¹‰æ„é€ å‡½æ•°ï¼Œæ›´çµæ´» / å¿«æ·çš„è®¾ç½®å­—æ®µ</li></ol></li><li><p>ç¼–å†™å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼ˆåˆ©ç”¨ SpringAOPï¼Œåœ¨è°ƒç”¨æ–¹æ³•å‰åè¿›è¡Œé¢å¤–çš„å¤„ç†ï¼‰</p></li></ol><h3 id="æºç ">æºç </h3><p><ahref="https://github.com/wyn04/ilou">https://github.com/wyn04/ilou</a></p>]]></content>
    
    
    <categories>
      
      <category>é¡¹ç›®</category>
      
    </categories>
    
    
    <tags>
      
      <tag>JAVA</tag>
      
      <tag>SpringBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PyInstaller python æ‰“åŒ…å·¥å…·ä½¿ç”¨</title>
    <link href="/PyInstaller-python-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8.html"/>
    <url>/PyInstaller-python-%E6%89%93%E5%8C%85%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8.html</url>
    
    <content type="html"><![CDATA[<h1 id="pyinstaller-python-æ‰“åŒ…å·¥å…·ä½¿ç”¨">PyInstaller pythonæ‰“åŒ…å·¥å…·ä½¿ç”¨</h1><h2 id="å‚æ•°">å‚æ•°</h2><table><thead><tr class="header"><th>å‚æ•°å</th><th>æè¿°</th><th>è¯´æ˜</th></tr></thead><tbody><tr class="odd"><td>-D</td><td>ç”Ÿæˆone-folderçš„ç¨‹åºï¼ˆé»˜è®¤ï¼‰</td><td>ç”Ÿæˆç»“æœæ˜¯ä¸€ä¸ªç›®å½•ï¼Œå„ç§ç¬¬ä¸‰æ–¹ä¾èµ–ã€èµ„æºå’ŒexeåŒæ—¶å­˜å‚¨åœ¨è¯¥ç›®å½•</td></tr><tr class="even"><td>-F</td><td>ç”Ÿæˆone-fileçš„ç¨‹åº</td><td>ç”Ÿæˆç»“æœæ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œæ‰€æœ‰çš„ç¬¬ä¸‰æ–¹ä¾èµ–ã€èµ„æºå’Œä»£ç å‡è¢«æ‰“åŒ…è¿›è¯¥exeå†…</td></tr><tr class="odd"><td>â€“add-data</td><td>æ‰“åŒ…é¢å¤–èµ„æº</td><td>ç”¨æ³•ï¼špyinstaller main.py--add-data=src;destã€‚windowsä»¥;åˆ†å‰²ï¼ŒmacOS/linuxä»¥:åˆ†å‰²</td></tr><tr class="even"><td>-c</td><td>æ˜¾ç¤ºå‘½ä»¤è¡Œçª—å£</td><td>ä¸-wç›¸åï¼Œé»˜è®¤å«æœ‰æ­¤å‚æ•°</td></tr><tr class="odd"><td>-w</td><td>ä¸æ˜¾ç¤ºå‘½ä»¤è¡Œçª—å£</td><td>ç¼–å†™GUIç¨‹åºæ—¶ä½¿ç”¨æ­¤å‚æ•°æœ‰ç”¨ã€‚</td></tr><tr class="even"><td>-i</td><td>ä¸ºmain.exeæŒ‡å®šå›¾æ ‡</td><td>ç”¨æ³•ï¼špyinstaller -i beauty.ico main.py</td></tr></tbody></table><p>å…·ä½“å‚æ•°çœ‹ï¼šhttps://blog.csdn.net/weixin_39000819/article/details/80942423</p><h2 id="æ‰“åŒ…å›¾ç‰‡ç­‰èµ„æº">æ‰“åŒ…å›¾ç‰‡ç­‰èµ„æº</h2><p>å³ä½¿ä½¿ç”¨äº†<code>â€“add-data</code>å‚æ•°ä¹Ÿå¤§æ¦‚ç‡è¿˜æ˜¯ä¼šå‡ºç°å›¾ç‰‡æ–‡ä»¶æ²¡æœ‰æ‰¾åˆ°çš„æƒ…å†µã€‚</p><p>å› ä¸ºå½“appè¿è¡Œçš„æ—¶å€™ï¼Œä¼šå…ˆ<strong>æŠŠèµ„æºè§£å‹åˆ°ä¸€ä¸ªç³»ç»Ÿçš„ä¸´æ—¶ç›®å½•</strong>ï¼ŒåŒ…æ‹¬æ‰“åŒ…è¿›å»çš„imgæ–‡ä»¶ç­‰ã€‚ä½†æ˜¯ï¼Œæ­¤æ—¶çš„ä»£ç å¹¶ä¸èƒ½ç›´æ¥é€šè¿‡ â€œimg/texture.pngâ€è¿™æ ·çš„ç›¸å¯¹è·¯å¾„æ¥å¾—åˆ°æ–‡ä»¶,åº”è¯¥æ˜¯å› ä¸ºæœ¬èº«ç¨‹åºå°±ä¸åœ¨è¿™é‡Œï¼Œæ‰€ä»¥è‡ªç„¶å¼•ç”¨ä¸åˆ°ã€‚</p><p>è¿™æ—¶éœ€è¦ç”¨åˆ° sys çš„ä¸€ä¸ªåŠç§æœ‰çš„å±æ€§<code>sys._MEIPASS</code>ï¼Œæ ¹æ®å®˜æ–¹çš„è¯´æ˜ï¼Œå®ƒæ˜¯ pyinstallerè¿è¡Œæ—¶åˆ›å»ºçš„<strong>ä¸´æ—¶ç›®å½•çš„ç»å¯¹è·¯å¾„</strong>ã€‚éœ€è¦åœ¨ç¨‹åºè¿è¡Œæ—¶åˆ¤æ–­å½“å‰æ˜¯ä¸æ˜¯æœ‰è¿™ä¸ªå±æ€§ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œä½¿ç”¨ç”Ÿæˆä¸´æ—¶ç›®å½•ä¸‹å›¾ç‰‡çš„ç»å¯¹è·¯å¾„ï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œé‚£å°±ç›´æ¥è¿”å›å½“å‰ç¨‹åºçš„ç»å¯¹è·¯å¾„ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_resource_path</span>(<span class="hljs-params">relative_path</span>):<br>    <span class="hljs-comment"># èµ„æºè·¯å¾„æ‹¼æ¥å½“å‰è¿è¡Œæ—¶ä¸´æ—¶ç›®å½•è·¯å¾„</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">hasattr</span>(sys, <span class="hljs-string">&#x27;_MEIPASS&#x27;</span>):<br>        <span class="hljs-keyword">return</span> os.path.join(sys._MEIPASS, relative_path)<br>    <span class="hljs-keyword">return</span> os.path.join(os.path.abspath(<span class="hljs-string">&quot;.&quot;</span>), relative_path)<br></code></pre></td></tr></table></figure><p>æ¯æ¬¡ç”¨åˆ°å›¾ç‰‡èµ„æºåœ°å€çš„æ—¶å€™éƒ½è°ƒç”¨<code>get_resource_path</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">texture_filename = get_resource_path(<span class="hljs-string">&quot;img/texture.png&quot;</span>)<br>texture = cv2.imread(texture_filename)<br></code></pre></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ï¼ˆwindowsè¦å°†<code>:</code>æ”¹æˆ<code>;</code>ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">pyinstaller --add-data img:img -wF img2sketch.py</span><br></code></pre></td></tr></table></figure><p>åœ¨<code>disk</code>ç›®å½•ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶</p><figure><img src="https://image.yinan.fun/image-20230522162328233.png"alt="image-20230522162328233" /><figcaption aria-hidden="true">image-20230522162328233</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç¨‹</tag>
      
      <tag>Python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Dockerå¸¸ç”¨å‘½ä»¤å¤§å…¨</title>
    <link href="/Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.html"/>
    <url>/Docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%A4%A7%E5%85%A8.html</url>
    
    <content type="html"><![CDATA[<h1 id="dockerå¸¸ç”¨å‘½ä»¤å¤§å…¨">Dockerå¸¸ç”¨å‘½ä»¤å¤§å…¨</h1><h2 id="å¸®åŠ©ç±»å¯åŠ¨å‘½ä»¤">1ã€å¸®åŠ©ç±»å¯åŠ¨å‘½ä»¤</h2><ul><li>å¯åŠ¨dockerï¼š systemctl start docker</li><li>åœæ­¢dockerï¼š systemctl stop docker</li><li>é‡å¯dockerï¼š systemctl restart docker</li><li>æŸ¥çœ‹dockerçŠ¶æ€ï¼š systemctl status docker</li><li>å¼€æœºå¯åŠ¨ï¼š systemctl enable docker</li><li>æŸ¥çœ‹dockeræ¦‚è¦ä¿¡æ¯ï¼š docker info</li><li>æŸ¥çœ‹dockeræ€»ä½“å¸®åŠ©æ–‡æ¡£ï¼š docker --help</li><li>æŸ¥çœ‹dockerå‘½ä»¤å¸®åŠ©æ–‡æ¡£ï¼š docker å…·ä½“å‘½ä»¤ --help</li></ul><h2 id="é•œåƒå‘½ä»¤">2ã€é•œåƒå‘½ä»¤</h2><h3 id="åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ">1ã€åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker images<br></code></pre></td></tr></table></figure><figure><img src="https://image.yinan.fun/7000-20230417102853412.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><p>å„ä¸ªé€‰é¡¹è¯´æ˜:</p><ul><li>REPOSITORYï¼šè¡¨ç¤ºé•œåƒçš„ä»“åº“æº</li><li>TAGï¼šé•œåƒçš„æ ‡ç­¾ç‰ˆæœ¬å·</li><li>IMAGE IDï¼šé•œåƒID</li><li>CREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´</li><li>SIZEï¼šé•œåƒå¤§å°</li></ul><blockquote><p>åŒä¸€ä»“åº“æºå¯ä»¥æœ‰å¤šä¸ª TAGç‰ˆæœ¬ï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨REPOSITORY:TAG æ¥å®šä¹‰ä¸åŒçš„é•œåƒã€‚</p><p>å¦‚æœä½ ä¸æŒ‡å®šä¸€ä¸ªé•œåƒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œä¾‹å¦‚ä½ åªä½¿ç”¨ ubuntuï¼Œdockerå°†é»˜è®¤ä½¿ç”¨ ubuntu:latest é•œåƒ</p></blockquote><p>OPTIONSè¯´æ˜ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">-a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«å†å²æ˜ åƒå±‚ï¼‰<br><br>docker images -a<br><br><br><br>-q :åªæ˜¾ç¤ºé•œåƒIDã€‚<br><br>docker images -q<br></code></pre></td></tr></table></figure><h3 id="æœç´¢é•œåƒ">2ã€æœç´¢é•œåƒ</h3><p>å®˜æ–¹æœç´¢ç½‘å€ï¼šhttps://hub.docker.com/</p><p>å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker search [OPTIONS] é•œåƒåå­—<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker search mysql<br><br>NAME                             DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED<br><br>mysql                            MySQL is a widely used, open-source relationâ€¦   12378     [OK]       <br><br>mariadb                          MariaDB Server is a high performing open souâ€¦   4762      [OK]       <br><br>mysql/mysql-server               Optimized MySQL Server Docker images. Createâ€¦   917                  [OK]<br><br>percona                          Percona Server is a fork of the MySQL relatiâ€¦   572       [OK]       <br><br>phpmyadmin                       phpMyAdmin - A web interface for MySQL and Mâ€¦   494       [OK]       <br><br>mysql/mysql-cluster              Experimental MySQL Cluster Docker images. Crâ€¦   93                   <br><br>centos/mysql-57-centos7          MySQL 5.7 SQL database server                   92                   <br><br>bitnami/mysql                    Bitnami MySQL Docker Image                      68                   [OK]<br><br>ubuntu/mysql                     MySQL open source fast, stable, multi-threadâ€¦   29                   <br><br>circleci/mysql                   MySQL is a widely used, open-source relationâ€¦   25                   <br><br>mysql/mysql-router               MySQL Router provides transparent routing beâ€¦   23                   <br><br>centos/mysql-56-centos7          MySQL 5.6 SQL database server                   22                   <br><br>google/mysql                     MySQL server for Google Compute Engine          21                   [OK]<br><br>vmware/harbor-db                 Mysql container for Harbor                      10                   <br><br>mysqlboy/docker-mydumper         docker-mydumper containerizes MySQL logical â€¦   3                    <br><br>mysqlboy/mydumper                mydumper for mysql logcial backups              3                    <br><br>bitnami/mysqld-exporter                                                          2                    <br><br>ibmcom/mysql-s390x               Docker image for mysql-s390x                    2                    <br><br>mysql/mysql-operator             MySQL Operator for Kubernetes                   0                    <br><br>ibmcom/tidb-ppc64le              TiDB is a distributed NewSQL database compatâ€¦   0                    <br><br>mysqlboy/elasticsearch                                                           0                    <br><br>mysqleatmydata/mysql-eatmydata                                                   0                    <br><br>cimg/mysql                                                                       0                    <br><br>mysql/ndb-operator               MySQL NDB Operator for Kubernetes               0                    <br><br>mirantis/mysql  <br></code></pre></td></tr></table></figure><figure><img src="https://image.yinan.fun/7000.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><h4 id="optionsè¯´æ˜">OPTIONSè¯´æ˜ï¼š</h4><ul><li>--limit : åªåˆ—å‡ºNä¸ªé•œåƒï¼Œé»˜è®¤25ä¸ª</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker search --limit 5 redis<br></code></pre></td></tr></table></figure><h3 id="æ‹‰å–ä¸‹è½½é•œåƒ">3ã€æ‹‰å–ï¼ˆä¸‹è½½ï¼‰é•œåƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker pull æŸä¸ªXXXé•œåƒåå­—<br></code></pre></td></tr></table></figure><ul><li>docker pull æŸä¸ªXXXé•œåƒåå­—:TAG</li><li>docker pull é•œåƒåå­—</li></ul><blockquote><p>æ²¡æœ‰TAGå°±æ˜¯æœ€æ–°ç‰ˆ</p><p>ç­‰ä»·äºï¼šdocker pull é•œåƒåå­—:latest</p></blockquote><h3 id="æŸ¥çœ‹é•œåƒ">4ã€æŸ¥çœ‹é•œåƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker system df æŸ¥çœ‹é•œåƒ/å®¹å™¨/æ•°æ®å·æ‰€å çš„ç©ºé—´<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker system df<br><br>TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE<br><br>Images          1         1         13.26kB   0B (0%)<br><br>Containers      1         0         0B        0B<br><br>Local Volumes   0         0         0B        0B<br><br>Build Cache     0         0         0B        0B<br><br>[root@docker ~]# <br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤é•œåƒ">5ã€åˆ é™¤é•œåƒ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rmi æŸä¸ªXXXé•œåƒåå­—ID<br></code></pre></td></tr></table></figure><h4 id="åˆ é™¤å•ä¸ª">1ã€åˆ é™¤å•ä¸ª</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rmi  -f é•œåƒID<br></code></pre></td></tr></table></figure><h4 id="åˆ é™¤å¤šä¸ª">2ã€åˆ é™¤å¤šä¸ª</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rmi -f é•œåƒå1:TAG é•œåƒå2:TAG <br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤å…¨éƒ¨">3ã€åˆ é™¤å…¨éƒ¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rmi -f $(docker images -qa)<br></code></pre></td></tr></table></figure><h3id="é¢è¯•é¢˜è°ˆè°ˆdockerè™šæ‚¬é•œåƒæ˜¯ä»€ä¹ˆ">6ã€é¢è¯•é¢˜ï¼šè°ˆè°ˆdockerè™šæ‚¬é•œåƒæ˜¯ä»€ä¹ˆï¼Ÿ</h3><blockquote><p>ä»“åº“åã€æ ‡ç­¾éƒ½æ˜¯<none>çš„é•œåƒï¼Œä¿—ç§°è™šæ‚¬é•œåƒdangling image</p></blockquote><figure><img src="https://image.yinan.fun/7000-20230417102853439.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><h2 id="å®¹å™¨å‘½ä»¤">3ã€å®¹å™¨å‘½ä»¤</h2><blockquote><p>æœ‰é•œåƒæ‰èƒ½åˆ›å»ºå®¹å™¨</p></blockquote><figure><img src="https://image.yinan.fun/7000-20230417102853482.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>æœ¬æ¬¡ç”¨centosè¿›è¡Œæ¼”ç¤º</p><h3 id="æ–°å»ºå¯åŠ¨å‘½ä»¤">1ã€æ–°å»º+å¯åŠ¨å‘½ä»¤</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]<br></code></pre></td></tr></table></figure><p>OPTIONSè¯´æ˜ï¼ˆå¸¸ç”¨ï¼‰ï¼šæœ‰äº›æ˜¯ä¸€ä¸ªå‡å·ï¼Œæœ‰äº›æ˜¯ä¸¤ä¸ªå‡å·</p><p>--name="å®¹å™¨æ–°åå­—" ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</p><p>-d: åå°è¿è¡Œå®¹å™¨å¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨(åå°è¿è¡Œ)ï¼›</p><p>-iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</p><p>-tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</p><p>ä¹Ÿå³å¯åŠ¨äº¤äº’å¼å®¹å™¨(å‰å°æœ‰ä¼ªç»ˆç«¯ï¼Œç­‰å¾…äº¤äº’)ï¼›</p><p>-P: éšæœºç«¯å£æ˜ å°„ï¼Œå¤§å†™P</p><p>-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œå°å†™p</p><figure><img src="https://image.yinan.fun/7000-20230417102853467.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><figure><img src="https://image.yinan.fun/7000-20230417102853397.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</p><blockquote><p>#ä½¿ç”¨é•œåƒcentos:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -it centos /bin/bash <br></code></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜ï¼š</p><p>-i: äº¤äº’å¼æ“ä½œã€‚</p><p>-t: ç»ˆç«¯ã€‚</p><p>centos : centos é•œåƒã€‚</p><p>/bin/bashï¼šæ”¾åœ¨é•œåƒååçš„æ˜¯å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸ªäº¤äº’å¼Shellï¼Œå› æ­¤ç”¨çš„æ˜¯ /bin/bashã€‚</p><p>è¦é€€å‡ºç»ˆç«¯ï¼Œç›´æ¥è¾“å…¥ exit:</p><h3 id="åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨">2ã€åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker ps [OPTIONS]<br></code></pre></td></tr></table></figure><blockquote><p>OPTIONSè¯´æ˜ï¼ˆå¸¸ç”¨ï¼‰ï¼š</p><p>-a :åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨+å†å²ä¸Šè¿è¡Œè¿‡çš„</p><p>-l :æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚</p><p>-nï¼šæ˜¾ç¤ºæœ€è¿‘nä¸ªåˆ›å»ºçš„å®¹å™¨ã€‚</p><p>-q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚</p></blockquote><h3 id="é€€å‡ºå®¹å™¨">3ã€é€€å‡ºå®¹å™¨</h3><h4 id="execé€€å‡º">1ã€<code>exec</code>é€€å‡º</h4><blockquote><p>runè¿›å»å®¹å™¨ï¼Œexité€€å‡ºï¼Œå®¹å™¨åœæ­¢</p></blockquote><h4 id="ctrlpq">2ã€<code>ctrl+p+q</code></h4><blockquote><p>runè¿›å»å®¹å™¨ï¼Œctrl+p+qé€€å‡ºï¼Œå®¹å™¨ä¸åœæ­¢</p></blockquote><h3 id="å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨">4ã€å¯åŠ¨å·²åœæ­¢è¿è¡Œçš„å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker start å®¹å™¨IDæˆ–è€…å®¹å™¨å<br></code></pre></td></tr></table></figure><h3 id="é‡å¯å®¹å™¨">5ã€é‡å¯å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker restart å®¹å™¨IDæˆ–è€…å®¹å™¨å<br></code></pre></td></tr></table></figure><h3 id="åœæ­¢å®¹å™¨">6ã€åœæ­¢å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker stop å®¹å™¨IDæˆ–è€…å®¹å™¨å<br></code></pre></td></tr></table></figure><h3 id="å¼ºåˆ¶åœæ­¢å®¹å™¨">7ã€å¼ºåˆ¶åœæ­¢å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker kill å®¹å™¨IDæˆ–å®¹å™¨å<br></code></pre></td></tr></table></figure><h3 id="åˆ é™¤å·²åœæ­¢çš„å®¹å™¨">8ã€åˆ é™¤å·²åœæ­¢çš„å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rm å®¹å™¨ID<br></code></pre></td></tr></table></figure><h4 id="ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå®¹å™¨å®ä¾‹">ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå®¹å™¨å®ä¾‹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker rm -f $(docker ps -a -q)<br><br><br><br>docker ps -a -q | xargs docker rm<br></code></pre></td></tr></table></figure><p><code>docker ps -a -q</code>ï¼šæŸ¥è¯¢è¿›è¡Œçš„å®¹å™¨ID</p><h2 id="å®æ“">4ã€å®æ“</h2><h3 id="å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨åå°æœåŠ¡å™¨">1ã€å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨(åå°æœåŠ¡å™¨)</h3><blockquote><p>åœ¨å¤§éƒ¨åˆ†çš„åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ› docker çš„æœåŠ¡æ˜¯åœ¨åå°è¿è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿‡ -dæŒ‡å®šå®¹å™¨çš„åå°è¿è¡Œæ¨¡å¼ã€‚</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d å®¹å™¨å<br></code></pre></td></tr></table></figure><p>#ä½¿ç”¨é•œåƒcentos:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d centos<br></code></pre></td></tr></table></figure><p>é—®é¢˜ï¼šç„¶ådocker ps -a è¿›è¡ŒæŸ¥çœ‹,ä¼šå‘ç°å®¹å™¨å·²ç»é€€å‡ºå¾ˆé‡è¦çš„è¦è¯´æ˜çš„ä¸€ç‚¹:Dockerå®¹å™¨åå°è¿è¡Œ,å°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹.å®¹å™¨è¿è¡Œçš„å‘½ä»¤å¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚èµ·çš„å‘½ä»¤ï¼ˆæ¯”å¦‚è¿è¡Œtopï¼Œtailï¼‰ï¼Œå°±æ˜¯ä¼šè‡ªåŠ¨é€€å‡ºçš„ã€‚</p><p>è¿™ä¸ªæ˜¯dockerçš„æœºåˆ¶é—®é¢˜,æ¯”å¦‚ä½ çš„webå®¹å™¨,æˆ‘ä»¬ä»¥nginxä¸ºä¾‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬é…ç½®å¯åŠ¨æœåŠ¡åªéœ€è¦å¯åŠ¨å“åº”çš„serviceå³å¯ã€‚ä¾‹å¦‚servicenginxstartä½†æ˜¯,è¿™æ ·åš,nginxä¸ºåå°è¿›ç¨‹æ¨¡å¼è¿è¡Œ,å°±å¯¼è‡´dockerå‰å°æ²¡æœ‰è¿è¡Œçš„åº”ç”¨,è¿™æ ·çš„å®¹å™¨åå°å¯åŠ¨å,ä¼šç«‹å³è‡ªæ€å› ä¸ºä»–è§‰å¾—ä»–æ²¡äº‹å¯åšäº†.æ‰€ä»¥ï¼Œæœ€ä½³çš„è§£å†³æ–¹æ¡ˆæ˜¯,å°†ä½ è¦è¿è¡Œçš„ç¨‹åºä»¥å‰å°è¿›ç¨‹çš„å½¢å¼è¿è¡Œï¼Œå¸¸è§å°±æ˜¯å‘½ä»¤è¡Œæ¨¡å¼ï¼Œè¡¨ç¤ºæˆ‘è¿˜æœ‰äº¤äº’æ“ä½œï¼Œåˆ«ä¸­æ–­ï¼ŒO(âˆ©_âˆ©)Oå“ˆå“ˆ~</p><h4 id="æ¡ˆä¾‹æ¼”ç¤º">æ¡ˆä¾‹æ¼”ç¤º</h4><blockquote><p><ahref="https://cloud.tencent.com/product/crs?from=20065&amp;from_column=20065">redis</a>å‰åå°å¯åŠ¨æ¼”ç¤ºcaseï¼ˆä¸‹è½½ä¸€ä¸ªRedis6.0.8é•œåƒæ¼”ç¤ºï¼‰</p></blockquote><ul><li>å‰å°äº¤äº’å¼å¯åŠ¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -it redis<br></code></pre></td></tr></table></figure><ul><li>åå°å®ˆæŠ¤å¼å¯åŠ¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker run -d redis<br></code></pre></td></tr></table></figure><p>PSï¼šå¯åŠ¨å®¹å™¨åï¼Œå…ˆæŸ¥çœ‹å®¹å™¨æ˜¯å¦å¯åŠ¨æ­£å¸¸ï¼Œå¾€å¾€ä¼´éšç€<code>docker ps</code></p><h3 id="æŸ¥çœ‹å®¹å™¨æ—¥å¿—">2ã€æŸ¥çœ‹å®¹å™¨æ—¥å¿—</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker logs å®¹å™¨ID<br></code></pre></td></tr></table></figure><p>PSï¼šå®¹å™¨IDå¯çœç•¥ä¸ºå‰ä¸‰ä½</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker ps <br><br>CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS      NAMES<br><br>94b526c73db2   redis     &quot;docker-entrypoint.sâ€¦&quot;   4 seconds ago   Up 3 seconds   6379/tcp   admiring\_poincare<br><br>[root@docker ~]# docker logs 94b<br><br>1:C 10 Apr 2022 09:50:03.396 # oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo<br><br>1:C 10 Apr 2022 09:50:03.396 # Redis version=6.2.6, bits=64, commit=00000000, modified=0, pid=1, just started<br><br>1:C 10 Apr 2022 09:50:03.396 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf<br><br>1:M 10 Apr 2022 09:50:03.397 \* monotonic clock: POSIX clock\_gettime<br><br>1:M 10 Apr 2022 09:50:03.398 \* Running mode=standalone, port=6379.<br><br>1:M 10 Apr 2022 09:50:03.399 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.<br><br>1:M 10 Apr 2022 09:50:03.399 # Server initialized<br><br>1:M 10 Apr 2022 09:50:03.399 # WARNING overcommit\_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#x27;vm.overcommit\_memory = 1&#x27; to /etc/sysctl.conf and then reboot or run the command &#x27;sysctl vm.overcommit\_memory=1&#x27; for this to take effect.<br><br>1:M 10 Apr 2022 09:50:03.399 \* Ready to accept connections<br><br>[root@docker ~]# <br></code></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹">3ã€æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker top å®¹å™¨ID<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker top 94b<br><br>UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD<br><br>polkitd             35360               35341               0                   17:50               ?                   00:00:00            redis-server \*:6379<br></code></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å®¹å™¨å†…éƒ¨ç»†èŠ‚">4ã€æŸ¥çœ‹å®¹å™¨å†…éƒ¨ç»†èŠ‚</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker inspect å®¹å™¨ID<br></code></pre></td></tr></table></figure><h3 id="è¿›å…¥å®¹å™¨å†…éƒ¨">5ã€è¿›å…¥å®¹å™¨å†…éƒ¨</h3><h4 id="ä½¿ç”¨execè¿›å…¥å®¹å™¨">1ã€ä½¿ç”¨<code>exec</code>è¿›å…¥å®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker exec -it å®¹å™¨ID bashShell<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker exec -it 94b /bin/bash<br><br>root@94b526c73db2:/data# redis-c<br><br>redis-check-aof  redis-check-rdb  redis-cli        <br><br>root@94b526c73db2:/data# redis-cli <br><br>127.0.0.1:6379&gt; ping<br><br>PONG<br><br>127.0.0.1:6379&gt; set k1 v1<br><br>OK<br><br>127.0.0.1:6379&gt; get k1<br><br>&quot;v1&quot;<br><br>127.0.0.1:6379&gt; exit<br></code></pre></td></tr></table></figure><p>execå¸®åŠ©å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker ~]# docker exec --help<br><br><br><br>Usage:  docker exec [OPTIONS] CONTAINER COMMAND [ARG...]<br><br><br><br>Run a command in a running containe<br><br><br><br>Options:<br><br>  -d, --detach               Detached mode: run command in the background<br><br>      --detach-keys string   Override the key sequence for detaching a containe<br><br>  -e, --env list             Set environment variables<br><br>      --env-file list        Read in a file of environment variables<br><br>  -i, --interactive          Keep STDIN open even if not attached<br><br>      --privileged           Give extended privileges to the command<br><br>  -t, --tty                  Allocate a pseudo-TTY<br><br>  -u, --user string          Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])<br><br>  -w, --workdir string       Working directory inside the containe<br><br>[root@docker ~]# <br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨attachè¿›å…¥å®¹å™¨">2ã€ä½¿ç”¨<code>attach</code>è¿›å…¥å®¹å™¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker attach å®¹å™¨ID<br></code></pre></td></tr></table></figure><h4 id="ä¸¤è€…çš„åŒºåˆ«">3ã€ä¸¤è€…çš„åŒºåˆ«</h4><ul><li>attachç›´æ¥è¿›å…¥å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹ï¼Œç”¨exité€€å‡ºï¼Œä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚</li><li>execæ˜¯åœ¨å®¹å™¨ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥å¯åŠ¨æ–°çš„è¿›ç¨‹ï¼Œç”¨exité€€å‡ºï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚</li></ul><p>PSï¼šæ¨èå¤§å®¶ä½¿ç”¨<code>docker exec</code>å‘½ä»¤ï¼Œå› ä¸ºé€€å‡ºå®¹å™¨ç»ˆç«¯ï¼Œä¸ä¼šå¯¼è‡´å®¹å™¨çš„åœæ­¢ã€‚</p><h2 id="ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Š">5ã€ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Š</h2><blockquote><p>æŠŠæ–‡ä»¶ä»å®¹å™¨å†…éƒ¨å¤åˆ¶åˆ°ä¸»æœºä¸Š</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker cp  å®¹å™¨ID:å®¹å™¨å†…è·¯å¾„ ç›®çš„ä¸»æœºè·¯å¾„<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker cp 3065f084c80d:a.txt a.txt<br></code></pre></td></tr></table></figure><h2 id="å¯¼å…¥å’Œå¯¼å‡ºå®¹å™¨">6ã€å¯¼å…¥å’Œå¯¼å‡ºå®¹å™¨</h2><h3 id="å¯¼å‡ºå®¹å™¨">1ã€å¯¼å‡ºå®¹å™¨</h3><blockquote><p>export å¯¼å‡ºå®¹å™¨çš„å†…å®¹ç•™ä½œä¸ºä¸€ä¸ªtarå½’æ¡£æ–‡ä»¶å¯¹åº”importå‘½ä»¤</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">docker export å®¹å™¨ID &gt; æ–‡ä»¶å.ta<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker /]# docker export 3065f084c80d &gt; centos.tar.gz<br><br>[root@docker /]# ll<br><br>æ€»ç”¨é‡ 233004<br><br>-rw-r--r--.   1 root root         0 4æœˆ  10 18:16 a.txt<br><br>lrwxrwxrwx.   1 root root         7 4æœˆ   9 15:59 bin -&gt; usr/bin<br><br>dr-xr-xr-x.   5 root root      4096 4æœˆ   9 16:06 boot<br><br>-rw-r--r--.   1 root root 238572032 4æœˆ  10 19:04 centos.tar.gz<br><br>drwxr-xr-x.  20 root root      3220 4æœˆ   9 16:29 dev<br><br>drwxr-xr-x.  86 root root      8192 4æœˆ  10 11:03 etc<br><br>drwxr-xr-x.   3 root root        22 4æœˆ   9 16:05 home<br><br>lrwxrwxrwx.   1 root root         7 4æœˆ   9 15:59 lib -&gt; usr/lib<br><br>lrwxrwxrwx.   1 root root         9 4æœˆ   9 15:59 lib64 -&gt; usr/lib64<br><br>drwxr-xr-x.   2 root root         6 4æœˆ  11 2018 media<br><br>drwxr-xr-x.   2 root root         6 4æœˆ  11 2018 mnt<br><br>drwxr-xr-x.   4 root root        34 4æœˆ   9 20:38 opt<br><br>dr-xr-xr-x. 124 root root         0 4æœˆ   9 16:29 proc<br><br>dr-xr-x---.   5 root root       176 4æœˆ   9 20:36 root<br><br>drwxr-xr-x.  31 root root       940 4æœˆ   9 21:01 run<br><br>lrwxrwxrwx.   1 root root         8 4æœˆ   9 15:59 sbin -&gt; usr/sbin<br><br>drwxr-xr-x.   2 root root         6 4æœˆ  11 2018 srv<br><br>dr-xr-xr-x.  13 root root         0 4æœˆ   9 16:29 sys<br><br>drwxrwxrwt.  13 root root      4096 4æœˆ  10 18:16 tmp<br><br>drwxr-xr-x.  13 root root       155 4æœˆ   9 15:59 us<br></code></pre></td></tr></table></figure><h3 id="å¯¼å…¥å®¹å™¨">2ã€å¯¼å…¥å®¹å™¨</h3><blockquote><p>import ä»taråŒ…ä¸­çš„å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿå†å¯¼å…¥ä¸ºé•œåƒå¯¹åº”export</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">cat æ–‡ä»¶å.tar | docker import - é•œåƒç”¨æˆ·/é•œåƒå:é•œåƒç‰ˆæœ¬å·<br></code></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@docker /]# cat centos.tar.gz | docker import - xiaobear/centos:8.8<br><br>sha256:12e7a58fc36a755fa63a82f78364291de7271c3ade90f2f5581cc50bc2416cb2<br><br>[root@docker /]# docker images<br><br>REPOSITORY        TAG       IMAGE ID       CREATED              SIZE<br><br>xiaobear/centos   8.8       12e7a58fc36a   About a minute ago   231MB<br><br>redis             latest    7614ae9453d1   3 months ago         113MB<br><br>hello-world       latest    feb5d9fea6a5   6 months ago         13.3kB<br><br>centos            latest    5d0da3dc9764   6 months ago         231MB<br><br>[root@docker /]# <br></code></pre></td></tr></table></figure><h2 id="å¸¸ç”¨å‘½ä»¤æ±‡æ€»">7ã€å¸¸ç”¨å‘½ä»¤æ±‡æ€»</h2><figure><img src="https://image.yinan.fun/7000-20230417102853593.png"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><table><thead><tr class="header"><th>å‘½ä»¤</th><th>è‹±æ–‡</th><th>ä¸­æ–‡</th></tr></thead><tbody><tr class="odd"><td>attach</td><td>Attach to a running container</td><td>å½“å‰ shell ä¸‹ attach è¿æ¥æŒ‡å®šè¿è¡Œé•œåƒ</td></tr><tr class="even"><td>build</td><td>Build an image from a Dockerfile</td><td>é€šè¿‡ Dockerfile å®šåˆ¶é•œåƒ</td></tr><tr class="odd"><td>commit</td><td>Create a new image from a container changes</td><td>æäº¤å½“å‰å®¹å™¨ä¸ºæ–°çš„é•œåƒ</td></tr><tr class="even"><td>cp</td><td>Copy files/folders from the containers filesystem to the hostpath</td><td>å®¹å™¨ä¸­æ‹·è´æŒ‡å®šæ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¿ä¸»æœºä¸­</td></tr><tr class="odd"><td>create</td><td>Create a new container</td><td>åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼ŒåŒ runï¼Œä½†ä¸å¯åŠ¨å®¹å™¨</td></tr><tr class="even"><td>diff</td><td>Inspect changes on a container's filesystem</td><td>æŸ¥çœ‹ docker å®¹å™¨å˜åŒ–</td></tr><tr class="odd"><td>events</td><td>Get real time events from the server</td><td>ä» docker æœåŠ¡è·å–å®¹å™¨å®æ—¶äº‹ä»¶</td></tr><tr class="even"><td>exec</td><td>Run a command in an existing container</td><td>åœ¨å·²å­˜åœ¨çš„å®¹å™¨ä¸Šè¿è¡Œå‘½ä»¤</td></tr><tr class="odd"><td>export</td><td>Stream the contents of a container as a tar archive</td><td>å¯¼å‡ºå®¹å™¨çš„å†…å®¹æµä½œä¸ºä¸€ä¸ª tar å½’æ¡£æ–‡ä»¶å¯¹åº” import</td></tr><tr class="even"><td>images</td><td>List images</td><td>åˆ—å‡ºç³»ç»Ÿå½“å‰é•œåƒ</td></tr><tr class="odd"><td>import</td><td>Create a new filesystem image from the contents of a tarball</td><td>ä»taråŒ…ä¸­çš„å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿæ˜ åƒå¯¹åº”export</td></tr><tr class="even"><td>info</td><td>Display system-wide information</td><td>æ˜¾ç¤ºç³»ç»Ÿç›¸å…³ä¿¡æ¯</td></tr><tr class="odd"><td>inspect</td><td>Return low-level information on a container</td><td>æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</td></tr><tr class="even"><td>kill</td><td>Kill a running container</td><td>kill æŒ‡å®š docker å®¹å™¨</td></tr><tr class="odd"><td>load</td><td>Load an image from a tar archive</td><td>ä»ä¸€ä¸ª tar åŒ…ä¸­åŠ è½½ä¸€ä¸ªé•œåƒå¯¹åº” save</td></tr><tr class="even"><td>login</td><td>Register or Login to the docker registry server</td><td>æ³¨å†Œæˆ–è€…ç™»é™†ä¸€ä¸ª docker æºæœåŠ¡å™¨</td></tr><tr class="odd"><td>logout</td><td>Log out from a Docker registry server</td><td>ä»å½“å‰ Docker registry é€€å‡º</td></tr><tr class="even"><td>logs</td><td>Fetch the logs of a container</td><td>è¾“å‡ºå½“å‰å®¹å™¨æ—¥å¿—ä¿¡æ¯</td></tr><tr class="odd"><td>port</td><td>Lookup the public-facing port which is NAT-ed to PRIVATE_PORT</td><td>æŸ¥çœ‹æ˜ å°„ç«¯å£å¯¹åº”çš„å®¹å™¨å†…éƒ¨æºç«¯å£</td></tr><tr class="even"><td>pause</td><td>Pause all processes within a container</td><td>æš‚åœå®¹å™¨</td></tr><tr class="odd"><td>ps</td><td>List containers</td><td>åˆ—å‡ºå®¹å™¨åˆ—è¡¨</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç¨‹</tag>
      
      <tag>Docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2. æ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</title>
    <link href="/2.%20%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%EF%BC%9A%E4%B8%80%E6%9D%A1SQL%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F.html"/>
    <url>/2.%20%E6%97%A5%E5%BF%97%E7%B3%BB%E7%BB%9F%EF%BC%9A%E4%B8%80%E6%9D%A1SQL%E6%9B%B4%E6%96%B0%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="æ—¥å¿—ç³»ç»Ÿä¸€æ¡sqlæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„">2.æ—¥å¿—ç³»ç»Ÿï¼šä¸€æ¡SQLæ›´æ–°è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</h2><p>ä¸æŸ¥è¯¢æµç¨‹ä¸ä¸€æ ·çš„æ˜¯ï¼Œæ›´æ–°æµç¨‹è¿˜æ¶‰åŠä¸¤ä¸ªé‡è¦çš„æ—¥å¿—æ¨¡å—ï¼š<strong>redologï¼ˆé‡åšæ—¥å¿—ï¼‰å’Œ binlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰</strong>ã€‚</p><h3 id="redo-log">2.1 redo log</h3><p>å¦‚æœ<strong>æ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜</strong>ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹<strong>IOæˆæœ¬ã€æŸ¥æ‰¾æˆæœ¬éƒ½å¾ˆé«˜</strong>ã€‚</p><p><strong>WAL</strong>çš„å…¨ç§°æ˜¯Write-AheadLoggingï¼Œå®ƒçš„å…³é”®ç‚¹å°±æ˜¯<strong>å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜</strong>ã€‚</p><p>å½“æœ‰ä¸€æ¡è®°å½•éœ€è¦<strong>æ›´æ–°</strong>çš„æ—¶å€™ï¼ŒInnoDBå¼•æ“å°±ä¼š<strong>å…ˆæŠŠè®°å½•å†™åˆ°redolog</strong>é‡Œé¢ï¼Œå¹¶<strong>æ›´æ–°å†…å­˜</strong>ï¼Œè¿™ä¸ªæ—¶å€™æ›´æ–°å°±ç®—å®Œæˆäº†ã€‚åŒæ—¶ï¼ŒInnoDBå¼•æ“ä¼šåœ¨é€‚å½“çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªæ“ä½œè®°å½•<strong>æ›´æ–°åˆ°ç£ç›˜é‡Œé¢</strong>ï¼Œè€Œè¿™ä¸ªæ›´æ–°å¾€å¾€æ˜¯åœ¨ç³»ç»Ÿæ¯”è¾ƒ<strong>ç©ºé—²</strong>çš„æ—¶å€™åšã€‚</p><p>InnoDBçš„redologæ˜¯å›ºå®šå¤§å°çš„ï¼Œæ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„4ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯1GBï¼Œé‚£ä¹ˆæ€»å…±å°±å¯ä»¥è®°å½•4GBçš„æ“ä½œã€‚ä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾å°±åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ï¼Œå¦‚ä¸‹é¢è¿™ä¸ªå›¾æ‰€ç¤º</p><figure><img src="https://image.yinan.fun/image-20230508202933697.png"alt="image-20230508202933697" /><figcaption aria-hidden="true">image-20230508202933697</figcaption></figure><p><strong>writepos</strong>æ˜¯<strong>å½“å‰è®°å½•çš„ä½ç½®</strong>ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬3å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ°0å·æ–‡ä»¶å¼€å¤´ã€‚<strong>checkpoint</strong>æ˜¯<strong>å½“å‰è¦æ“¦é™¤çš„ä½ç½®</strong>ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°æ•°æ®æ–‡ä»¶ã€‚</p><p>write poså’Œcheckpointä¹‹é—´çš„æ˜¯redologä¸Šè¿˜ç©ºç€çš„éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å¦‚æœwriteposè¿½ä¸Šcheckpointï¼Œè¡¨ç¤ºredologè¿™æ—¶å€™ä¸èƒ½å†æ‰§è¡Œæ–°çš„æ›´æ–°ï¼Œå¾—åœä¸‹æ¥å…ˆæ“¦æ‰ä¸€äº›è®°å½•ï¼ŒæŠŠcheckpointæ¨è¿›ä¸€ä¸‹ã€‚</p><p>æœ‰äº†redologï¼ŒInnoDBå°±å¯ä»¥ä¿è¯<strong>å³ä½¿æ•°æ®åº“å‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¹‹å‰æäº¤çš„è®°å½•éƒ½ä¸ä¼šä¸¢å¤±</strong>ï¼Œè¿™ä¸ªèƒ½åŠ›ç§°ä¸º<strong>crash-safe</strong>ã€‚</p><h3 id="binlog">2.2 binlog</h3><p>redologæ˜¯InnoDBå¼•æ“ç‰¹æœ‰çš„æ—¥å¿—ï¼Œè€Œ<strong>Serverå±‚</strong>ä¹Ÿæœ‰è‡ªå·±çš„æ—¥å¿—ï¼Œç§°ä¸ºbinlogï¼ˆå½’æ¡£æ—¥å¿—ï¼‰ã€‚</p><p>è¿™ä¸¤ç§æ—¥å¿—æœ‰ä»¥ä¸‹ä¸‰ç‚¹ä¸åŒã€‚</p><ol type="1"><li><p>redologæ˜¯<strong>InnoDBå¼•æ“ç‰¹æœ‰</strong>çš„ï¼›binlogæ˜¯<strong>MySQLçš„Serverå±‚å®ç°</strong>çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</p></li><li><p>redologæ˜¯<strong>ç‰©ç†æ—¥å¿—</strong>ï¼Œè®°å½•çš„æ˜¯â€œåœ¨æŸä¸ªæ•°æ®é¡µä¸Š<strong>åšäº†ä»€ä¹ˆä¿®æ”¹</strong>â€ï¼›binlogæ˜¯<strong>é€»è¾‘æ—¥å¿—</strong>ï¼Œè®°å½•çš„æ˜¯è¿™ä¸ª<strong>è¯­å¥çš„åŸå§‹é€»è¾‘</strong>ï¼Œæ¯”å¦‚â€œç»™ID=2è¿™ä¸€è¡Œçš„cå­—æ®µåŠ 1â€ã€‚</p></li><li><p>redologæ˜¯<strong>å¾ªç¯å†™</strong>çš„ï¼Œç©ºé—´å›ºå®šä¼šç”¨å®Œï¼›binlogæ˜¯å¯ä»¥<strong>è¿½åŠ å†™å…¥</strong>çš„ã€‚â€œè¿½åŠ å†™â€æ˜¯æŒ‡binlogæ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶<strong>ä¸ä¼šè¦†ç›–</strong>ä»¥å‰çš„æ—¥å¿—ã€‚</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; create table T(ID int primary key, c int);<br>mysql&gt; update T set c=c+1 where ID=2;<br></code></pre></td></tr></table></figure><p>æ‰§è¡Œå™¨å’ŒInnoDBå¼•æ“åœ¨æ‰§è¡Œè¿™ä¸ªç®€å•çš„updateè¯­å¥æ—¶çš„å†…éƒ¨æµç¨‹ã€‚</p><ol type="1"><li><p>æ‰§è¡Œå™¨å…ˆ<strong>æ‰¾å¼•æ“å–ID=2è¿™ä¸€è¡Œ</strong>ã€‚IDæ˜¯ä¸»é”®ï¼Œå¼•æ“ç›´æ¥ç”¨æ ‘æœç´¢æ‰¾åˆ°è¿™ä¸€è¡Œã€‚å¦‚æœID=2è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æ¥è¿”å›ç»™æ‰§è¡Œå™¨ï¼›å¦åˆ™ï¼Œéœ€è¦å…ˆä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œç„¶åå†è¿”å›ã€‚</p></li><li><p>æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“ç»™çš„è¡Œæ•°æ®ï¼Œ<strong>æŠŠè¿™ä¸ªå€¼åŠ ä¸Š1</strong>ï¼Œæ¯”å¦‚åŸæ¥æ˜¯Nï¼Œç°åœ¨å°±æ˜¯N+1ï¼Œå¾—åˆ°æ–°çš„ä¸€è¡Œæ•°æ®ï¼Œå†<strong>è°ƒç”¨å¼•æ“æ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®</strong>ã€‚</p></li><li><p><strong>å¼•æ“</strong>å°†è¿™è¡Œæ–°æ•°æ®<strong>æ›´æ–°åˆ°å†…å­˜</strong>ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œ<strong>è®°å½•åˆ°redolog</strong>é‡Œé¢ï¼Œæ­¤æ—¶redologå¤„äº<strong>prepareçŠ¶æ€</strong>ã€‚ç„¶åå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚</p></li><li><p><strong>æ‰§è¡Œå™¨</strong>ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„binlogï¼Œå¹¶æŠŠ<strong>binlogå†™å…¥ç£ç›˜</strong>ã€‚</p></li><li><p>æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œå¼•æ“æŠŠåˆšåˆšå†™å…¥çš„redologæ”¹æˆ<strong>æäº¤ï¼ˆcommitï¼‰çŠ¶æ€</strong>ï¼Œæ›´æ–°å®Œæˆã€‚</p></li></ol><p>è¿™é‡Œæˆ‘ç»™å‡ºè¿™ä¸ªupdateè¯­å¥çš„æ‰§è¡Œæµç¨‹å›¾ï¼Œå›¾ä¸­æµ…è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨InnoDBå†…éƒ¨æ‰§è¡Œçš„ï¼Œæ·±è‰²æ¡†è¡¨ç¤ºæ˜¯åœ¨æ‰§è¡Œå™¨ä¸­æ‰§è¡Œçš„</p><figure><img src="https://image.yinan.fun/image-20230508202945483.png"alt="image-20230508202945483" /><figcaption aria-hidden="true">image-20230508202945483</figcaption></figure><p>å°†redologçš„å†™å…¥æ‹†æˆäº†ä¸¤ä¸ªæ­¥éª¤ï¼šprepareå’Œcommitï¼Œè¿™å°±æ˜¯"ä¸¤é˜¶æ®µæäº¤"ã€‚</p><h3 id="ä¸¤é˜¶æ®µæäº¤">2.3 ä¸¤é˜¶æ®µæäº¤</h3><p>ä¸ºä»€ä¹ˆå¿…é¡»æœ‰â€œä¸¤é˜¶æ®µæäº¤â€å‘¢ï¼Ÿè¿™æ˜¯ä¸ºäº†<strong>è®©ä¸¤ä»½æ—¥å¿—ä¹‹é—´çš„é€»è¾‘ä¸€è‡´</strong>ã€‚</p><p>å½“éœ€è¦æ•°æ®åº“<strong>æ¢å¤åˆ°æŒ‡å®šçš„æŸä¸€ç§’</strong>æ—¶ï¼Œæ¯”å¦‚æŸå¤©ä¸‹åˆä¸¤ç‚¹å‘ç°ä¸­åˆåäºŒç‚¹æœ‰ä¸€æ¬¡è¯¯åˆ è¡¨ï¼Œéœ€è¦æ‰¾å›æ•°æ®ï¼Œé‚£ä½ å¯ä»¥è¿™ä¹ˆåšï¼š</p><ul><li><p>é¦–å…ˆï¼Œæ‰¾åˆ°<strong>æœ€è¿‘çš„ä¸€æ¬¡å…¨é‡å¤‡ä»½</strong>ï¼Œå¦‚æœä½ è¿æ°”å¥½ï¼Œå¯èƒ½å°±æ˜¯æ˜¨å¤©æ™šä¸Šçš„ä¸€ä¸ªå¤‡ä»½ï¼Œä»è¿™ä¸ªå¤‡ä»½æ¢å¤åˆ°ä¸´æ—¶åº“ï¼›</p></li><li><p>ç„¶åï¼Œä»å¤‡ä»½çš„æ—¶é—´ç‚¹å¼€å§‹ï¼Œ<strong>å°†å¤‡ä»½çš„binlogä¾æ¬¡å–å‡ºæ¥</strong>ï¼Œé‡æ”¾åˆ°ä¸­åˆè¯¯åˆ è¡¨ä¹‹å‰çš„é‚£ä¸ªæ—¶åˆ»ã€‚</p></li></ul><p>ç”±äºredologå’Œbinlogæ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„é€»è¾‘ï¼Œå¦‚æœä¸ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œè¦ä¹ˆå°±æ˜¯å…ˆå†™å®Œredologå†å†™binlogï¼Œæˆ–è€…é‡‡ç”¨åè¿‡æ¥çš„é¡ºåºã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸¤ç§æ–¹å¼ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ã€‚</p><p>ä»ç„¶ç”¨å‰é¢çš„updateè¯­å¥æ¥åšä¾‹å­ã€‚å‡è®¾å½“å‰ID=2çš„è¡Œï¼Œå­—æ®µcçš„å€¼æ˜¯0ï¼Œå†å‡è®¾æ‰§è¡Œupdateè¯­å¥è¿‡ç¨‹ä¸­åœ¨å†™å®Œç¬¬ä¸€ä¸ªæ—¥å¿—åï¼Œç¬¬äºŒä¸ªæ—¥å¿—è¿˜æ²¡æœ‰å†™å®ŒæœŸé—´å‘ç”Ÿäº†crashï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ</p><ol type="1"><li><strong>å…ˆå†™å…ˆ redo logåå†™å binlog</strong>ã€‚å‡è®¾åœ¨redologå†™å®Œï¼Œbinlogè¿˜æ²¡æœ‰å†™å®Œçš„æ—¶å€™ï¼ŒMySQLè¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚ç”±äºæˆ‘ä»¬å‰é¢è¯´è¿‡çš„ï¼Œredologå†™å®Œä¹‹åï¼Œç³»ç»Ÿå³ä½¿å´©æºƒï¼Œä»ç„¶èƒ½å¤ŸæŠŠæ•°æ®æ¢å¤å›æ¥ï¼Œæ‰€ä»¥æ¢å¤åè¿™ä¸€è¡Œcçš„å€¼æ˜¯1ã€‚ä½†æ˜¯ç”±äºbinlogæ²¡å†™å®Œå°±crashäº†ï¼Œè¿™æ—¶å€™binlogé‡Œé¢å°±æ²¡æœ‰è®°å½•è¿™ä¸ªè¯­å¥ã€‚å› æ­¤ï¼Œä¹‹åå¤‡ä»½æ—¥å¿—çš„æ—¶å€™ï¼Œå­˜èµ·æ¥çš„binlogé‡Œé¢å°±æ²¡æœ‰è¿™æ¡è¯­å¥ã€‚ç„¶åä½ ä¼šå‘ç°ï¼Œå¦‚æœéœ€è¦ç”¨è¿™ä¸ªbinlogæ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºè¿™ä¸ªè¯­å¥çš„binlogä¸¢å¤±ï¼Œè¿™ä¸ªä¸´æ—¶åº“å°±ä¼šå°‘äº†è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œcçš„å€¼å°±æ˜¯0ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚</li><li><strong>å…ˆå†™å…ˆ binlogåå†™å redolog</strong>ã€‚å¦‚æœåœ¨binlogå†™å®Œä¹‹åcrashï¼Œç”±äºredologè¿˜æ²¡å†™ï¼Œå´©æºƒæ¢å¤ä»¥åè¿™ä¸ªäº‹åŠ¡æ— æ•ˆï¼Œæ‰€ä»¥è¿™ä¸€è¡Œcçš„å€¼æ˜¯0ã€‚ä½†æ˜¯binlogé‡Œé¢å·²ç»è®°å½•äº†â€œæŠŠcä»0æ”¹æˆ1â€è¿™ä¸ªæ—¥å¿—ã€‚æ‰€ä»¥ï¼Œåœ¨ä¹‹åç”¨binlogæ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†ä¸€ä¸ªäº‹åŠ¡å‡ºæ¥ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œcçš„å€¼å°±æ˜¯1ï¼Œä¸åŸåº“çš„å€¼ä¸åŒã€‚</li></ol><p>å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¸ä½¿ç”¨â€œä¸¤é˜¶æ®µæäº¤â€ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„çŠ¶æ€å°±æœ‰å¯èƒ½å’Œç”¨å®ƒçš„æ—¥å¿—æ¢å¤å‡ºæ¥çš„åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚</p><p>ç®€å•è¯´ï¼Œredologå’Œbinlogéƒ½å¯ä»¥ç”¨äºè¡¨ç¤ºäº‹åŠ¡çš„æäº¤çŠ¶æ€ï¼Œè€Œä¸¤é˜¶æ®µæäº¤å°±æ˜¯<strong>è®©è¿™ä¸¤ä¸ªçŠ¶æ€ä¿æŒé€»è¾‘ä¸Šçš„ä¸€è‡´</strong>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç¨‹</tag>
      
      <tag>æ•°æ®åº“</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>1. åŸºç¡€æ¶æ„ï¼šä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</title>
    <link href="/1.%20%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%EF%BC%9A%E4%B8%80%E6%9D%A1SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F.html"/>
    <url>/1.%20%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84%EF%BC%9A%E4%B8%80%E6%9D%A1SQL%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E7%9A%84%EF%BC%9F.html</url>
    
    <content type="html"><![CDATA[<h2 id="åŸºç¡€æ¶æ„ä¸€æ¡sqlæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„">1.åŸºç¡€æ¶æ„ï¼šä¸€æ¡SQLæŸ¥è¯¢è¯­å¥æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</h2><p>ä¸‹é¢æ˜¯<strong>MySQLçš„åŸºæœ¬æ¶æ„</strong>ç¤ºæ„å›¾ï¼Œä»ä¸­ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°SQLè¯­å¥åœ¨MySQLçš„å„ä¸ªåŠŸèƒ½æ¨¡å—ä¸­çš„æ‰§è¡Œè¿‡ç¨‹ã€‚</p><figure><imgsrc="https://image.yinan.fun/f6b1fbd6cbe8b2592a8d535221e7b51d-20230504093007977.png"alt="image-20230308152659467" /><figcaption aria-hidden="true">image-20230308152659467</figcaption></figure><p>MySQLå¯ä»¥åˆ†ä¸º<strong>Serverå±‚</strong>å’Œ<strong>å­˜å‚¨å¼•æ“å±‚</strong>ä¸¤éƒ¨åˆ†ã€‚</p><ol type="1"><li><p>Serverå±‚åŒ…æ‹¬è¿æ¥å™¨ã€æŸ¥è¯¢ç¼“å­˜ã€åˆ†æå™¨ã€ä¼˜åŒ–å™¨ã€æ‰§è¡Œå™¨ç­‰ï¼Œæ¶µç›–MySQLçš„å¤§å¤šæ•°<strong>æ ¸å¿ƒæœåŠ¡åŠŸèƒ½</strong>ï¼Œä»¥åŠæ‰€æœ‰çš„<strong>å†…ç½®å‡½æ•°</strong>ï¼ˆå¦‚æ—¥æœŸã€æ—¶é—´ã€æ•°å­¦å’ŒåŠ å¯†å‡½æ•°ç­‰ï¼‰ï¼Œæ‰€æœ‰<strong>è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½</strong>éƒ½åœ¨è¿™ä¸€å±‚å®ç°ï¼Œæ¯”å¦‚å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ã€è§†å›¾ç­‰ã€‚</p></li><li><p>å­˜å‚¨å¼•æ“å±‚è´Ÿè´£<strong>æ•°æ®çš„å­˜å‚¨å’Œæå–</strong>ã€‚å…¶æ¶æ„æ¨¡å¼æ˜¯æ’ä»¶å¼çš„ï¼Œæ”¯æŒInnoDBã€MyISAMã€Memoryç­‰å¤šä¸ªå­˜å‚¨å¼•æ“ã€‚ç°åœ¨æœ€å¸¸ç”¨çš„å­˜å‚¨å¼•æ“æ˜¯InnoDBï¼Œå®ƒä»MySQL5.5.5ç‰ˆæœ¬å¼€å§‹æˆä¸ºäº†é»˜è®¤å­˜å‚¨å¼•æ“ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ æ‰§è¡Œcreatetableå»ºè¡¨çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šå¼•æ“ç±»å‹ï¼Œ<strong>é»˜è®¤ä½¿ç”¨çš„å°±æ˜¯InnoDB</strong>ã€‚ä¸è¿‡ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®šå­˜å‚¨å¼•æ“çš„ç±»å‹æ¥é€‰æ‹©åˆ«çš„å¼•æ“ï¼Œæ¯”å¦‚åœ¨<code>create table</code>è¯­å¥ä¸­ä½¿ç”¨<code>engine=memory</code>,æ¥æŒ‡å®šä½¿ç”¨å†…å­˜å¼•æ“åˆ›å»ºè¡¨ã€‚ä¸åŒå­˜å‚¨å¼•æ“çš„è¡¨æ•°æ®å­˜å–æ–¹å¼ä¸åŒï¼Œæ”¯æŒçš„åŠŸèƒ½ä¹Ÿä¸åŒã€‚</p></li></ol><h3 id="è¿æ¥å™¨">1.1 è¿æ¥å™¨</h3><p>è¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€è·å–æƒé™ã€ç»´æŒå’Œç®¡ç†è¿æ¥ã€‚è¿æ¥å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mysql -h$ip -P$port -u$user -p<br></code></pre></td></tr></table></figure><p>è¿æ¥å‘½ä»¤ä¸­çš„mysqlæ˜¯<strong>å®¢æˆ·ç«¯å·¥å…·</strong>ï¼Œç”¨æ¥è·ŸæœåŠ¡ç«¯å»ºç«‹è¿æ¥ã€‚åœ¨å®Œæˆç»å…¸çš„TCPæ¡æ‰‹åï¼Œè¿æ¥å™¨å°±è¦å¼€å§‹è®¤è¯ä½ çš„èº«ä»½ï¼Œè¿™ä¸ªæ—¶å€™ç”¨çš„å°±æ˜¯ä½ è¾“å…¥çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p><ul><li><p>å¦‚æœç”¨æˆ·åæˆ–å¯†ç ä¸å¯¹ï¼Œä½ å°±ä¼šæ”¶åˆ°ä¸€ä¸ª<strong>"Access denied foruser"çš„é”™è¯¯</strong>ï¼Œç„¶åå®¢æˆ·ç«¯ç¨‹åºç»“æŸæ‰§è¡Œã€‚</p></li><li><p>å¦‚æœç”¨æˆ·åå¯†ç è®¤è¯é€šè¿‡ï¼Œè¿æ¥å™¨ä¼šåˆ°<strong>æƒé™è¡¨é‡Œé¢æŸ¥å‡ºä½ æ‹¥æœ‰çš„æƒé™</strong>ã€‚ä¹‹åï¼Œè¿™ä¸ªè¿æ¥é‡Œé¢çš„æƒé™åˆ¤æ–­é€»è¾‘ï¼Œéƒ½å°†ä¾èµ–äºæ­¤æ—¶è¯»åˆ°çš„æƒé™ã€‚è¿™å°±æ„å‘³ç€ï¼Œä¸€ä¸ªç”¨æˆ·æˆåŠŸå»ºç«‹è¿æ¥åï¼Œå³ä½¿ä½ ç”¨ç®¡ç†å‘˜è´¦å·å¯¹è¿™ä¸ªç”¨æˆ·çš„æƒé™åšäº†ä¿®æ”¹ï¼Œä¹Ÿä¸ä¼šå½±å“å·²ç»å­˜åœ¨è¿æ¥çš„æƒé™ã€‚ä¿®æ”¹å®Œæˆåï¼Œåªæœ‰<strong>å†æ–°å»ºçš„è¿æ¥æ‰ä¼šä½¿ç”¨æ–°çš„æƒé™è®¾ç½®</strong>ã€‚</p></li></ul><p>å®¢æˆ·ç«¯å¦‚æœå¤ª<strong>é•¿æ—¶é—´æ²¡åŠ¨é™</strong>ï¼Œè¿æ¥å™¨å°±ä¼š<strong>è‡ªåŠ¨å°†å®ƒæ–­å¼€</strong>ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ç”±å‚æ•°<code>wait_timeout</code>æ§åˆ¶çš„ï¼Œé»˜è®¤å€¼æ˜¯8å°æ—¶ã€‚å¦‚æœåœ¨è¿æ¥è¢«æ–­å¼€ä¹‹åï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„è¯ï¼Œå°±ä¼šæ”¶åˆ°ä¸€ä¸ªé”™è¯¯æé†’ï¼š<code>Lost connection to MySQL server during query</code>ã€‚è¿™æ—¶å€™å¦‚æœä½ è¦ç»§ç»­ï¼Œå°±éœ€è¦é‡è¿ï¼Œç„¶åå†æ‰§è¡Œè¯·æ±‚äº†ã€‚</p><ul><li><strong>é•¿è¿æ¥</strong>æ˜¯æŒ‡è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯<strong>æŒç»­æœ‰è¯·æ±‚</strong>ï¼Œåˆ™ä¸€ç›´ä½¿ç”¨<strong>åŒä¸€ä¸ªè¿æ¥</strong>ã€‚</li><li><strong>çŸ­è¿æ¥</strong>åˆ™æ˜¯æŒ‡æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„<strong>å‡ æ¬¡æŸ¥è¯¢å°±æ–­å¼€è¿æ¥</strong>ï¼Œä¸‹æ¬¡æŸ¥è¯¢å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚</li></ul><p><strong>å»ºç«‹è¿æ¥çš„è¿‡ç¨‹é€šå¸¸æ˜¯æ¯”è¾ƒå¤æ‚</strong>çš„ï¼Œæ‰€ä»¥å»ºè®®åœ¨ä½¿ç”¨ä¸­è¦å°½é‡å‡å°‘å»ºç«‹è¿æ¥çš„åŠ¨ä½œï¼Œä¹Ÿå°±æ˜¯<strong>å°½é‡ä½¿ç”¨é•¿è¿æ¥</strong>ã€‚</p><p>ä½†æ˜¯å…¨éƒ¨ä½¿ç”¨é•¿è¿æ¥åï¼ŒMySQLå ç”¨å†…å­˜æ¶¨å¾—ç‰¹åˆ«å¿«ï¼Œè¿™æ˜¯å› ä¸ºMySQLåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­<strong>ä¸´æ—¶ä½¿ç”¨çš„å†…å­˜æ˜¯ç®¡ç†åœ¨è¿æ¥å¯¹è±¡é‡Œé¢çš„</strong>ã€‚è¿™äº›èµ„æºä¼šåœ¨<strong>è¿æ¥æ–­å¼€çš„æ—¶å€™æ‰é‡Šæ”¾</strong>ã€‚æ‰€ä»¥å¦‚æœé•¿è¿æ¥ç´¯ç§¯ä¸‹æ¥ï¼Œå¯èƒ½å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤§ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡çœ‹å°±æ˜¯MySQLå¼‚å¸¸é‡å¯äº†ã€‚</p><ol type="1"><li><p><strong>å®šæœŸæ–­å¼€é•¿è¿æ¥</strong>ã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­<strong>æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢å</strong>ï¼Œæ–­å¼€è¿æ¥ï¼Œä¹‹åè¦æŸ¥è¯¢å†é‡è¿ã€‚</p></li><li><p>å¦‚æœä½ ç”¨çš„æ˜¯MySQL5.7æˆ–æ›´æ–°ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨æ¯æ¬¡æ‰§è¡Œä¸€ä¸ªæ¯”è¾ƒå¤§çš„æ“ä½œåï¼Œé€šè¿‡æ‰§è¡Œ<code>mysql_reset_connection</code>æ¥<strong>é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æº</strong>ã€‚è¿™ä¸ªè¿‡ç¨‹<strong>ä¸éœ€è¦é‡è¿</strong>å’Œé‡æ–°åšæƒé™éªŒè¯ï¼Œä½†æ˜¯ä¼š<strong>å°†è¿æ¥æ¢å¤åˆ°åˆšåˆšåˆ›å»ºå®Œæ—¶çš„çŠ¶æ€</strong>ã€‚</p></li></ol><h3 id="æŸ¥è¯¢ç¼“å­˜">1.2 æŸ¥è¯¢ç¼“å­˜</h3><p>MySQLæ‹¿åˆ°ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚åï¼Œä¼šå…ˆåˆ°æŸ¥è¯¢ç¼“å­˜çœ‹çœ‹ï¼Œä¹‹å‰æ˜¯ä¸æ˜¯æ‰§è¡Œè¿‡è¿™æ¡è¯­å¥ã€‚<strong>ä¹‹å‰æ‰§è¡Œè¿‡çš„è¯­å¥åŠå…¶ç»“æœ</strong>å¯èƒ½ä¼šä»¥<strong>key-valueå¯¹</strong>çš„å½¢å¼ï¼Œè¢«ç›´æ¥ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚<strong>keyæ˜¯æŸ¥è¯¢çš„è¯­å¥ï¼Œvalueæ˜¯æŸ¥è¯¢çš„ç»“æœã€‚</strong>å¦‚æœä½ çš„æŸ¥è¯¢èƒ½å¤Ÿç›´æ¥åœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾åˆ°keyï¼Œé‚£ä¹ˆè¿™ä¸ªvalueå°±ä¼šè¢«ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p>å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœä¼šè¢«å­˜å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚ä½ å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæŸ¥è¯¢å‘½ä¸­ç¼“å­˜ï¼ŒMySQLä¸éœ€è¦æ‰§è¡Œåé¢çš„å¤æ‚æ“ä½œï¼Œå°±å¯ä»¥ç›´æ¥è¿”å›ç»“æœï¼Œè¿™ä¸ª<strong>æ•ˆç‡ä¼šå¾ˆé«˜</strong>ã€‚</p><p>ä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹<strong>å»ºè®®ä¸è¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</strong>ï¼šæŸ¥è¯¢ç¼“å­˜çš„<strong>å¤±æ•ˆéå¸¸é¢‘ç¹</strong>ï¼Œåªè¦æœ‰å¯¹ä¸€ä¸ª<strong>è¡¨çš„æ›´æ–°</strong>ï¼Œè¿™ä¸ªè¡¨ä¸Šæ‰€æœ‰çš„<strong>æŸ¥è¯¢ç¼“å­˜éƒ½ä¼šè¢«æ¸…ç©º</strong>ã€‚å¯¹äº<strong>æ›´æ–°å‹åŠ›å¤§çš„æ•°æ®åº“</strong>æ¥è¯´ï¼ŒæŸ¥è¯¢ç¼“å­˜çš„å‘½ä¸­ç‡ä¼šéå¸¸ä½ã€‚é™¤éä½ çš„ä¸šåŠ¡å°±æ˜¯æœ‰ä¸€å¼ <strong>é™æ€è¡¨</strong>ï¼Œå¾ˆé•¿æ—¶é—´æ‰ä¼šæ›´æ–°ä¸€æ¬¡ã€‚æ¯”å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿé…ç½®è¡¨ï¼Œé‚£è¿™å¼ è¡¨ä¸Šçš„æŸ¥è¯¢æ‰é€‚åˆä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ã€‚</p><p>åœ¨MySQLä¹Ÿæä¾›äº†è¿™ç§â€œæŒ‰éœ€ä½¿ç”¨â€çš„æ–¹å¼ã€‚ä½ å¯ä»¥å°†å‚æ•°<code>query_cache_type</code>è®¾ç½®æˆ<code>DEMAND</code>ï¼Œè¿™æ ·å¯¹äº<strong>é»˜è®¤çš„SQLè¯­å¥éƒ½ä¸ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜</strong>ã€‚è€Œå¯¹äºä½ <strong>ç¡®å®šè¦ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜çš„è¯­å¥</strong>ï¼Œå¯ä»¥ç”¨<code>SQL_CACHE</code>æ˜¾å¼æŒ‡å®šï¼Œåƒä¸‹é¢è¿™ä¸ªè¯­å¥ä¸€æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select SQL_CACHE * from T where ID=10ï¼›<br></code></pre></td></tr></table></figure><p>MySQL8.0ç‰ˆæœ¬ç›´æ¥å°†æŸ¥è¯¢ç¼“å­˜çš„æ•´å—åŠŸèƒ½åˆ æ‰äº†ï¼Œä¹Ÿå°±æ˜¯è¯´8.0å¼€å§‹å½»åº•æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½äº†ã€‚</p><h3 id="åˆ†æå™¨">1.3 åˆ†æå™¨</h3><p>é¦–å…ˆï¼ŒMySQLéœ€è¦<strong>çŸ¥é“ä½ è¦åšä»€ä¹ˆ</strong>ï¼Œå› æ­¤éœ€è¦å¯¹SQLè¯­å¥åšè§£æã€‚</p><ul><li><p>åˆ†æå™¨å…ˆä¼šåš<strong>â€œè¯æ³•åˆ†æâ€</strong>ã€‚ä½ è¾“å…¥çš„æ˜¯ç”±å¤šä¸ªå­—ç¬¦ä¸²å’Œç©ºæ ¼ç»„æˆçš„ä¸€æ¡SQLè¯­å¥ï¼ŒMySQLéœ€è¦è¯†åˆ«å‡ºé‡Œé¢çš„<strong>å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆ</strong>ï¼Œä»£è¡¨ä»€ä¹ˆã€‚MySQLä»ä½ è¾“å…¥çš„"select"è¿™ä¸ªå…³é”®å­—è¯†åˆ«å‡ºæ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªæŸ¥è¯¢è¯­å¥ã€‚å®ƒä¹Ÿè¦æŠŠå­—ç¬¦ä¸²â€œTâ€è¯†åˆ«æˆâ€œè¡¨åTâ€ï¼ŒæŠŠå­—ç¬¦ä¸²â€œIDâ€è¯†åˆ«æˆâ€œåˆ—IDâ€ã€‚</p></li><li><p>åšå®Œäº†è¿™äº›è¯†åˆ«ä»¥åï¼Œå°±è¦åš<strong>â€œè¯­æ³•åˆ†æâ€</strong>ã€‚æ ¹æ®è¯æ³•åˆ†æçš„ç»“æœï¼Œè¯­æ³•åˆ†æå™¨ä¼šæ ¹æ®è¯­æ³•è§„åˆ™ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ªSQLè¯­å¥<strong>æ˜¯å¦æ»¡è¶³MySQLè¯­æ³•</strong>ã€‚å¦‚æœä½ çš„è¯­å¥ä¸å¯¹ï¼Œå°±ä¼šæ”¶åˆ°â€œYou have an error in your SQLsyntaxâ€çš„é”™è¯¯æé†’ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ª è¯­å¥selectå°‘æ‰“äº†å¼€å¤´çš„å­—æ¯â€œsâ€ã€‚</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; elect * from t where ID=1; <br>ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;elect * from t where ID=1&#x27; at line 1 <br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬è¯­æ³•é”™è¯¯ä¼šæç¤ºç¬¬ä¸€ä¸ªå‡ºç°é”™è¯¯çš„ä½ç½®ï¼Œæ‰€ä»¥ä½ è¦å…³æ³¨çš„æ˜¯ç´§æ¥â€œusenearâ€çš„å†…å®¹ã€‚</p><h3 id="ä¼˜åŒ–å™¨">1.4 ä¼˜åŒ–å™¨</h3><p>ä¼˜åŒ–å™¨æ˜¯åœ¨è¡¨é‡Œé¢æœ‰<strong>å¤šä¸ªç´¢å¼•</strong>çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰<strong>å¤šè¡¨å…³è”</strong>ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåºã€‚</p><p>æ¯”å¦‚ä½ æ‰§è¡Œä¸‹é¢è¿™æ ·çš„è¯­å¥ï¼Œè¿™ä¸ªè¯­å¥æ˜¯æ‰§è¡Œä¸¤ä¸ªè¡¨çš„joinï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from t1 join t2 using(ID) where t1.c=10 and t2.d=20;<br></code></pre></td></tr></table></figure><ul><li><p>æ—¢å¯ä»¥å…ˆä»è¡¨t1é‡Œé¢å–å‡ºc=10çš„è®°å½•çš„IDå€¼ï¼Œå†æ ¹æ®IDå€¼å…³è”åˆ°è¡¨t2ï¼Œå†åˆ¤æ–­t2é‡Œé¢dçš„å€¼æ˜¯å¦ç­‰äº20ã€‚</p></li><li><p>ä¹Ÿå¯ä»¥å…ˆä»è¡¨t2é‡Œé¢å–å‡ºd=20çš„è®°å½•çš„IDå€¼ï¼Œå†æ ¹æ®IDå€¼å…³è”åˆ°t1ï¼Œå†åˆ¤æ–­t1é‡Œé¢cçš„å€¼æ˜¯å¦ç­‰äº10ã€‚</p></li></ul><p>è¿™ä¸¤ç§æ‰§è¡Œæ–¹æ³•çš„é€»è¾‘ç»“æœæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ‰§è¡Œçš„æ•ˆç‡ä¼šæœ‰ä¸åŒï¼Œè€Œä¼˜åŒ–å™¨çš„ä½œç”¨å°±æ˜¯å†³å®šé€‰æ‹©ä½¿ç”¨å“ªä¸€ä¸ªæ–¹æ¡ˆã€‚</p><h3 id="æ‰§è¡Œå™¨">1.5 æ‰§è¡Œå™¨</h3><p>MySQLé€šè¿‡<strong>åˆ†æå™¨</strong>çŸ¥é“äº†ä½ è¦<strong>åšä»€ä¹ˆ</strong>ï¼Œé€šè¿‡<strong>ä¼˜åŒ–å™¨</strong>çŸ¥é“äº†è¯¥<strong>æ€ä¹ˆåš</strong>ï¼Œäºæ˜¯å°±è¿›å…¥äº†æ‰§è¡Œå™¨é˜¶æ®µï¼Œå¼€å§‹æ‰§è¡Œè¯­å¥ã€‚</p><p>è¦å…ˆåˆ¤æ–­ä¸€ä¸‹ä½ å¯¹è¿™ä¸ªè¡¨Tæœ‰æ²¡æœ‰<strong>æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™</strong>ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±ä¼šè¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">mysql&gt; select * from T where ID=10; <br>ERROR 1142 (42000): SELECT command denied to user &#x27;b&#x27;@&#x27;localhost&#x27; for table &#x27;T&#x27;<br></code></pre></td></tr></table></figure><p>å¦‚æœæœ‰æƒé™ï¼Œå°±æ‰“å¼€è¡¨ç»§ç»­æ‰§è¡Œã€‚æ‰“å¼€è¡¨çš„æ—¶å€™ï¼Œæ‰§è¡Œå™¨å°±ä¼šæ ¹æ®è¡¨çš„å¼•æ“å®šä¹‰ï¼Œå»<strong>ä½¿ç”¨è¿™ä¸ªå¼•æ“æä¾›çš„æ¥å£</strong>ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸­çš„è¡¨Tä¸­ï¼ŒIDå­—æ®µ<strong>æ²¡æœ‰ç´¢å¼•</strong>ï¼Œé‚£ä¹ˆæ‰§è¡Œå™¨çš„æ‰§è¡Œæµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol type="1"><li><p>è°ƒç”¨InnoDBå¼•æ“æ¥å£å–è¿™ä¸ªè¡¨çš„<strong>ç¬¬ä¸€è¡Œ</strong>ï¼Œåˆ¤æ–­IDå€¼æ˜¯ä¸æ˜¯10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼›</p></li><li><p>è°ƒç”¨å¼•æ“æ¥å£å–<strong>â€œä¸‹ä¸€è¡Œâ€</strong>ï¼Œé‡å¤ç›¸åŒçš„åˆ¤æ–­é€»è¾‘ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œã€‚</p></li><li><p>æ‰§è¡Œå™¨å°†ä¸Šè¿°<strong>éå†</strong>è¿‡ç¨‹ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è¡Œç»„æˆçš„è®°å½•é›†ä½œä¸ºç»“æœé›†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p></li></ol><p>è‡³æ­¤ï¼Œè¿™ä¸ªè¯­å¥å°±æ‰§è¡Œå®Œæˆäº†ã€‚</p><p>å¯¹äº<strong>æœ‰ç´¢å¼•</strong>çš„è¡¨ï¼Œæ‰§è¡Œçš„é€»è¾‘ä¹Ÿå·®ä¸å¤šã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ˜¯<strong>â€œå–æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€è¡Œâ€</strong>è¿™ä¸ªæ¥å£ï¼Œä¹‹åå¾ªç¯å–<strong>â€œæ»¡è¶³æ¡ä»¶çš„ä¸‹ä¸€è¡Œâ€</strong>è¿™ä¸ªæ¥å£ï¼Œè¿™äº›æ¥å£éƒ½æ˜¯å¼•æ“ä¸­å·²ç»å®šä¹‰å¥½çš„ã€‚</p><p>ä½ ä¼šåœ¨æ•°æ®åº“çš„æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­çœ‹åˆ°ä¸€ä¸ª<code>rows_examined</code>çš„å­—æ®µï¼Œè¡¨ç¤ºè¿™ä¸ªè¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰«æäº†å¤šå°‘è¡Œã€‚è¿™ä¸ªå€¼å°±æ˜¯åœ¨æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œçš„æ—¶å€™ç´¯åŠ çš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ä¹ ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ç¼–ç¨‹</tag>
      
      <tag>æ•°æ®åº“</tag>
      
      <tag>MySQL</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
